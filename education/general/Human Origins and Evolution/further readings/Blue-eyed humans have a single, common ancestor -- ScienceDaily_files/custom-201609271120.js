$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip({animation:false});$('#topnav').affix({offset:{top:$('#topnav').offset().top}});$('#navwrapper').css('top',$('header').height());$(".dropdown-menu").mouseenter(function(){$(this).parent('li').addClass('active-gray');}).mouseleave(function(){$(this).parent('li').removeClass('active-gray');});$('[data-tab]').hover(function(){var tab_id=$(this).data('tab');var block=tab_id.substring(1,tab_id.lastIndexOf('_'));$('.tab-pane').each(function(){if($(this).attr('id').indexOf(block)==0){$(this).removeClass('active');}});$(tab_id).addClass('active');});$('[data-tab]').click(function(e){var supportsTouch='ontouchstart'in window||navigator.msMaxTouchPoints;if(supportsTouch)e.preventDefault();var tab_id=$(this).data('tab');var block=tab_id.substring(1,tab_id.lastIndexOf('_'));$('.tab-pane').each(function(){if($(this).attr('id').indexOf(block)==0){$(this).removeClass('active');}});$(tab_id).addClass('active');var clicked=$(this).data('clicked');if(clicked){var url=$(this).attr('href');window.location.href=url;}else{$(this).data('clicked',true);}});$('.dropdown-submenu a').on('click',function(e){var supportsTouch='ontouchstart'in window||navigator.msMaxTouchPoints;var url=$(this).data('url');$(this).attr('href',url);if(!supportsTouch&&e.which==1){window.location.href=url;}else if(supportsTouch&&$(window).width()<728){window.location.href=url;};});$('.newsticker').css({display:"block"});$('.newsticker').newsTicker({max_rows:1,row_height:20,duration:5000,speed:250,prevButton:$('.backward'),nextButton:$('.forward')});$('#contents').fontResize({defaultTargetNode:'div[id="contents"]',defaultWidgetLocation:'.fs-widget',defaultSize:'14px',defaultLabels:'<a href="" class="decreaseFont fontresize">A-<a href="" class="normalizeFont fontresize">A<a href="" class="increaseFont">A+'});$('#daterange .input-daterange').datepicker({format:"yyyy/mm/dd"});$('[data-toggle="tab"]').bind('click',function(){var list_view=$(this).attr('aria-controls');$('#list_view').val(list_view);});if($('#list_view').val()=='headlines'){$('#list a[href="#headlines"]').tab('show');}else{$('#list a[href="#summaries"]').tab('show');}
if($('#saved_summaries').val()){$('#summaries').empty().append($('#saved_summaries').val());}
if($('#saved_headlines').val()){$('#headlines').empty().append($('#saved_headlines').val());}
var excluded=$('#excluded_filenames').val();function uniqueId(){return new Date().getTime();};$.ajaxSetup({cache:false});$('#load_more_stories').on('click',function(){var category=$('meta[name=top]').attr("content");var section=$('meta[name=section]').attr("content");var topic=$('meta[name=topic]').attr("content");var quirky=$('meta[name=quirky]').attr("content");var hash=window.location.hash.slice(1);var array=hash.split("&");var values,form_data={};for(var i=0;i<array.length;i+=1){values=array[i].split("=");form_data[values[0]]=values[1];}
var page=form_data['page']||1;var summaries_start=(page*20);var summaries_end=summaries_start+20;var headlines_start=(page*100);var headlines_end=headlines_start+100;var btn=$(this);btn.button('loading');if($('#summaries').hasClass('active')){$('#summaries').append($('<div>').load('/xml/summaries.php?top='+category+'&quirky='+quirky+'&section='+section+'&topic='+topic+'&exclude='+excluded+'&start='+summaries_start+'&end='+summaries_end+'&page='+page+'&uid='+uniqueId(),function(){$('#saved_summaries').val($('#summaries').html());btn.button('reset');}));$('#list_view').val('summaries');}else if($('#headlines').hasClass('active')){$('#headlines').append($('<div>').load('/xml/headlines.php?top='+category+'&quirky='+quirky+'&section='+section+'&topic='+topic+'&exclude='+excluded+'&start='+headlines_start+'&end='+headlines_end+'&page='+page+'&uid='+uniqueId(),function(){$('#saved_headlines').val($('#headlines').html());btn.button('reset');}));$('#list_view').val('headlines');}
page++;window.location.hash='page='+page;});$('#load_more_videos').on('click',function(){var category=$('meta[name=top]').attr("content");var section=$('meta[name=section]').attr("content");var topic=$('meta[name=topic]').attr("content");var quirky=$('meta[name=quirky]').attr("content");var hash=window.location.hash.slice(1);var array=hash.split("&");var values,form_data={};for(var i=0;i<array.length;i+=1){values=array[i].split("=");form_data[values[0]]=values[1];}
var page=form_data['page']||1;var summaries_start=(page*20);var summaries_end=summaries_start+20;var headlines_start=(page*100);var headlines_end=headlines_start+100;var btn=$(this);btn.button('loading');if($('#summaries').hasClass('active')){$('#summaries').append($('<div>').load('/xml/previews.php?type=summaries&top='+category+'&quirky='+quirky+'&section='+section+'&topic='+topic+'&exclude='+excluded+'&start='+summaries_start+'&end='+summaries_end+'&page='+page+'&uid='+uniqueId(),function(){$('#saved_summaries').val($('#summaries').html());btn.button('reset');}));}else if($('#headlines').hasClass('active')){$('#headlines').append($('<div>').load('/xml/previews.php?type=headlines&top='+category+'&quirky='+quirky+'&section='+section+'&topic='+topic+'&exclude='+excluded+'&start='+headlines_start+'&end='+headlines_end+'&page='+page+'&uid='+uniqueId(),function(){$('#saved_headlines').val($('#headlines').html());btn.button('reset');}));}
page++;window.location.hash='page='+page;});FastClick.attach(document.body);$('.print').on('click',function(){$('.main').print({prepend:$('.logo').html()+'<br />'+'<style>.main {width: 100% !important} .photo-image {float: left; max-width: 300px; padding: 15px 25px 15px 0} .photo-image img {max-height: 300px !important; width: auto}</style>'});});function mobile(click){$('#viewport').attr('content','width=device-width, initial-scale=1');$('.mode').html('<i class="fa fa-desktop fa-fw"></i> Full</a>');if(click){$('body,html').animate({scrollTop:0,},0);}
$('#navwrapper').css('top',$('header').height());}
function desktop(click){$('#viewport').attr('content','width=992');$('.mode').html('<i class="fa fa-mobile fa-fw"></i> Mobile</a>');if(click){$('body,html').animate({scrollTop:0,},0);}
$('#navwrapper').css('top',$('header').height());}
if(window.screen.width>991){$('.mode').remove();}else{var element=$('.mode');($.cookie('desktop')=='true')?desktop(false):mobile(false);element.click(function(){if($.cookie('desktop')=='true'){$.cookie('desktop','false',{path:'/'});}else{$.cookie('desktop','true',{path:'/'});}
return($.cookie('desktop')=='true')?desktop(true):mobile(true);});}
$(".navbar-collapse").css({maxHeight:$(window).height()-$(".navbar-header").height()+"px"});$(".dropdown-menu").css({maxWidth:$('.main').width()+"px"});if($(window).width()>480){$('head').remove('<meta id="viewport" name="viewport" content="width=device-width, initial-scale=1">');}});function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args);};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args);};};var windowWidth=window.innerWidth||$(window).width();var resizer=debounce(function(){if($(window).width()!=windowWidth&&window.innerWidth!=windowWidth){windowWidth=window.innerWidth||$(window).width();$('#navwrapper').css('top',$('header').height());}},250);window.addEventListener('resize',resizer);window.onload=function(){setTimeout(function(){if(window.canRunAds===undefined){if(typeof ga!=='undefined'){ga('send','event','Adblock','Yes',{'nonInteraction':1});}}else{if(typeof ga!=='undefined'){ga('send','event','Adblock','No',{'nonInteraction':1});}}},2000);};
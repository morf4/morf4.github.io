<!DOCTYPE html><html lang="en">
<head>
<meta charset="utf-8">
<meta name="format-detection" content="telephone=no">
<title>GNU Makefile Documentation | Lecture Notes | Foundations of Software Engineering | Civil and Environmental Engineering | MIT OpenCourseWare</title>
<!-- Begin Automatic Metadata Insertion --><meta content="1-124j-foundations-of-software-engineering-fall-2000" name="WT.cg_n">
<meta content="GNU Makefile Documentation" name="WT.cg_s">
<meta content="" name="Description">
<meta content="Amaratunga, Kevin" name="Author">
<meta content="modern software development,engineering and information technology,component-based software,C#,.NET,data structures,algorithms for modeling,analysis,visualization,basic problem-solving techniques,web services,management and maintenance of software,sorting,searching,algorithms,numerical simulation techniques,image processing,computational geometry,finite element methods,network methods,e-business applications,classes,objects,inheritance,virtual functions,abstract classes,polymorphism,Java applications,applets,Abstract Windowing Toolkit,Graphics,Threads,Java,C++,information technology,engineering,modeling algorithms,basic problem-solving,software management,software maintenance,searching algorithms,numerical simulation,object oriented programming,1.124J,2.159J,13.470J,1.124,2.159,13.470,Software Design and Engineering" name="keywords">
<meta content="1.124J Foundations of Software Engineering | GNU Makefile Documentation" name="Search_Display">
<meta content="Software Design and Engineering" itemprop="about">
<!-- End Automatic Metadata Insertion --><link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/grid.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/base.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/menu.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.bubblepopup.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses_new.css">
<link href="https://ocw.mit.edu/xml/ocwcc.rdf" type="application/rdf+xml" rel="metadata">
<link rel="canonical" href="https://ocw.mit.edu/courses/civil-and-environmental-engineering/1-124j-foundations-of-software-engineering-fall-2000/lecture-notes/gnu_makefile_documentation">
<link rel="apple-touch-icon" href="../../../common/images/apple-touch-icon.png">
<script type="text/javascript" src="../../../common/scripts/jquery.js"></script><script type="text/javascript" src="../../../common/scripts/ocw-media-utils-offline.js"></script><script type="text/javascript" src="../../../common/scripts/ocw-offline.js"></script><script type="text/javascript" src="../../../common/scripts/jquery.bubblepopup.min.js"></script><script type="text/javascript" src="../../../common/scripts/expandy.js"></script><script type="text/javascript" src="../../../common/scripts/bubble-popup-offline.js"></script>
</head>
<body itemscope itemtype="http://schema.org/WebPage">
        
	

        <header id="top"><div id="grid">
				
				
					
<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572">
<div class="portletStaticText portlet-static-site-header">
<!--googleoff: index-->
<div class="grid_6 alpha" id="banner"><a href="https://ocw.mit.edu/"><img src="../../../common/images/ocw_mast.png" class="logo" alt="MIT OpenCourseWare, Massachusetts Institute of Technology"></a></div>
<div class="grid_6 omega" id="subscribe">
<aside class="module" aria-label="Connect with OCW"><table class="social"><tbody><tr>
<td class="socialbutton"><a aria-label="Subscribe to the OCW Newsletter" href="https://ocw.mit.edu/subscribe/index.htm?utm_source=header"><img src="../../../common/images/trans.gif" alt="An icon depicting an envelope.">Subscribe to the OCW Newsletter</a></td>
            <td>
<a aria-label="Google+" href="https://plus.google.com/104567381989352550847/posts"><img src="../../../common/images/icon_gp.png" alt="Click to visit our Google+ page."></a>                   <a aria-label="Pinterest" href="https://www.pinterest.com/mitocw/pins/"><img src="../../../common/images/icon_pin.png" alt="Click to visit our Pinterest page."></a>                   <a aria-label="Facebook" href="https://facebook.com/mitocw"><img src="../../../common/images/icon_fb.png" alt="Click to visit our Facebook page."></a>                   <a aria-label="Twitter" href="https://twitter.com/mitocw"><img src="../../../common/images/icon_tw.png" alt="Click to visit our Twitter feed."></a>
</td>
        </tr></tbody></table></aside><nav aria-label="Help Links" class="helplinks"><a aria-label="OCW Site Help" href="https://ocw.mit.edu/help">Help</a><span aria-hidden="true">|</span>     <a href="../../../common/jsp/feedback.htm">Contact Us</a>   </nav>
</div>
<div class="clear"> </div>
<!--googleon: index-->
</div>

</div>





<!--googleoff: index-->
<nav id="mega" class="grid_8 alpha" aria-label="Site"><ul id="menu" role="presentation">
<li id="menu_home">
        <a href="https://ocw.mit.edu/" aria-label="Homepage"><img src="../../../common/images/top-nav_home.png" class="home_icon" alt="Click for site home page."></a><!-- Begin Home Item -->
    </li>
<!-- End Home Item -->
    <li id="drop_1" aria-label="Find Courses" class="selected">
      <a href="#" aria-hidden="true">Find Courses</a><!-- Begin 5 columns Item -->
      <div class="dropdown_5columns-a mega-courses">
        <div class="col_1a">
          <div class="row_1a">
            <nav aria-labelledby="mm-find-courses-by"><span id="mm-find-courses-by" class="nav" aria-hidden="true">Find courses by:</span>
              <ul class="find_by" role="presentation">
<li><a href="https://ocw.mit.edu/courses/find-by-topic/">Topic</a></li>
                <li><a href="https://ocw.mit.edu/courses/find-by-number/">MIT Course Number</a></li>
                <li><a href="https://ocw.mit.edu/courses/find-by-department/">Department</a></li>
								<li><a href="https://ocw.mit.edu/educator/?view=instructional&amp;utm_campaign=Educator&amp;utm_source=megamenu&amp;utm_medium=find-courses&amp;utm_content=approaches">Instructional Approach</a></li>
								<li><a href="https://ocw.mit.edu/educator/?view=teaching&amp;utm_campaign=Educator&amp;utm_source=megamenu&amp;utm_medium=find-courses&amp;utm_content=materials">Teaching Materials</a></li>
            		<li><a href="https://ocw.mit.edu/courses/?utm_source=ocw-megamenu&amp;utm_medium=link&amp;utm_campaign=mclstudy">View All Courses</a></li>
							</ul></nav><nav aria-labelledby="mm-collections"><span id="mm-collections" class="nav" aria-hidden="true">Collections</span>
              <ul role="presentation">
<li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Lectures</a></li>
                <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
                <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
                <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
                <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
                <li><a href="https://ocw.mit.edu/courses/this-course-at-mit/">This Course at MIT</a></li>
                <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
              </ul></nav><nav class="col_1b" aria-labelledby="mm-translated-courses"><span id="mm-translated-courses" class="nav" aria-hidden="true">Translated Courses</span>
							<ul role="presentation">
<li><a href="https://ocw.mit.edu/courses/translated-courses/traditional-chinese" aria-label="Traditional Chinese">繁體字 / Traditional Chinese</a></li>
								<li><a href="https://ocw.mit.edu/courses/translated-courses/spanish" aria-label="Spanish">Español / Spanish</a></li>
								<li><a href="https://ocw.mit.edu/courses/translated-courses/portuguese" aria-label="Portuguese">Português / Portuguese</a></li>
								<li><a href="https://ocw.mit.edu/courses/translated-courses/persian" aria-label="Persian">فارسی / Persian</a></li>
								<li><a href="https://ocw.mit.edu/courses/translated-courses/turkish" aria-label="Turkish">Türkçe / Turkish</a></li>
								<li><a href="https://ocw.mit.edu/courses/translated-courses/korean" aria-label="Korean">(비디오)한국 / Korean</a></li>
								<li><a href="https://ocw.mit.edu/courses/translated-courses">More...</a></li>
							</ul></nav>
</div>
          <div class="row_1b">
            <nav aria-labelledby="mm-cross-disciplinary-topic-lists"><span id="mm-cross-disciplinary-topic-lists" class="nav" aria-hidden="true">Cross-Disciplinary Topic Lists</span>
            	<ul role="presentation">
<li><a href="https://ocw.mit.edu/courses/energy-courses">Energy</a></li>
                <li><a href="https://ocw.mit.edu/courses/entrepreneurship">Entrepreneurship</a></li>
                <li><a href="https://ocw.mit.edu/courses/environment-courses">Environment</a></li>
              	<li><a href="https://ocw.mit.edu/courses/intro-programming">Introductory Programming</a></li>
                <li><a href="https://ocw.mit.edu/courses/life-sciences">Life Sciences</a></li>
                <li><a href="https://ocw.mit.edu/courses/transportation-courses">Transportation</a></li>
              </ul></nav>
</div>
        </div>

      </div>
    </li>
    <li id="drop_2">
        <a href="" aria-hidden="true">About</a>
        <div class="dropdown_1column-a">
            <nav class="col_1" aria-label="About"><ul role="presentation">
<li><a href="https://ocw.mit.edu/about/">About MIT OpenCourseWare</a></li>
                    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
                    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
                    <li><a href="https://ocw.mit.edu/about/newsletter/">News</a></li>
                </ul></nav>
</div>
    </li>
    <li id="drop_3">
        <a href="" aria-hidden="true">Donate</a>
        <div class="dropdown_1column-a">
          <nav class="col_1" aria-label="Donate"><ul role="presentation">
<li><a href="https://ocw.mit.edu/donate/">Make a Donation</a></li>
              <li><a href="https://ocw.mit.edu/donate/why-donate/">Why Donate?</a></li>
              <li><a href="https://ocw.mit.edu/donate/our-supporters/">Our Supporters</a></li>
              <li><a href="https://ocw.mit.edu/donate/other-ways-to-contribute/">Other Ways to Contribute</a></li>
              <li><a href="https://ocw.mit.edu/donate/shop-ocw">Shop OCW</a></li>
              <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
            </ul></nav>
</div>
    </li>
    <li id="drop_4">
      <a href="" aria-hidden="true">Featured Sites</a>
      <div class="dropdown_1column-a">
        <nav class="col_1" aria-labelledby="mm-featured-sites"><span id="mm-featured-sites" class="nav" aria-hidden="true">OCW Initiatives</span>
          <ul role="presentation">
<li><a href="https://ocw.mit.edu/high-school/">Highlights for High School</a></li>
            <li><a href="https://ocw.mit.edu/educator/?utm_campaign=Educator&amp;utm_source=megamenu&amp;utm_medium=featured-sites">OCW Educator</a></li>
            <li><a href="https://ocw.mit.edu/courses/crosslinks/">MIT Crosslinks and OCW</a></li>
            <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx and Related OCW Courses</a></li>
					</ul></nav><nav class="col_1" aria-labelledby="mm-featured-external-links"><span id="mm-featured-external-links" class="nav" aria-hidden="true">Beyond OCW</span>
					<ul>
<li><a href="http://k12videos.mit.edu" aria-label="External Link: MIT Plus K12 Videos">MIT+K12 Videos</a></li>
            <li><a href="https://teachingexcellence.mit.edu/" aria-label="External Link: Teaching Excellence at MIT">Teaching Excellence at MIT</a></li>
						<li><a href="https://outreach.mit.edu" aria-label="External Link: Outreach at MIT">Outreach @ MIT</a></li>
						<li><a href="http://www.oeconsortium.org/" aria-label="External Link: Open Education Consortium">Open Education Consortium</a></li>
          </ul></nav>
</div>
    </li>
  </ul></nav><div id="search" role="search" class="grid_4 omega">
  
    <form aria-label="Advanced Search" method="get" action="../../../common/search/AdvancedSearch.htm">
		  <table class="search"><tbody><tr>
<td class="black"><input type="text" onblur="fillSearchBox()" onfocus="clearSearchBox()" maxlength="255" value="Search" name="q" class="greytext searchField" id="terms"></td>
            <td class="black"><input type="image" src="../../../common/images/button_search.png" name="btnG" class="sub_button"></td>
            <td class="text2"><a href="../../../common/search/AdvancedSearch.htm">Advanced<br>Search</a></td>
          </tr></tbody></table>
</form>
</div>
<div class="clear"></div>
<!--googleon: index-->
<!-- *end header* -->

				
				
			</div>
<!-- top grid end -->
		</header><!-- top end --><div id="center">
         <div id="grid">
		         <div id="left-section">
                 <nav aria-label="Breadcrumb" id="breadcrumb"><p>

    <a href="https://ocw.mit.edu/">Home</a>
    
        »
        
    
    
        
            <a href="https://ocw.mit.edu/courses">Courses</a>
            
                »
                
            
            
         
    
    
        
            <a href="https://ocw.mit.edu/courses/civil-and-environmental-engineering">Civil and Environmental Engineering</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/index.htm">Foundations of Software Engineering</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/lecture-notes/index.htm">Lecture Notes</a>
            
                »
                
            
            
         
    
    
        
            
            
            GNU Makefile Documentation
         
    
</p>

                 </nav><div class="clear"></div>
                   <div id="section_title">
           			     <h1 class="title" itemprop="name" property="dct:title">
        <span class="" id="parent-fieldname-title">
            GNU Makefile Documentation
        </span>
    </h1>
             	     </div>
             	     <div class="clear"></div>
             	     <div id="course_wrapper_section">
           	     	 <nav id="course_nav" aria-label="Course"><script language="javascript" type="text/javascript">
function toggleMenu(objID) {
  if (!document.getElementById) return;
  var ob = document.getElementById(objID);
  ob.className = (ob.className == 'selected')?'': 'selected';
}
function toggleClass(id)
{
  var divtoggleClass= document.getElementById(id);
  divtoggleClass.className = (divtoggleClass.className == 'mO')?'mC': 'mO';
  return false;
}
function changeAlt(id)
{
  id.alt = (id.alt == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
  id.title = (id.title == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
}
</script><!--Left Nav Starts --><ul>
<li class="">
			   			<a href="../../../contents/index.htm">
		                  Course Home  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/syllabus/index.htm">
		                  Syllabus  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/calendar/index.htm">
		                  Calendar  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="selected">
			   			<a href="../../../contents/lecture-notes/index.htm">
		                  Lecture Notes  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/recitations/index.htm">
		                  Recitations  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/assignments/index.htm">
		                  Assignments  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/exams/index.htm">
		                  Exams  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/projects/index.htm">
		                  Projects  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    
		    
         	
	<!--second tal block close-->  
	
</ul>
<!--Left Nav Ends --></nav><main id="course_inner_section" aria-labelledby="section_title"><h2 class="subhead">Table of Contents</h2>
<ul>
<li>
<a href="#SEC1">Overview of <span style="font-family: courier, mono;">make</span></a><a id="TOC1" href="#SEC1" name="TOC1"></a>
<ul>
<li><a id="TOC2" href="#SEC2" name="TOC2">How to Read This Manual</a></li>
<li><a id="TOC3" href="#SEC3" name="TOC3">Problems and Bugs</a></li>
</ul>
</li>
<li>
<a id="TOC4" href="#SEC4" name="TOC4">An Introduction to Makefiles</a>
<ul>
<li><a id="TOC5" href="#SEC5" name="TOC5">What a Rule Looks Like</a></li>
<li><a id="TOC6" href="#SEC6" name="TOC6">A Simple Makefile</a></li>
<li><a id="TOC7" href="#SEC7" name="TOC7">How <span style="font-family: courier, mono;">make</span> Processes a Makefile</a></li>
<li><a id="TOC8" href="#SEC8" name="TOC8">Variables Make Makefiles Simpler</a></li>
<li><a id="TOC9" href="#SEC9" name="TOC9">Letting <span style="font-family: courier, mono;">make</span> Deduce the Commands</a></li>
<li><a id="TOC10" href="#SEC10" name="TOC10">Another Style of Makefile</a></li>
<li><a id="TOC11" href="#SEC11" name="TOC11">Rules for Cleaning the Directory</a></li>
</ul>
</li>
<li>
<a id="TOC12" href="#SEC12" name="TOC12">Writing Makefiles</a>
<ul>
<li><a id="TOC13" href="#SEC13" name="TOC13">What Makefiles Contain</a></li>
<li><a id="TOC14" href="#SEC14" name="TOC14">What Name to Give Your Makefile</a></li>
<li><a id="TOC15" href="#SEC15" name="TOC15">Including Other Makefiles</a></li>
<li><a id="TOC16" href="#SEC16" name="TOC16">The Variable <span style="font-family: courier, mono;">MAKEFILES</span></a></li>
<li><a id="TOC17" href="#SEC17" name="TOC17">How Makefiles Are Remade</a></li>
<li><a id="TOC18" href="#SEC18" name="TOC18">Overriding Part of Another Makefile</a></li>
<li><a id="TOC19" href="#SEC19" name="TOC19">How <span style="font-family: courier, mono;">make</span> Reads a Makefile</a></li>
</ul>
</li>
<li>
<a id="TOC20" href="#SEC20" name="TOC20">Writing Rules</a>
<ul>
<li><a id="TOC21" href="#SEC21" name="TOC21">Rule Syntax</a></li>
<li>
<a id="TOC22" href="#SEC22" name="TOC22">Using Wildcard Characters in File Names</a>
<ul>
<li><a id="TOC23" href="#SEC23" name="TOC23">Wildcard Examples</a></li>
<li><a id="TOC24" href="#SEC24" name="TOC24">Pitfalls of Using Wildcards</a></li>
<li><a id="TOC25" href="#SEC25" name="TOC25">The Function <span style="font-family: courier, mono;">wildcard</span></a></li>
</ul>
</li>
<li>
<a id="TOC26" href="#SEC26" name="TOC26">Searching Directories for Prerequisites</a>
<ul>
<li><a id="TOC27" href="#SEC27" name="TOC27"><span style="font-family: courier, mono;">VPATH</span>: Search Path for All Prerequisites</a></li>
<li><a id="TOC28" href="#SEC28" name="TOC28">The <span style="font-family: courier, mono;">vpath</span> Directive</a></li>
<li><a id="TOC29" href="#SEC29" name="TOC29">How Directory Searches are Performed</a></li>
<li><a id="TOC30" href="#SEC30" name="TOC30">Writing Shell Commands with Directory Search</a></li>
<li><a id="TOC31" href="#SEC31" name="TOC31">Directory Search and Implicit Rules</a></li>
<li><a id="TOC32" href="#SEC32" name="TOC32">Directory Search for Link Libraries</a></li>
</ul>
</li>
<li><a id="TOC33" href="#SEC33" name="TOC33">Phony Targets</a></li>
<li><a id="TOC34" href="#SEC34" name="TOC34">Rules without Commands or Prerequisites</a></li>
<li><a id="TOC35" href="#SEC35" name="TOC35">Empty Target Files to Record Events</a></li>
<li><a id="TOC36" href="#SEC36" name="TOC36">Special Built-in Target Names</a></li>
<li><a id="TOC37" href="#SEC37" name="TOC37">Multiple Targets in a Rule</a></li>
<li><a id="TOC38" href="#SEC38" name="TOC38">Multiple Rules for One Target</a></li>
<li>
<a id="TOC39" href="#SEC39" name="TOC39">Static Pattern Rules</a>
<ul>
<li><a id="TOC40" href="#SEC40" name="TOC40">Syntax of Static Pattern Rules</a></li>
<li><a id="TOC41" href="#SEC41" name="TOC41">Static Pattern Rules versus Implicit Rules</a></li>
</ul>
</li>
<li><a id="TOC42" href="#SEC42" name="TOC42">Double-Colon Rules</a></li>
<li><a id="TOC43" href="#SEC43" name="TOC43">Generating Prerequisites Automatically</a></li>
</ul>
</li>
<li>
<a id="TOC44" href="#SEC44" name="TOC44">Writing the Commands in Rules</a>
<ul>
<li><a id="TOC45" href="#SEC45" name="TOC45">Command Echoing</a></li>
<li><a id="TOC46" href="#SEC46" name="TOC46">Command Execution</a></li>
<li><a id="TOC47" href="#SEC47" name="TOC47">Parallel Execution</a></li>
<li><a id="TOC48" href="#SEC48" name="TOC48">Errors in Commands</a></li>
<li><a id="TOC49" href="#SEC49" name="TOC49">Interrupting or Killing <span style="font-family: courier, mono;">make</span></a></li>
<li>
<a id="TOC50" href="#SEC50" name="TOC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>
<ul>
<li><a id="TOC51" href="#SEC51" name="TOC51">How the <span style="font-family: courier, mono;">MAKE</span> Variable Works</a></li>
<li><a id="TOC52" href="#SEC52" name="TOC52">Communicating Variables to a Sub-<span style="font-family: courier, mono;">make</span></a></li>
<li><a id="TOC53" href="#SEC53" name="TOC53">Communicating Options to a Sub-<span style="font-family: courier, mono;">make</span></a></li>
<li><a id="TOC54" href="#SEC54" name="TOC54">The <samp>`--print-directory'</samp> Option</a></li>
</ul>
</li>
<li><a id="TOC55" href="#SEC55" name="TOC55">Defining Canned Command Sequences</a></li>
<li><a id="TOC56" href="#SEC56" name="TOC56">Using Empty Commands</a></li>
</ul>
</li>
<li>
<a id="TOC57" href="#SEC57" name="TOC57">How to Use Variables</a>
<ul>
<li><a id="TOC58" href="#SEC58" name="TOC58">Basics of Variable References</a></li>
<li><a id="TOC59" href="#SEC59" name="TOC59">The Two Flavors of Variables</a></li>
<li>
<a id="TOC60" href="#SEC60" name="TOC60">Advanced Features for Reference to Variables</a>
<ul>
<li><a id="TOC61" href="#SEC61" name="TOC61">Substitution References</a></li>
<li><a id="TOC62" href="#SEC62" name="TOC62">Computed Variable Names</a></li>
</ul>
</li>
<li><a id="TOC63" href="#SEC63" name="TOC63">How Variables Get Their Values</a></li>
<li><a id="TOC64" href="#SEC64" name="TOC64">Setting Variables</a></li>
<li><a id="TOC65" href="#SEC65" name="TOC65">Appending More Text to Variables</a></li>
<li><a id="TOC66" href="#SEC66" name="TOC66">The <span style="font-family: courier, mono;">override</span> Directive</a></li>
<li><a id="TOC67" href="#SEC67" name="TOC67">Defining Variables Verbatim</a></li>
<li><a id="TOC68" href="#SEC68" name="TOC68">Variables from the Environment</a></li>
<li><a id="TOC69" href="#SEC69" name="TOC69">Target-specific Variable Values</a></li>
<li><a id="TOC70" href="#SEC70" name="TOC70">Pattern-specific Variable Values</a></li>
</ul>
</li>
<li>
<a id="TOC71" href="#SEC71" name="TOC71">Conditional Parts of Makefiles</a>
<ul>
<li><a id="TOC72" href="#SEC72" name="TOC72">Example of a Conditional</a></li>
<li><a id="TOC73" href="#SEC73" name="TOC73">Syntax of Conditionals</a></li>
<li><a id="TOC74" href="#SEC74" name="TOC74">Conditionals that Test Flags</a></li>
</ul>
</li>
<li>
<a id="TOC75" href="#SEC75" name="TOC75">Functions for Transforming Text</a>
<ul>
<li><a id="TOC76" href="#SEC76" name="TOC76">Function Call Syntax</a></li>
<li><a id="TOC77" href="#SEC77" name="TOC77">Functions for String Substitution and Analysis</a></li>
<li><a id="TOC78" href="#SEC78" name="TOC78">Functions for File Names</a></li>
<li><a id="TOC79" href="#SEC79" name="TOC79">The <span style="font-family: courier, mono;">foreach</span> Function</a></li>
<li><a id="TOC80" href="#SEC80" name="TOC80">The <span style="font-family: courier, mono;">if</span> Function</a></li>
<li><a id="TOC81" href="#SEC81" name="TOC81">The <span style="font-family: courier, mono;">call</span> Function</a></li>
<li><a id="TOC82" href="#SEC82" name="TOC82">The <span style="font-family: courier, mono;">origin</span> Function</a></li>
<li><a id="TOC83" href="#SEC83" name="TOC83">The <span style="font-family: courier, mono;">shell</span> Function</a></li>
<li><a id="TOC84" href="#SEC84" name="TOC84">Functions That Control Make</a></li>
</ul>
</li>
<li>
<a id="TOC85" href="#SEC85" name="TOC85">How to Run <span style="font-family: courier, mono;">make</span></a>
<ul>
<li><a id="TOC86" href="#SEC86" name="TOC86">Arguments to Specify the Makefile</a></li>
<li><a id="TOC87" href="#SEC87" name="TOC87">Arguments to Specify the Goals</a></li>
<li><a id="TOC88" href="#SEC88" name="TOC88">Instead of Executing the Commands</a></li>
<li><a id="TOC89" href="#SEC89" name="TOC89">Avoiding Recompilation of Some Files</a></li>
<li><a id="TOC90" href="#SEC90" name="TOC90">Overriding Variables</a></li>
<li><a id="TOC91" href="#SEC91" name="TOC91">Testing the Compilation of a Program</a></li>
<li><a id="TOC92" href="#SEC92" name="TOC92">Summary of Options</a></li>
</ul>
</li>
<li>
<a id="TOC93" href="#SEC93" name="TOC93">Using Implicit Rules</a>
<ul>
<li><a id="TOC94" href="#SEC94" name="TOC94">Using Implicit Rules</a></li>
<li><a id="TOC95" href="#SEC95" name="TOC95">Catalogue of Implicit Rules</a></li>
<li><a id="TOC96" href="#SEC96" name="TOC96">Variables Used by Implicit Rules</a></li>
<li><a id="TOC97" href="#SEC97" name="TOC97">Chains of Implicit Rules</a></li>
<li>
<a id="TOC98" href="#SEC98" name="TOC98">Defining and Redefining Pattern Rules</a>
<ul>
<li><a id="TOC99" href="#SEC99" name="TOC99">Introduction to Pattern Rules</a></li>
<li><a id="TOC100" href="#SEC100" name="TOC100">Pattern Rule Examples</a></li>
<li><a id="TOC101" href="#SEC101" name="TOC101">Automatic Variables</a></li>
<li><a id="TOC102" href="#SEC102" name="TOC102">How Patterns Match</a></li>
<li><a id="TOC103" href="#SEC103" name="TOC103">Match-Anything Pattern Rules</a></li>
<li><a id="TOC104" href="#SEC104" name="TOC104">Canceling Implicit Rules</a></li>
</ul>
</li>
<li><a id="TOC105" href="#SEC105" name="TOC105">Defining Last-Resort Default Rules</a></li>
<li><a id="TOC106" href="#SEC106" name="TOC106">Old-Fashioned Suffix Rules</a></li>
<li><a id="TOC107" href="#SEC107" name="TOC107">Implicit Rule Search Algorithm</a></li>
</ul>
</li>
<li>
<a id="TOC108" href="#SEC108" name="TOC108">Using <span style="font-family: courier, mono;">make</span> to Update Archive Files</a>
<ul>
<li><a id="TOC109" href="#SEC109" name="TOC109">Archive Members as Targets</a></li>
<li>
<a id="TOC110" href="#SEC110" name="TOC110">Implicit Rule for Archive Member Targets</a>
<ul>
<li><a id="TOC111" href="#SEC111" name="TOC111">Updating Archive Symbol Directories</a></li>
</ul>
</li>
<li><a id="TOC112" href="#SEC112" name="TOC112">Dangers When Using Archives</a></li>
<li><a id="TOC113" href="#SEC113" name="TOC113">Suffix Rules for Archive Files</a></li>
</ul>
</li>
<li><a id="TOC114" href="#SEC114" name="TOC114">Features of GNU <span style="font-family: courier, mono;">make</span></a></li>
<li><a id="TOC115" href="#SEC115" name="TOC115">Incompatibilities and Missing Features</a></li>
<li>
<a id="TOC116" href="#SEC116" name="TOC116">Makefile Conventions</a>
<ul>
<li><a id="TOC117" href="#SEC117" name="TOC117">General Conventions for Makefiles</a></li>
<li><a id="TOC118" href="#SEC118" name="TOC118">Utilities in Makefiles</a></li>
<li><a id="TOC119" href="#SEC119" name="TOC119">Variables for Specifying Commands</a></li>
<li><a id="TOC120" href="#SEC120" name="TOC120">Variables for Installation Directories</a></li>
<li><a id="TOC121" href="#SEC121" name="TOC121">Standard Targets for Users</a></li>
<li><a id="TOC122" href="#SEC122" name="TOC122">Install Command Categories</a></li>
</ul>
</li>
<li><a id="TOC123" href="#SEC123" name="TOC123">Quick Reference</a></li>
<li><a id="TOC124" href="#SEC124" name="TOC124">Errors Generated by Make</a></li>
<li><a id="TOC125" href="#SEC125" name="TOC125">Complex Makefile Example</a></li>
<li><a id="TOC126" href="#SEC126" name="TOC126">Index of Concepts</a></li>
<li><a id="TOC127" href="#SEC127" name="TOC127">Index of Functions, Variables, &amp; Directives</a></li>
</ul>
<a id="SEC1" href="#TOC1" name="SEC1"><h2 class="subhead">Overview of <span style="font-family: courier, mono;">make</span>
</h2></a><a id="SEC1" href="#TOC1" name="SEC1"></a>
<p>The <span style="font-family: courier, mono;">make</span> utility automatically determines which pieces of a large program need to be recompiled, and issues commands to recompile them. This manual describes GNU <span style="font-family: courier, mono;">make</span>, which was implemented by Richard Stallman and Roland McGrath. Development since Version 3.76 has been handled by Paul D. Smith.</p>
<p>GNU <span style="font-family: courier, mono;">make</span> conforms to section 6.2 of <cite>IEEE Standard 1003.2-1992</cite> (POSIX.2). <a id="IDX1" name="IDX1"></a><a id="IDX2" name="IDX2"></a><a id="IDX3" name="IDX3"></a></p>
<p>Our examples show C programs, since they are most common, but you can use <span style="font-family: courier, mono;">make</span> with any programming language whose compiler can be run with a shell command. Indeed, <span style="font-family: courier, mono;">make</span> is not limited to programs. You can use it to describe any task where some files must be updated automatically from others whenever the others change.</p>
<p>To prepare to use <span style="font-family: courier, mono;">make</span>, you must write a file called the <strong>makefile</strong> that describes the relationships among files in your program and provides commands for updating each file. In a program, typically, the executable file is updated from object files, which are in turn made by compiling source files.</p>
<p>Once a suitable makefile exists, each time you change some source files, this simple shell command:</p>
<p>make</p>
<p>suffices to perform all necessary recompilations. The <span style="font-family: courier, mono;">make</span> program uses the makefile data base and the last-modification times of the files to decide which of the files need to be updated. For each of those files, it issues the commands recorded in the data base.</p>
<p>You can provide command line arguments to <span style="font-family: courier, mono;">make</span> to control which files should be recompiled, or how. See section <a href="#SEC85">How to Run <span style="font-family: courier, mono;">make</span></a>.</p>
<p></p>
<h2 class="subhead"><a id="SEC2" href="#TOC2" name="SEC2"></a></h2>
<h2 class="subhead">How to Read This Manual<a id="SEC2" href="#TOC2" name="SEC2"></a>
</h2>
<p>If you are new to <span style="font-family: courier, mono;">make</span>, or are looking for a general introduction, read the first few sections of each chapter, skipping the later sections. In each chapter, the first few sections contain introductory or general information and the later sections contain specialized or technical information. The exception is section <a href="#SEC4">An Introduction to Makefiles</a>, all of which is introductory.</p>
<p>If you are familiar with other <span style="font-family: courier, mono;">make</span> programs, see section <a href="#SEC114">Features of GNU <span style="font-family: courier, mono;">make</span></a>, which lists the enhancements GNU <span style="font-family: courier, mono;">make</span> has, and section <a href="#SEC115">Incompatibilities and Missing Features</a>, which explains the few things GNU <span style="font-family: courier, mono;">make</span> lacks that others have.</p>
<p>For a quick summary, see section <a href="#SEC92">Summary of Options</a>, section <a href="#SEC123">Quick Reference</a>, and section <a href="#SEC36">Special Built-in Target Names</a>.</p>
<p><a id="SEC3" href="#TOC3" name="SEC3"><h2 class="subhead">Problems and Bugs</h2></a></p>
<p>If you have problems with GNU <span style="font-family: courier, mono;">make</span> or think you've found a bug, please report it to the developers; we cannot promise to do anything but we might well want to fix it.</p>
<p>Before reporting a bug, make sure you've actually found a real bug. Carefully reread the documentation and see if it really says you can do what you're trying to do. If it's not clear whether you should be able to do something or not, report that too; it's a bug in the documentation!</p>
<p>Before reporting a bug or trying to fix it yourself, try to isolate it to the smallest possible makefile that reproduces the problem. Then send us the makefile and the exact results <span style="font-family: courier, mono;">make</span> gave you. Also say what you expected to occur; this will help us decide whether the problem was really in the documentation.</p>
<p>Once you've got a precise problem, please send electronic mail to:</p>
<p>bug-make@gnu.org</p>
<p>Please include the version number of <span style="font-family: courier, mono;">make</span> you are using. You can get this information with the command <samp>`make --version'</samp>. Be sure also to include the type of machine and operating system you are using. If possible, include the contents of the file <tt>`config.h'</tt> that is generated by the configuration process.</p>
<h2 class="subhead"><a id="SEC4" href="#TOC4" name="SEC4">An Introduction to Makefiles</a></h2>
<p>You need a file called a <strong>makefile</strong> to tell <span style="font-family: courier, mono;">make</span> what to do. Most often, the makefile tells <span style="font-family: courier, mono;">make</span> how to compile and link a program. <a id="IDX7" name="IDX7"></a></p>
<p>In this chapter, we will discuss a simple makefile that describes how to compile and link a text editor which consists of eight C source files and three header files. The makefile can also tell <span style="font-family: courier, mono;">make</span> how to run miscellaneous commands when explicitly asked (for example, to remove certain files as a clean-up operation). To see a more complex example of a makefile, see section <a href="#SEC125">Complex Makefile Example</a>.</p>
<p>When <span style="font-family: courier, mono;">make</span> recompiles the editor, each changed C source file must be recompiled. If a header file has changed, each C source file that includes the header file must be recompiled to be safe. Each compilation produces an object file corresponding to the source file. Finally, if any source file has been recompiled, all the object files, whether newly made or saved from previous compilations, must be linked together to produce the new executable editor. <a id="IDX8" name="IDX8"></a><a id="IDX9" name="IDX9"></a></p>
<h2 class="subhead"><a id="SEC5" href="#TOC5" name="SEC5">What a Rule Looks Like</a></h2>
<p><a id="IDX10" name="IDX10"></a><a id="IDX11" name="IDX11"></a><a id="IDX12" name="IDX12"></a> </p>
<p>A simple makefile consists of "rules" with the following shape:</p>
<p><a id="IDX13" name="IDX13"></a><a id="IDX14" name="IDX14"></a><a id="IDX15" name="IDX15"></a> </p>
<p><var>target</var> ... : <var>prerequisites</var> ... <var>command</var> ... ...</p>
<p>A <strong>target</strong> is usually the name of a file that is generated by a program; examples of targets are executable or object files. A target can also be the name of an action to carry out, such as <samp>`clean'</samp> (see section <a href="#SEC33">Phony Targets</a>).</p>
<p>A <strong>prerequisite</strong> is a file that is used as input to create the target. A target often depends on several files.</p>
<p><a id="IDX16" name="IDX16"></a>A <strong>command</strong> is an action that <span style="font-family: courier, mono;">make</span> carries out. A rule may have more than one command, each on its own line. <strong>Please note:</strong> you need to put a tab character at the beginning of every command line! This is an obscurity that catches the unwary.</p>
<p>Usually a command is in a rule with prerequisites and serves to create a target file if any of the prerequisites change. However, the rule that specifies commands for the target need not have prerequisites. For example, the rule containing the delete command associated with the target <samp>`clean'</samp> does not have prerequisites.</p>
<p>A <strong>rule</strong>, then, explains how and when to remake certain files which are the targets of the particular rule. <span style="font-family: courier, mono;">make</span> carries out the commands on the prerequisites to create or update the target. A rule can also explain how and when to carry out an action. See section <a href="#SEC20">Writing Rules</a>.</p>
<p>A makefile may contain other text besides rules, but a simple makefile need only contain rules. Rules may look somewhat more complicated than shown in this template, but all fit the pattern more or less.</p>
<h2 class="subhead"><a id="SEC6" href="#TOC6" name="SEC6">A Simple Makefile</a></h2>
<p><a id="IDX17" name="IDX17"></a><a id="IDX18" name="IDX18"></a> </p>
<p>Here is a straightforward makefile that describes the way an executable file called <span style="font-family: courier, mono;">edit</span> depends on eight object files which, in turn, depend on eight C source and three header files.</p>
<p>In this example, all the C files include <tt>`defs.h'</tt>, but only those defining editing commands include <tt>`command.h'</tt>, and only low level files that change the editor buffer include <tt>`buffer.h'</tt>.</p>
<p>edit : main.o kbd.o command.o display.o \ insert.o search.o files.o utils.o cc -o edit main.o kbd.o command.o display.o \ insert.o search.o files.o utils.omain.o : main.c defs.h cc -c main.ckbd.o : kbd.c defs.h command.h cc -c kbd.c command.o : command.c defs.h command.h cc -c command.c display.o : display.c defs.h buffer.h cc -c display.c insert.o : insert.c defs.h buffer.h cc -c insert.c search.o : search.c defs.h buffer.h cc -c search.c files.o : files.c defs.h buffer.h command.h cc -c files.c utils.o : utils.c defs.h cc -c utils.cclean : rm edit main.o kbd.o command.o display.o \ insert.o search.o files.o utils.o</p>
<p>We split each long line into two lines using backslash-newline; this is like using one long line, but is easier to read. <a id="IDX19" name="IDX19"></a><a id="IDX20" name="IDX20"></a><a id="IDX21" name="IDX21"></a><a id="IDX22" name="IDX22"></a><a id="IDX23" name="IDX23"></a></p>
<p>To use this makefile to create the executable file called <tt>`edit'</tt>, type:</p>
<p>make</p>
<p>To use this makefile to delete the executable file and all the object files from the directory, type:</p>
<p>make clean</p>
<p>In the example makefile, the targets include the executable file <samp>`edit'</samp>, and the object files <samp>`main.o'</samp> and <samp>`kbd.o'</samp>. The prerequisites are files such as <samp>`main.c'</samp> and <samp>`defs.h'</samp>. In fact, each <samp>`.o'</samp> file is both a target and a prerequisite. Commands include <samp>`cc -c main.c'</samp> and <samp>`cc -c kbd.c'</samp>.</p>
<p>When a target is a file, it needs to be recompiled or relinked if any of its prerequisites change. In addition, any prerequisites that are themselves automatically generated should be updated first. In this example, <tt>`edit'</tt> depends on each of the eight object files; the object file <tt>`main.o'</tt> depends on the source file <tt>`main.c'</tt> and on the header file <tt>`defs.h'</tt>.</p>
<p>A shell command follows each line that contains a target and prerequisites. These shell commands say how to update the target file. A tab character must come at the beginning of every command line to distinguish commands lines from other lines in the makefile. (Bear in mind that <span style="font-family: courier, mono;">make</span> does not know anything about how the commands work. It is up to you to supply commands that will update the target file properly. All <span style="font-family: courier, mono;">make</span> does is execute the commands in the rule you have specified when the target file needs to be updated.) <a id="IDX24" name="IDX24"></a></p>
<p>The target <samp>`clean'</samp> is not a file, but merely the name of an action. Since you normally do not want to carry out the actions in this rule, <samp>`clean'</samp> is not a prerequisite of any other rule. Consequently, <span style="font-family: courier, mono;">make</span> never does anything with it unless you tell it specifically. Note that this rule not only is not a prerequisite, it also does not have any prerequisites, so the only purpose of the rule is to run the specified commands. Targets that do not refer to files but are just actions are called <strong>phony targets</strong>. See section <a href="#SEC33">Phony Targets</a>, for information about this kind of target. See section <a href="#SEC48">Errors in Commands</a>, to see how to cause <span style="font-family: courier, mono;">make</span> to ignore errors from <span style="font-family: courier, mono;">rm</span> or any other command. <a id="IDX25" name="IDX25"></a><a id="IDX26" name="IDX26"></a></p>
<h2 class="subhead"><a id="SEC7" href="#TOC7" name="SEC7">How <span style="font-family: courier, mono;">make</span> Processes a Makefile</a></h2>
<p><a id="IDX27" name="IDX27"></a><a id="IDX28" name="IDX28"></a> </p>
<p>By default, <span style="font-family: courier, mono;">make</span> starts with the first target (not targets whose names start with <samp>`.'</samp>). This is called the <strong>default goal</strong>. (<strong>Goals</strong> are the targets that <span style="font-family: courier, mono;">make</span> strives ultimately to update. See section <a href="#SEC87">Arguments to Specify the Goals</a>.) <a id="IDX29" name="IDX29"></a><a id="IDX30" name="IDX30"></a><a id="IDX31" name="IDX31"></a></p>
<p>In the simple example of the previous section, the default goal is to update the executable program <tt>`edit'</tt>; therefore, we put that rule first.</p>
<p>Thus, when you give the command:</p>
<p>make</p>
<p><span style="font-family: courier, mono;">make</span> reads the makefile in the current directory and begins by processing the first rule. In the example, this rule is for relinking <tt>`edit'</tt>; but before <span style="font-family: courier, mono;">make</span> can fully process this rule, it must process the rules for the files that <tt>`edit'</tt> depends on, which in this case are the object files. Each of these files is processed according to its own rule. These rules say to update each <samp>`.o'</samp> file by compiling its source file. The recompilation must be done if the source file, or any of the header files named as prerequisites, is more recent than the object file, or if the object file does not exist.</p>
<p>The other rules are processed because their targets appear as prerequisites of the goal. If some other rule is not depended on by the goal (or anything it depends on, etc.), that rule is not processed, unless you tell <span style="font-family: courier, mono;">make</span> to do so (with a command such as <span style="font-family: courier, mono;">make clean</span>).</p>
<p>Before recompiling an object file, <span style="font-family: courier, mono;">make</span> considers updating its prerequisites, the source file and header files. This makefile does not specify anything to be done for them--the <samp>`.c'</samp> and <samp>`.h'</samp> files are not the targets of any rules--so <span style="font-family: courier, mono;">make</span> does nothing for these files. But <span style="font-family: courier, mono;">make</span> would update automatically generated C programs, such as those made by Bison or Yacc, by their own rules at this time.</p>
<p>After recompiling whichever object files need it, <span style="font-family: courier, mono;">make</span> decides whether to relink <tt>`edit'</tt>. This must be done if the file <tt>`edit'</tt> does not exist, or if any of the object files are newer than it. If an object file was just recompiled, it is now newer than <tt>`edit'</tt>, so <tt>`edit'</tt> is relinked. <a id="IDX32" name="IDX32"></a></p>
<p>Thus, if we change the file <tt>`insert.c'</tt> and run <span style="font-family: courier, mono;">make</span>, <span style="font-family: courier, mono;">make</span> will compile that file to update <tt>`insert.o'</tt>, and then link <tt>`edit'</tt>. If we change the file <tt>`command.h'</tt> and run <span style="font-family: courier, mono;">make</span>, <span style="font-family: courier, mono;">make</span> will recompile the object files <tt>`kbd.o'</tt>, <tt>`command.o'</tt> and <tt>`files.o'</tt> and then link the file <tt>`edit'</tt>.</p>
<p><a id="SEC8" href="#TOC8" name="SEC8">Variables Make Makefiles Simpler</a></p>
<p><a id="IDX33" name="IDX33"></a><a id="IDX34" name="IDX34"></a> </p>
<p>In our example, we had to list all the object files twice in the rule for <tt>`edit'</tt> (repeated here):</p>
<p>edit : main.o kbd.o command.o display.o \ insert.o search.o files.o utils.o cc -o edit main.o kbd.o command.o display.o \ insert.o search.o files.o utils.o</p>
<p><a id="IDX35" name="IDX35"></a>Such duplication is error-prone; if a new object file is added to the system, we might add it to one list and forget the other. We can eliminate the risk and simplify the makefile by using a variable. <strong>Variables</strong> allow a text string to be defined once and substituted in multiple places later (see section <a href="#SEC57">How to Use Variables</a>).</p>
<p><a id="IDX36" name="IDX36"></a><a id="IDX37" name="IDX37"></a><a id="IDX38" name="IDX38"></a><a id="IDX39" name="IDX39"></a><a id="IDX40" name="IDX40"></a>It is standard practice for every makefile to have a variable named <span style="font-family: courier, mono;">objects</span>, <span style="font-family: courier, mono;">OBJECTS</span>, <span style="font-family: courier, mono;">objs</span>, <span style="font-family: courier, mono;">OBJS</span>, <span style="font-family: courier, mono;">obj</span>, or <span style="font-family: courier, mono;">OBJ</span> which is a list of all object file names. We would define such a variable <span style="font-family: courier, mono;">objects</span> with a line like this in the makefile:</p>
<p>objects = main.o kbd.o command.o display.o \ insert.o search.o files.o utils.o</p>
<p>Then, each place we want to put a list of the object file names, we can substitute the variable's value by writing <samp>`$(objects)'</samp> (see section <a href="#SEC57">How to Use Variables</a>).</p>
<p>Here is how the complete simple makefile looks when you use a variable for the object files:</p>
<p>objects = main.o kbd.o command.o display.o \ insert.o search.o files.o utils.oedit : $(objects) cc -o edit $(objects)main.o : main.c defs.h cc -c main.c kbd.o : kbd.c defs.h command.h cc -c kbd.c command.o : command.c defs.h command.h cc -c command.c display.o : display.c defs.h buffer.h cc -c display.c insert.o : insert.c defs.h buffer.h cc -c insert.c search.o : search.c defs.h buffer.h cc -c search.c files.o : files.c defs.h buffer.h command.h cc -c files.c utils.o : utils.c defs.h cc -c utils.cclean : rm edit $(objects)</p>
<p><a id="SEC9" href="#TOC9" name="SEC9">Letting <span style="font-family: courier, mono;">make</span> Deduce the Commands</a></p>
<p><a id="IDX41" name="IDX41"></a><a id="IDX42" name="IDX42"></a><a id="IDX43" name="IDX43"></a> </p>
<p>It is not necessary to spell out the commands for compiling the individual C source files, because <span style="font-family: courier, mono;">make</span> can figure them out: it has an <strong>implicit rule</strong> for updating a <samp>`.o'</samp> file from a correspondingly named <samp>`.c'</samp> file using a <samp>`cc -c'</samp> command. For example, it will use the command <samp>`cc -c main.c -o main.o'</samp> to compile <tt>`main.c'</tt> into <tt>`main.o'</tt>. We can therefore omit the commands from the rules for the object files. See section <a href="#SEC93">Using Implicit Rules</a>.</p>
<p>When a <samp>`.c'</samp> file is used automatically in this way, it is also automatically added to the list of prerequisites. We can therefore omit the <samp>`.c'</samp> files from the prerequisites, provided we omit the commands.</p>
<p>Here is the entire example, with both of these changes, and a variable <span style="font-family: courier, mono;">objects</span> as suggested above:</p>
<p>objects = main.o kbd.o command.o display.o \ insert.o search.o files.o utils.oedit : $(objects) cc -o edit $(objects)main.o : defs.hkbd.o : defs.h command.h command.o : defs.h command.hdisplay.o : defs.h buffer.h insert.o : defs.h buffer.hsearch.o : defs.h buffer.h files.o : defs.h buffer.h command.hutils.o : defs.h.PHONY : cleanclean : -rm edit $(objects)</p>
<p>This is how we would write the makefile in actual practice. (The complications associated with <samp>`clean'</samp> are described elsewhere. See section <a href="#SEC33">Phony Targets</a>, and section <a href="#SEC48">Errors in Commands</a>.)</p>
<p>Because implicit rules are so convenient, they are important. You will see them used frequently.</p>
<h2 class="subhead"><a id="SEC10" href="#TOC10" name="SEC10">Another Style of Makefile</a></h2>
<p><a id="IDX44" name="IDX44"></a> </p>
<p>When the objects of a makefile are created only by implicit rules, an alternative style of makefile is possible. In this style of makefile, you group entries by their prerequisites instead of by their targets. Here is what one looks like:</p>
<p>objects = main.o kbd.o command.o display.o \ insert.o search.o files.o utils.oedit : $(objects) cc -o edit $(objects)$(objects) : defs.h kbd.o command.o files.o : command.h display.o insert.o search.o files.o : buffer.h</p>
<p>Here <tt>`defs.h'</tt> is given as a prerequisite of all the object files; <tt>`command.h'</tt> and <tt>`buffer.h'</tt> are prerequisites of the specific object files listed for them.</p>
<p>Whether this is better is a matter of taste: it is more compact, but some people dislike it because they find it clearer to put all the information about each target in one place.</p>
<h2 class="subhead"><a id="SEC11" href="#TOC11" name="SEC11">Rules for Cleaning the Directory</a></h2>
<p><a id="IDX45" name="IDX45"></a><a id="IDX46" name="IDX46"></a> </p>
<p>Compiling a program is not the only thing you might want to write rules for. Makefiles commonly tell how to do a few other things besides compiling a program: for example, how to delete all the object files and executables so that the directory is <samp>`clean'</samp>.</p>
<p><a id="IDX47" name="IDX47"></a>Here is how we could write a <span style="font-family: courier, mono;">make</span> rule for cleaning our example editor:</p>
<p>clean: rm edit $(objects)</p>
<p>In practice, we might want to write the rule in a somewhat more complicated manner to handle unanticipated situations. We would do this:</p>
<p>.PHONY : cleanclean : -rm edit $(objects)</p>
<p>This prevents <span style="font-family: courier, mono;">make</span> from getting confused by an actual file called <tt>`clean'</tt> and causes it to continue in spite of errors from <span style="font-family: courier, mono;">rm</span>. (See section <a href="#SEC33">Phony Targets</a>, and section <a href="#SEC48">Errors in Commands</a>.)</p>
<p>A rule such as this should not be placed at the beginning of the makefile, because we do not want it to run by default! Thus, in the example makefile, we want the rule for <span style="font-family: courier, mono;">edit</span>, which recompiles the editor, to remain the default goal.</p>
<p>Since <span style="font-family: courier, mono;">clean</span> is not a prerequisite of <span style="font-family: courier, mono;">edit</span>, this rule will not run at all if we give the command <samp>`make'</samp> with no arguments. In order to make the rule run, we have to type <samp>`make clean'</samp>. See section <a href="#SEC85">How to Run <span style="font-family: courier, mono;">make</span></a>.</p>
<h2 class="subhead"><a id="SEC12" href="#TOC12" name="SEC12">Writing Makefiles</a></h2>
<p><a id="IDX48" name="IDX48"></a>The information that tells <span style="font-family: courier, mono;">make</span> how to recompile a system comes from reading a data base called the <strong>makefile</strong>.</p>
<h2 class="subhead"><a id="SEC13" href="#TOC13" name="SEC13">What Makefiles Contain</a></h2>
<p>Makefiles contain five kinds of things: <strong>explicit rules</strong>, <strong>implicit rules</strong>, <strong>variable definitions</strong>, <strong>directives</strong>, and <strong>comments</strong>. Rules, variables, and directives are described at length in later chapters.</p>
<ul>
<li>
<a id="IDX49" name="IDX49"></a><a id="IDX50" name="IDX50"></a>An <strong>explicit rule</strong> says when and how to remake one or more files, called the rule's targets. It lists the other files that the targets depend on, call the <strong>prerequisites</strong> of the target, and may also give commands to use to create or update the targets. See section <a href="#SEC20">Writing Rules</a>. <a id="IDX51" name="IDX51"></a><a id="IDX52" name="IDX52"></a>
</li>
<li>An <strong>implicit rule</strong> says when and how to remake a class of files based on their names. It describes how a target may depend on a file with a name similar to the target and gives commands to create or update such a target. See section <a href="#SEC93">Using Implicit Rules</a>. <a id="IDX53" name="IDX53"></a>
</li>
<li>A <strong>variable definition</strong> is a line that specifies a text string value for a variable that can be substituted into the text later. The simple makefile example shows a variable definition for <span style="font-family: courier, mono;">objects</span> as a list of all object files (see section <a href="#SEC8">Variables Make Makefiles Simpler</a>). <a id="IDX54" name="IDX54"></a>
</li>
<li>A <strong>directive</strong> is a command for <span style="font-family: courier, mono;">make</span> to do something special while reading the makefile. These include:
<ul>
<li>Reading another makefile (see section <a href="#SEC15">Including Other Makefiles</a>).</li>
<li>Deciding (based on the values of variables) whether to use or ignore a part of the makefile (see section <a href="#SEC71">Conditional Parts of Makefiles</a>).</li>
<li>Defining a variable from a verbatim string containing multiple lines (see section <a href="#SEC67">Defining Variables Verbatim</a>).</li>
</ul>
<a id="IDX55" name="IDX55"></a><a id="IDX56" name="IDX56"></a>
</li>
<li>
<samp>`#'</samp> in a line of a makefile starts a <strong>comment</strong>. It and the rest of the line are ignored, except that a trailing backslash not escaped by another backslash will continue the comment across multiple lines. Comments may appear on any of the lines in the makefile, except within a <span style="font-family: courier, mono;">define</span> directive, and perhaps within commands (where the shell decides what is a comment). A line containing just a comment (with perhaps spaces before it) is effectively blank, and is ignored.</li>
</ul>
<h2 class="subhead"><a id="SEC14" href="#TOC14" name="SEC14">What Name to Give Your Makefile</a></h2>
<p><a id="IDX57" name="IDX57"></a><a id="IDX58" name="IDX58"></a><a id="IDX59" name="IDX59"></a><a id="IDX60" name="IDX60"></a> </p>
<p>By default, when <span style="font-family: courier, mono;">make</span> looks for the makefile, it tries the following names, in order: <tt>`GNUmakefile'</tt>, <tt>`makefile'</tt> and <tt>`Makefile'</tt>.<a id="IDX61" name="IDX61"></a><a id="IDX62" name="IDX62"></a><a id="IDX63" name="IDX63"></a></p>
<p><a id="IDX64" name="IDX64"></a>Normally you should call your makefile either <tt>`makefile'</tt> or <tt>`Makefile'</tt>. (We recommend <tt>`Makefile'</tt> because it appears prominently near the beginning of a directory listing, right near other important files such as <tt>`README'</tt>.) The first name checked, <tt>`GNUmakefile'</tt>, is not recommended for most makefiles. You should use this name if you have a makefile that is specific to GNU <span style="font-family: courier, mono;">make</span>, and will not be understood by other versions of <span style="font-family: courier, mono;">make</span>. Other <span style="font-family: courier, mono;">make</span> programs look for <tt>`makefile'</tt> and <tt>`Makefile'</tt>, but not <tt>`GNUmakefile'</tt>.</p>
<p>If <span style="font-family: courier, mono;">make</span> finds none of these names, it does not use any makefile. Then you must specify a goal with a command argument, and <span style="font-family: courier, mono;">make</span> will attempt to figure out how to remake it using only its built-in implicit rules. See section <a href="#SEC93">Using Implicit Rules</a>.</p>
<p><a id="IDX65" name="IDX65"></a><a id="IDX66" name="IDX66"></a><a id="IDX67" name="IDX67"></a>If you want to use a nonstandard name for your makefile, you can specify the makefile name with the <samp>`-f'</samp> or <samp>`--file'</samp> option. The arguments <samp>`-f <var>name</var>'</samp> or <samp>`--file=<var>name</var>'</samp> tell <span style="font-family: courier, mono;">make</span> to read the file <var>name</var> as the makefile. If you use more than one <samp>`-f'</samp> or <samp>`--file'</samp> option, you can specify several makefiles. All the makefiles are effectively concatenated in the order specified. The default makefile names <tt>`GNUmakefile'</tt>, <tt>`makefile'</tt> and <tt>`Makefile'</tt> are not checked automatically if you specify <samp>`-f'</samp> or <samp>`--file'</samp>.<a id="IDX68" name="IDX68"></a> <a id="IDX69" name="IDX69"></a><a id="IDX70" name="IDX70"></a><a id="IDX71" name="IDX71"></a></p>
<p><a id="SEC15" href="#TOC15" name="SEC15">Including Other Makefiles</a></p>
<p><a id="IDX72" name="IDX72"></a><a id="IDX73" name="IDX73"></a> </p>
<p><a id="IDX74" name="IDX74"></a>The <span style="font-family: courier, mono;">include</span> directive tells <span style="font-family: courier, mono;">make</span> to suspend reading the current makefile and read one or more other makefiles before continuing. The directive is a line in the makefile that looks like this:</p>
<p>include <var>filenames</var>...</p>
<p><var>filenames</var> can contain shell file name patterns. <a id="IDX75" name="IDX75"></a><a id="IDX76" name="IDX76"></a><a id="IDX77" name="IDX77"></a></p>
<p>Extra spaces are allowed and ignored at the beginning of the line, but a tab is not allowed. (If the line begins with a tab, it will be considered a command line.) Whitespace is required between <span style="font-family: courier, mono;">include</span> and the file names, and between file names; extra whitespace is ignored there and at the end of the directive. A comment starting with <samp>`#'</samp> is allowed at the end of the line. If the file names contain any variable or function references, they are expanded. See section <a href="#SEC57">How to Use Variables</a>.</p>
<p>For example, if you have three <tt>`.mk'</tt> files, <tt>`a.mk'</tt>, <tt>`b.mk'</tt>, and <tt>`c.mk'</tt>, and <span style="font-family: courier, mono;">$(bar)</span> expands to <span style="font-family: courier, mono;">bish bash</span>, then the following expression</p>
<p>include foo *.mk $(bar)</p>
<p>is equivalent to</p>
<p>include foo a.mk b.mk c.mk bish bash</p>
<p>When <span style="font-family: courier, mono;">make</span> processes an <span style="font-family: courier, mono;">include</span> directive, it suspends reading of the containing makefile and reads from each listed file in turn. When that is finished, <span style="font-family: courier, mono;">make</span> resumes reading the makefile in which the directive appears.</p>
<p>One occasion for using <span style="font-family: courier, mono;">include</span> directives is when several programs, handled by individual makefiles in various directories, need to use a common set of variable definitions (see section <a href="#SEC64">Setting Variables</a>) or pattern rules (see section <a href="#SEC98">Defining and Redefining Pattern Rules</a>).</p>
<p>Another such occasion is when you want to generate prerequisites from source files automatically; the prerequisites can be put in a file that is included by the main makefile. This practice is generally cleaner than that of somehow appending the prerequisites to the end of the main makefile as has been traditionally done with other versions of <span style="font-family: courier, mono;">make</span>. See section <a href="#SEC43">Generating Prerequisites Automatically</a>. <a id="IDX78" name="IDX78"></a><a id="IDX79" name="IDX79"></a><a id="IDX80" name="IDX80"></a></p>
<p><a id="IDX81" name="IDX81"></a><a id="IDX82" name="IDX82"></a><a id="IDX83" name="IDX83"></a><a id="IDX84" name="IDX84"></a><a id="IDX85" name="IDX85"></a><a id="IDX86" name="IDX86"></a><a id="IDX87" name="IDX87"></a>If the specified name does not start with a slash, and the file is not found in the current directory, several other directories are searched. First, any directories you have specified with the <samp>`-I'</samp> or <samp>`--include-dir'</samp> option are searched (see section <a href="#SEC92">Summary of Options</a>). Then the following directories (if they exist) are searched, in this order: <tt>`<var>prefix</var>/include'</tt> (normally <tt>`/usr/local/include'</tt> <a id="DOCF1" href="#FOOT1" name="DOCF1">(1)</a>) <tt>`/usr/gnu/include'</tt>, <tt>`/usr/local/include'</tt>, <tt>`/usr/include'</tt>.</p>
<p>If an included makefile cannot be found in any of these directories, a warning message is generated, but it is not an immediately fatal error; processing of the makefile containing the <span style="font-family: courier, mono;">include</span> continues. Once it has finished reading makefiles, <span style="font-family: courier, mono;">make</span> will try to remake any that are out of date or don't exist. See section <a href="#SEC17">How Makefiles Are Remade</a>. Only after it has tried to find a way to remake a makefile and failed, will <span style="font-family: courier, mono;">make</span> diagnose the missing makefile as a fatal error.</p>
<p>If you want <span style="font-family: courier, mono;">make</span> to simply ignore a makefile which does not exist and cannot be remade, with no error message, use the <span style="font-family: courier, mono;">-include</span> directive instead of <span style="font-family: courier, mono;">include</span>, like this:</p>
<p>-include <var>filenames</var>...</p>
<p>This is acts like <span style="font-family: courier, mono;">include</span> in every way except that there is no error (not even a warning) if any of the <var>filenames</var> do not exist. For compatibility with some other <span style="font-family: courier, mono;">make</span> implementations, <span style="font-family: courier, mono;">sinclude</span> is another name for <span style="font-family: courier, mono;">-include</span>.</p>
<p><a id="SEC16" href="#TOC16" name="SEC16">The Variable <span style="font-family: courier, mono;">MAKEFILES</span></a></p>
<p><a id="IDX88" name="IDX88"></a><a id="IDX89" name="IDX89"></a> </p>
<p><a id="IDX90" name="IDX90"></a>If the environment variable <span style="font-family: courier, mono;">MAKEFILES</span> is defined, <span style="font-family: courier, mono;">make</span> considers its value as a list of names (separated by whitespace) of additional makefiles to be read before the others. This works much like the <span style="font-family: courier, mono;">include</span> directive: various directories are searched for those files (see section <a href="#SEC15">Including Other Makefiles</a>). In addition, the default goal is never taken from one of these makefiles and it is not an error if the files listed in <span style="font-family: courier, mono;">MAKEFILES</span> are not found.</p>
<p><a id="IDX91" name="IDX91"></a>The main use of <span style="font-family: courier, mono;">MAKEFILES</span> is in communication between recursive invocations of <span style="font-family: courier, mono;">make</span> (see section <a href="#SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>). It usually is not desirable to set the environment variable before a top-level invocation of <span style="font-family: courier, mono;">make</span>, because it is usually better not to mess with a makefile from outside. However, if you are running <span style="font-family: courier, mono;">make</span> without a specific makefile, a makefile in <span style="font-family: courier, mono;">MAKEFILES</span> can do useful things to help the built-in implicit rules work better, such as defining search paths (see section <a href="#SEC26">Searching Directories for Prerequisites</a>).</p>
<p>Some users are tempted to set <span style="font-family: courier, mono;">MAKEFILES</span> in the environment automatically on login, and program makefiles to expect this to be done. This is a very bad idea, because such makefiles will fail to work if run by anyone else. It is much better to write explicit <span style="font-family: courier, mono;">include</span> directives in the makefiles. See section <a href="#SEC15">Including Other Makefiles</a>.</p>
<h2 class="subhead"><a id="SEC17" href="#TOC17" name="SEC17">How Makefiles Are Remade</a></h2>
<p><a id="IDX92" name="IDX92"></a><a id="IDX93" name="IDX93"></a><a id="IDX94" name="IDX94"></a>Sometimes makefiles can be remade from other files, such as RCS or SCCS files. If a makefile can be remade from other files, you probably want <span style="font-family: courier, mono;">make</span> to get an up-to-date version of the makefile to read in.</p>
<p>To this end, after reading in all makefiles, <span style="font-family: courier, mono;">make</span> will consider each as a goal target and attempt to update it. If a makefile has a rule which says how to update it (found either in that very makefile or in another one) or if an implicit rule applies to it (see section <a href="#SEC93">Using Implicit Rules</a>), it will be updated if necessary. After all makefiles have been checked, if any have actually been changed, <span style="font-family: courier, mono;">make</span> starts with a clean slate and reads all the makefiles over again. (It will also attempt to update each of them over again, but normally this will not change them again, since they are already up to date.)</p>
<p>If you know that one or more of your makefiles cannot be remade and you want to keep <span style="font-family: courier, mono;">make</span> from performing an implicit rule search on them, perhaps for efficiency reasons, you can use any normal method of preventing implicit rule lookup to do so. For example, you can write an explicit rule with the makefile as the target, and an empty command string (see section <a href="#SEC56">Using Empty Commands</a>).</p>
<p>If the makefiles specify a double-colon rule to remake a file with commands but no prerequisites, that file will always be remade (see section <a href="#SEC42">Double-Colon Rules</a>). In the case of makefiles, a makefile that has a double-colon rule with commands but no prerequisites will be remade every time <span style="font-family: courier, mono;">make</span> is run, and then again after <span style="font-family: courier, mono;">make</span> starts over and reads the makefiles in again. This would cause an infinite loop: <span style="font-family: courier, mono;">make</span> would constantly remake the makefile, and never do anything else. So, to avoid this, <span style="font-family: courier, mono;">make</span> will <strong>not</strong> attempt to remake makefiles which are specified as targets of a double-colon rule with commands but no prerequisites.</p>
<p>If you do not specify any makefiles to be read with <samp>`-f'</samp> or <samp>`--file'</samp> options, <span style="font-family: courier, mono;">make</span> will try the default makefile names; see section <a href="#SEC14">What Name to Give Your Makefile</a>. Unlike makefiles explicitly requested with <samp>`-f'</samp> or <samp>`--file'</samp> options, <span style="font-family: courier, mono;">make</span> is not certain that these makefiles should exist. However, if a default makefile does not exist but can be created by running <span style="font-family: courier, mono;">make</span> rules, you probably want the rules to be run so that the makefile can be used.</p>
<p>Therefore, if none of the default makefiles exists, <span style="font-family: courier, mono;">make</span> will try to make each of them in the same order in which they are searched for (see section <a href="#SEC14">What Name to Give Your Makefile</a>) until it succeeds in making one, or it runs out of names to try. Note that it is not an error if <span style="font-family: courier, mono;">make</span> cannot find or make any makefile; a makefile is not always necessary.</p>
<p>When you use the <samp>`-t'</samp> or <samp>`--touch'</samp> option (see section <a href="#SEC88">Instead of Executing the Commands</a>), you would not want to use an out-of-date makefile to decide which targets to touch. So the <samp>`-t'</samp> option has no effect on updating makefiles; they are really updated even if <samp>`-t'</samp> is specified. Likewise, <samp>`-q'</samp> (or <samp>`--question'</samp>) and <samp>`-n'</samp> (or <samp>`--just-print'</samp>) do not prevent updating of makefiles, because an out-of-date makefile would result in the wrong output for other targets. Thus, <samp>`make -f mfile -n foo'</samp> will update <tt>`mfile'</tt>, read it in, and then print the commands to update <tt>`foo'</tt> and its prerequisites without running them. The commands printed for <tt>`foo'</tt> will be those specified in the updated contents of <tt>`mfile'</tt>.</p>
<p>However, on occasion you might actually wish to prevent updating of even the makefiles. You can do this by specifying the makefiles as goals in the command line as well as specifying them as makefiles. When the makefile name is specified explicitly as a goal, the options <samp>`-t'</samp> and so on do apply to them.</p>
<p>Thus, <samp>`make -f mfile -n mfile foo'</samp> would read the makefile <tt>`mfile'</tt>, print the commands needed to update it without actually running them, and then print the commands needed to update <tt>`foo'</tt> without running them. The commands for <tt>`foo'</tt> will be those specified by the existing contents of <tt>`mfile'</tt>.</p>
<h2 class="subhead"><a id="SEC18" href="#TOC18" name="SEC18">Overriding Part of Another Makefile</a></h2>
<p><a id="IDX95" name="IDX95"></a><a id="IDX96" name="IDX96"></a>Sometimes it is useful to have a makefile that is mostly just like another makefile. You can often use the <samp>`include'</samp> directive to include one in the other, and add more targets or variable definitions. However, if the two makefiles give different commands for the same target, <span style="font-family: courier, mono;">make</span> will not let you just do this. But there is another way.</p>
<p><a id="IDX97" name="IDX97"></a>In the containing makefile (the one that wants to include the other), you can use a match-anything pattern rule to say that to remake any target that cannot be made from the information in the containing makefile, <span style="font-family: courier, mono;">make</span> should look in another makefile. See section <a href="#SEC98">Defining and Redefining Pattern Rules</a>, for more information on pattern rules.</p>
<p>For example, if you have a makefile called <tt>`Makefile'</tt> that says how to make the target <samp>`foo'</samp> (and other targets), you can write a makefile called <tt>`GNUmakefile'</tt> that contains:</p>
<p>foo: frobnicate &gt; foo%: force @$(MAKE) -f Makefile $@force: ;</p>
<p>If you say <samp>`make foo'</samp>, <span style="font-family: courier, mono;">make</span> will find <tt>`GNUmakefile'</tt>, read it, and see that to make <tt>`foo'</tt>, it needs to run the command <samp>`frobnicate &gt; foo'</samp>. If you say <samp>`make bar'</samp>, <span style="font-family: courier, mono;">make</span> will find no way to make <tt>`bar'</tt> in <tt>`GNUmakefile'</tt>, so it will use the commands from the pattern rule: <samp>`make -f Makefile bar'</samp>. If <tt>`Makefile'</tt> provides a rule for updating <tt>`bar'</tt>, <span style="font-family: courier, mono;">make</span> will apply the rule. And likewise for any other target that <tt>`GNUmakefile'</tt> does not say how to make.</p>
<p>The way this works is that the pattern rule has a pattern of just <samp>`%'</samp>, so it matches any target whatever. The rule specifies a prerequisite <tt>`force'</tt>, to guarantee that the commands will be run even if the target file already exists. We give <tt>`force'</tt> target empty commands to prevent <span style="font-family: courier, mono;">make</span> from searching for an implicit rule to build it--otherwise it would apply the same match-anything rule to <tt>`force'</tt> itself and create a prerequisite loop!</p>
<h2 class="subhead"><a id="SEC19" href="#TOC19" name="SEC19">How <span style="font-family: courier, mono;">make</span> Reads a Makefile</a></h2>
<p><a id="IDX98" name="IDX98"></a><a id="IDX99" name="IDX99"></a> </p>
<p>GNU <span style="font-family: courier, mono;">make</span> does its work in two distinct phases. During the first phase it reads all the makefiles, included makefiles, etc. and internalizes all the variables and their values, implicit and explicit rules, and constructs a dependency graph of all the targets and their prerequisites. During the second phase, <span style="font-family: courier, mono;">make</span> uses these internal structures to determine what targets will need to be rebuilt and to invoke the rules necessary to do so.</p>
<p>It's important to understand this two-phase approach because it has a direct impact on how variable and function expansion happens; this is often a source of some confusion when writing makefiles. Here we will present a summary of the phases in which expansion happens for different constructs within the makefile. We say that expansion is <strong>immediate</strong> if it happens during the first phase: in this case <span style="font-family: courier, mono;">make</span> will expand any variables or functions in that section of a construct as the makefile is parsed. We say that expansion is <strong>deferred</strong> if expansion is not performed immediately. Expansion of deferred construct is not performed until either the construct appears later in an immediate context, or until the second phase.</p>
<p>You may not be familiar with some of these constructs yet. You can reference this section as you become familiar with them, in later chapters.</p>
<h3 class="subsubhead">Variable Assignment</h3>
<p><a id="IDX100" name="IDX100"></a><a id="IDX101" name="IDX101"></a><a id="IDX102" name="IDX102"></a><a id="IDX103" name="IDX103"></a><a id="IDX104" name="IDX104"></a> </p>
<p>Variable definitions are parsed as follows:</p>
<p><var>immediate</var> = <var>deferred</var> <var>immediate</var> ?= <var>deferred</var> <var>immediate</var> := <var>immediate</var> <var>immediate</var> += <var>deferred</var> or <var>immediate</var> define <var>immediate</var> <var>deferred</var>endef</p>
<p>For the append operator, <samp>`+='</samp>, the right-hand side is considered immediate if the variable was previously set as a simple variable (<samp>`:='</samp>), and deferred otherwise.</p>
<h3 class="subsubhead">Conditional Syntax</h3>
<p><a id="IDX105" name="IDX105"></a><a id="IDX106" name="IDX106"></a><a id="IDX107" name="IDX107"></a><a id="IDX108" name="IDX108"></a> </p>
<p>All instances of conditional syntax are parsed immediately, in their entirety; this includes the <span style="font-family: courier, mono;">ifdef</span>, <span style="font-family: courier, mono;">ifeq</span>, <span style="font-family: courier, mono;">ifndef</span>, and <span style="font-family: courier, mono;">ifneq</span> forms.</p>
<h3 class="subsubhead">Rule Definition</h3>
<p><a id="IDX109" name="IDX109"></a><a id="IDX110" name="IDX110"></a><a id="IDX111" name="IDX111"></a><a id="IDX112" name="IDX112"></a><a id="IDX113" name="IDX113"></a> </p>
<p>A rule is always expanded the same way, regardless of the form:</p>
<p><var>immediate</var> : <var>immediate</var> ; <var>deferred</var> <var>deferred</var></p>
<p>That is, the target and prerequisite sections are expanded immediately, and the commands used to construct the target are always deferred. This general rule is true for explicit rules, pattern rules, suffix rules, static pattern rules, and simple prerequisite definitions.</p>
<h2 class="subhead"><a id="SEC20" href="#TOC20" name="SEC20">Writing Rules</a></h2>
<p><a id="IDX114" name="IDX114"></a><a id="IDX115" name="IDX115"></a><a id="IDX116" name="IDX116"></a><a id="IDX117" name="IDX117"></a> </p>
<p>A <strong>rule</strong> appears in the makefile and says when and how to remake certain files, called the rule's <strong>targets</strong> (most often only one per rule). It lists the other files that are the <strong>prerequisites</strong> of the target, and <strong>commands</strong> to use to create or update the target.</p>
<p><a id="IDX118" name="IDX118"></a><a id="IDX119" name="IDX119"></a>The order of rules is not significant, except for determining the <strong>default goal</strong>: the target for <span style="font-family: courier, mono;">make</span> to consider, if you do not otherwise specify one. The default goal is the target of the first rule in the first makefile. If the first rule has multiple targets, only the first target is taken as the default. There are two exceptions: a target starting with a period is not a default unless it contains one or more slashes, <samp>`/'</samp>, as well; and, a target that defines a pattern rule has no effect on the default goal. (See section <a href="#SEC98">Defining and Redefining Pattern Rules</a>.)</p>
<p>Therefore, we usually write the makefile so that the first rule is the one for compiling the entire program or all the programs described by the makefile (often with a target called <samp>`all'</samp>). See section <a href="#SEC87">Arguments to Specify the Goals</a>.</p>
<h2 class="subhead"><a id="SEC21" href="#TOC21" name="SEC21">Rule Syntax</a></h2>
<p><a id="IDX120" name="IDX120"></a><a id="IDX121" name="IDX121"></a>In general, a rule looks like this:</p>
<p><var>targets</var> : <var>prerequisites</var> <var>command</var> ...</p>
<p>or like this:</p>
<p><var>targets</var> : <var>prerequisites</var> ; <var>command</var> <var>command</var> ...</p>
<p><a id="IDX122" name="IDX122"></a><a id="IDX123" name="IDX123"></a>The <var>targets</var> are file names, separated by spaces. Wildcard characters may be used (see section <a href="#SEC22">Using Wildcard Characters in File Names</a>) and a name of the form <tt>`<var>a</var>(<var>m</var>)'</tt> represents member <var>m</var> in archive file <var>a</var> (see section <a href="#SEC109">Archive Members as Targets</a>). Usually there is only one target per rule, but occasionally there is a reason to have more (see section <a href="#SEC37">Multiple Targets in a Rule</a>).</p>
<p><a id="IDX124" name="IDX124"></a><a id="IDX125" name="IDX125"></a>The <var>command</var> lines start with a tab character. The first command may appear on the line after the prerequisites, with a tab character, or may appear on the same line, with a semicolon. Either way, the effect is the same. See section <a href="#SEC44">Writing the Commands in Rules</a>.</p>
<p><a id="IDX126" name="IDX126"></a><a id="IDX127" name="IDX127"></a><a id="IDX128" name="IDX128"></a>Because dollar signs are used to start variable references, if you really want a dollar sign in a rule you must write two of them, <samp>`$$'</samp> (see section <a href="#SEC57">How to Use Variables</a>). You may split a long line by inserting a backslash followed by a newline, but this is not required, as <span style="font-family: courier, mono;">make</span> places no limit on the length of a line in a makefile.</p>
<p>A rule tells <span style="font-family: courier, mono;">make</span> two things: when the targets are out of date, and how to update them when necessary.</p>
<p><a id="IDX129" name="IDX129"></a><a id="IDX130" name="IDX130"></a>The criterion for being out of date is specified in terms of the <var>prerequisites</var>, which consist of file names separated by spaces. (Wildcards and archive members (see section <a href="#SEC108">Using <span style="font-family: courier, mono;">make</span> to Update Archive Files</a>) are allowed here too.) A target is out of date if it does not exist or if it is older than any of the prerequisites (by comparison of last-modification times). The idea is that the contents of the target file are computed based on information in the prerequisites, so if any of the prerequisites changes, the contents of the existing target file are no longer necessarily valid.</p>
<p>How to update is specified by <var>commands</var>. These are lines to be executed by the shell (normally <samp>`sh'</samp>), but with some extra features (see section <a href="#SEC44">Writing the Commands in Rules</a>).</p>
<h2 class="subhead"><a id="SEC22" href="#TOC22" name="SEC22">Using Wildcard Characters in File Names</a></h2>
<p><a id="IDX131" name="IDX131"></a><a id="IDX132" name="IDX132"></a><a id="IDX133" name="IDX133"></a> </p>
<p><a id="IDX134" name="IDX134"></a><a id="IDX135" name="IDX135"></a><a id="IDX136" name="IDX136"></a>A single file name can specify many files using <strong>wildcard characters</strong>. The wildcard characters in <span style="font-family: courier, mono;">make</span> are <samp>`*'</samp>, <samp>`?'</samp> and <samp>`[...]'</samp>, the same as in the Bourne shell. For example, <tt>`*.c'</tt> specifies a list of all the files (in the working directory) whose names end in <samp>`.c'</samp>.</p>
<p><a id="IDX137" name="IDX137"></a><a id="IDX138" name="IDX138"></a><a id="IDX139" name="IDX139"></a>The character <samp>`~'</samp> at the beginning of a file name also has special significance. If alone, or followed by a slash, it represents your home directory. For example <tt>`~/bin'</tt> expands to <tt>`/home/you/bin'</tt>. If the <samp>`~'</samp> is followed by a word, the string represents the home directory of the user named by that word. For example <tt>`~john/bin'</tt> expands to <tt>`/home/john/bin'</tt>. On systems which don't have a home directory for each user (such as MS-DOS or MS-Windows), this functionality can be simulated by setting the environment variable <var>HOME</var>.</p>
<p>Wildcard expansion happens automatically in targets, in prerequisites, and in commands (where the shell does the expansion). In other contexts, wildcard expansion happens only if you request it explicitly with the <span style="font-family: courier, mono;">wildcard</span> function.</p>
<p>The special significance of a wildcard character can be turned off by preceding it with a backslash. Thus, <tt>`foo\*bar'</tt> would refer to a specific file whose name consists of <samp>`foo'</samp>, an asterisk, and <samp>`bar'</samp>.</p>
<h3 class="subsubhead"><a id="SEC23" href="#TOC23" name="SEC23">Wildcard Examples</a></h3>
<p>Wildcards can be used in the commands of a rule, where they are expanded by the shell. For example, here is a rule to delete all the object files:</p>
<p>clean: rm -f *.o</p>
<p><a id="IDX140" name="IDX140"></a> </p>
<p>Wildcards are also useful in the prerequisites of a rule. With the following rule in the makefile, <samp>`make print'</samp> will print all the <samp>`.c'</samp> files that have changed since the last time you printed them:</p>
<p>print: *.c lpr -p $? touch print</p>
<p><a id="IDX141" name="IDX141"></a><a id="IDX142" name="IDX142"></a><a id="IDX143" name="IDX143"></a>This rule uses <tt>`print'</tt> as an empty target file; see section <a href="#SEC35">Empty Target Files to Record Events</a>. (The automatic variable <samp>`$?'</samp> is used to print only those files that have changed; see section <a href="#SEC101">Automatic Variables</a>.)</p>
<p>Wildcard expansion does not happen when you define a variable. Thus, if you write this:</p>
<p>objects = *.o</p>
<p>then the value of the variable <span style="font-family: courier, mono;">objects</span> is the actual string <samp>`*.o'</samp>. However, if you use the value of <span style="font-family: courier, mono;">objects</span> in a target, prerequisite or command, wildcard expansion will take place at that time. To set <span style="font-family: courier, mono;">objects</span> to the expansion, instead use:</p>
<p>objects := $(wildcard *.o)</p>
<p>See section <a href="#SEC25">The Function <span style="font-family: courier, mono;">wildcard</span></a>.</p>
<h3 class="subsubhead"><a id="SEC24" href="#TOC24" name="SEC24">Pitfalls of Using Wildcards</a></h3>
<p><a id="IDX144" name="IDX144"></a><a id="IDX145" name="IDX145"></a><a id="IDX146" name="IDX146"></a><a id="IDX147" name="IDX147"></a><a id="IDX148" name="IDX148"></a> </p>
<p>Now here is an example of a naive way of using wildcard expansion, that does not do what you would intend. Suppose you would like to say that the executable file <tt>`foo'</tt> is made from all the object files in the directory, and you write this:</p>
<p>objects = *.ofoo : $(objects) cc -o foo $(CFLAGS) $(objects)</p>
<p>The value of <span style="font-family: courier, mono;">objects</span> is the actual string <samp>`*.o'</samp>. Wildcard expansion happens in the rule for <tt>`foo'</tt>, so that each <em>existing</em> <samp>`.o'</samp> file becomes a prerequisite of <tt>`foo'</tt> and will be recompiled if necessary.</p>
<p>But what if you delete all the <samp>`.o'</samp> files? When a wildcard matches no files, it is left as it is, so then <tt>`foo'</tt> will depend on the oddly-named file <tt>`*.o'</tt>. Since no such file is likely to exist, <span style="font-family: courier, mono;">make</span> will give you an error saying it cannot figure out how to make <tt>`*.o'</tt>. This is not what you want!</p>
<p>Actually it is possible to obtain the desired result with wildcard expansion, but you need more sophisticated techniques, including the <span style="font-family: courier, mono;">wildcard</span> function and string substitution. These are described in the following section.</p>
<p><a id="IDX149" name="IDX149"></a><a id="IDX150" name="IDX150"></a> </p>
<p>Microsoft operating systems (MS-DOS and MS-Windows) use backslashes to separate directories in pathnames, like so:</p>
<p>c:\foo\bar\baz.c</p>
<p>This is equivalent to the Unix-style <tt>`c:/foo/bar/baz.c'</tt> (the <tt>`c:'</tt> part is the so-called drive letter). When <span style="font-family: courier, mono;">make</span> runs on these systems, it supports backslashes as well as the Unix-style forward slashes in pathnames. However, this support does <em>not</em> include the wildcard expansion, where backslash is a quote character. Therefore, you <em>must</em> use Unix-style slashes in these cases.</p>
<h3 class="subsubhead"><a id="SEC25" href="#TOC25" name="SEC25">The Function <span style="font-family: courier, mono;">wildcard</span></a></h3>
<p><a id="IDX151" name="IDX151"></a> </p>
<p>Wildcard expansion happens automatically in rules. But wildcard expansion does not normally take place when a variable is set, or inside the arguments of a function. If you want to do wildcard expansion in such places, you need to use the <span style="font-family: courier, mono;">wildcard</span> function, like this:</p>
<p>$(wildcard <var>pattern</var>...)</p>
<p>This string, used anywhere in a makefile, is replaced by a space-separated list of names of existing files that match one of the given file name patterns. If no existing file name matches a pattern, then that pattern is omitted from the output of the <span style="font-family: courier, mono;">wildcard</span> function. Note that this is different from how unmatched wildcards behave in rules, where they are used verbatim rather than ignored (see section <a href="#SEC24">Pitfalls of Using Wildcards</a>).</p>
<p>One use of the <span style="font-family: courier, mono;">wildcard</span> function is to get a list of all the C source files in a directory, like this:</p>
<p>$(wildcard *.c)</p>
<p>We can change the list of C source files into a list of object files by replacing the <samp>`.c'</samp> suffix with <samp>`.o'</samp> in the result, like this:</p>
<p>$(patsubst %.c,%.o,$(wildcard *.c))</p>
<p>(Here we have used another function, <span style="font-family: courier, mono;">patsubst</span>. See section <a href="#SEC77">Functions for String Substitution and Analysis</a>.)</p>
<p>Thus, a makefile to compile all C source files in the directory and then link them together could be written as follows:</p>
<p>objects := $(patsubst %.c,%.o,$(wildcard *.c))foo : $(objects) cc -o foo $(objects)</p>
<p>(This takes advantage of the implicit rule for compiling C programs, so there is no need to write explicit rules for compiling the files. See section <a href="#SEC59">The Two Flavors of Variables</a>, for an explanation of <samp>`:='</samp>, which is a variant of <samp>`='</samp>.)</p>
<h2 class="subhead"><a id="SEC26" href="#TOC26" name="SEC26">Searching Directories for Prerequisites</a></h2>
<p><a id="IDX152" name="IDX152"></a><a id="IDX153" name="IDX153"></a><a id="IDX154" name="IDX154"></a><a id="IDX155" name="IDX155"></a><a id="IDX156" name="IDX156"></a> </p>
<p>For large systems, it is often desirable to put sources in a separate directory from the binaries. The <strong>directory search</strong> features of <span style="font-family: courier, mono;">make</span> facilitate this by searching several directories automatically to find a prerequisite. When you redistribute the files among directories, you do not need to change the individual rules, just the search paths.</p>
<h3 class="subsubhead"><a id="SEC27" href="#TOC27" name="SEC27"><span style="font-family: courier, mono;">VPATH</span>: Search Path for All Prerequisites</a></h3>
<p><a id="IDX157" name="IDX157"></a> </p>
<p>The value of the <span style="font-family: courier, mono;">make</span> variable <span style="font-family: courier, mono;">VPATH</span> specifies a list of directories that <span style="font-family: courier, mono;">make</span> should search. Most often, the directories are expected to contain prerequisite files that are not in the current directory; however, <span style="font-family: courier, mono;">VPATH</span> specifies a search list that <span style="font-family: courier, mono;">make</span> applies for all files, including files which are targets of rules.</p>
<p>Thus, if a file that is listed as a target or prerequisite does not exist in the current directory, <span style="font-family: courier, mono;">make</span> searches the directories listed in <span style="font-family: courier, mono;">VPATH</span> for a file with that name. If a file is found in one of them, that file may become the prerequisite (see below). Rules may then specify the names of files in the prerequisite list as if they all existed in the current directory. See section <a href="#SEC30">Writing Shell Commands with Directory Search</a>.</p>
<p>In the <span style="font-family: courier, mono;">VPATH</span> variable, directory names are separated by colons or blanks. The order in which directories are listed is the order followed by <span style="font-family: courier, mono;">make</span> in its search. (On MS-DOS and MS-Windows, semi-colons are used as separators of directory names in <span style="font-family: courier, mono;">VPATH</span>, since the colon can be used in the pathname itself, after the drive letter.)</p>
<p>For example,</p>
<p>VPATH = src:../headers</p>
<p>specifies a path containing two directories, <tt>`src'</tt> and <tt>`../headers'</tt>, which <span style="font-family: courier, mono;">make</span> searches in that order.</p>
<p>With this value of <span style="font-family: courier, mono;">VPATH</span>, the following rule,</p>
<p>foo.o : foo.c</p>
<p>is interpreted as if it were written like this:</p>
<p>foo.o : src/foo.c</p>
<p>assuming the file <tt>`foo.c'</tt> does not exist in the current directory but is found in the directory <tt>`src'</tt>.</p>
<h3 class="subsubhead"><a id="SEC28" href="#TOC28" name="SEC28">The <span style="font-family: courier, mono;">vpath</span> Directive</a></h3>
<p><a id="IDX158" name="IDX158"></a> </p>
<p>Similar to the <span style="font-family: courier, mono;">VPATH</span> variable, but more selective, is the <span style="font-family: courier, mono;">vpath</span> directive (note lower case), which allows you to specify a search path for a particular class of file names: those that match a particular pattern. Thus you can supply certain search directories for one class of file names and other directories (or none) for other file names.</p>
<p>There are three forms of the <span style="font-family: courier, mono;">vpath</span> directive:</p>
<dl compact>
<dt><span style="font-family: courier, mono;">vpath <var>pattern</var> <var>directories</var></span></dt>
<dd>Specify the search path <var>directories</var> for file names that match <var>pattern</var>. The search path, <var>directories</var>, is a list of directories to be searched, separated by colons (semi-colons on MS-DOS and MS-Windows) or blanks, just like the search path used in the <span style="font-family: courier, mono;">VPATH</span> variable.</dd>
<dt><span style="font-family: courier, mono;">vpath <var>pattern</var></span></dt>
<dd>Clear out the search path associated with <var>pattern</var>.</dd>
<dt><span style="font-family: courier, mono;">vpath</span></dt>
<dd>Clear all search paths previously specified with <span style="font-family: courier, mono;">vpath</span> directives.</dd>
</dl>
<p>A <span style="font-family: courier, mono;">vpath</span> pattern is a string containing a <samp>`%'</samp> character. The string must match the file name of a prerequisite that is being searched for, the <samp>`%'</samp> character matching any sequence of zero or more characters (as in pattern rules; see section <a href="#SEC98">Defining and Redefining Pattern Rules</a>). For example, <span style="font-family: courier, mono;">%.h</span> matches files that end in <span style="font-family: courier, mono;">.h</span>. (If there is no <samp>`%'</samp>, the pattern must match the prerequisite exactly, which is not useful very often.)</p>
<p><a id="IDX159" name="IDX159"></a><a id="IDX160" name="IDX160"></a><a id="IDX161" name="IDX161"></a><a id="IDX162" name="IDX162"></a><a id="IDX163" name="IDX163"></a><samp>`%'</samp> characters in a <span style="font-family: courier, mono;">vpath</span> directive's pattern can be quoted with preceding backslashes (<samp>`\'</samp>). Backslashes that would otherwise quote <samp>`%'</samp> characters can be quoted with more backslashes. Backslashes that quote <samp>`%'</samp> characters or other backslashes are removed from the pattern before it is compared to file names. Backslashes that are not in danger of quoting <samp>`%'</samp> characters go unmolested.</p>
<p>When a prerequisite fails to exist in the current directory, if the <var>pattern</var> in a <span style="font-family: courier, mono;">vpath</span> directive matches the name of the prerequisite file, then the <var>directories</var> in that directive are searched just like (and before) the directories in the <span style="font-family: courier, mono;">VPATH</span> variable.</p>
<p>For example,</p>
<p>vpath %.h ../headers</p>
<p>tells <span style="font-family: courier, mono;">make</span> to look for any prerequisite whose name ends in <tt>`.h'</tt> in the directory <tt>`../headers'</tt> if the file is not found in the current directory.</p>
<p>If several <span style="font-family: courier, mono;">vpath</span> patterns match the prerequisite file's name, then <span style="font-family: courier, mono;">make</span> processes each matching <span style="font-family: courier, mono;">vpath</span> directive one by one, searching all the directories mentioned in each directive. <span style="font-family: courier, mono;">make</span> handles multiple <span style="font-family: courier, mono;">vpath</span> directives in the order in which they appear in the makefile; multiple directives with the same pattern are independent of each other.</p>
<p>Thus,</p>
<p>vpath %.c foovpath % blishvpath %.c bar</p>
<p>will look for a file ending in <samp>`.c'</samp> in <tt>`foo'</tt>, then <tt>`blish'</tt>, then <tt>`bar'</tt>, while</p>
<p>vpath %.c foo:barvpath % blish</p>
<p>will look for a file ending in <samp>`.c'</samp> in <tt>`foo'</tt>, then <tt>`bar'</tt>, then <tt>`blish'</tt>.</p>
<h3 class="subsubhead"><a id="SEC29" href="#TOC29" name="SEC29">How Directory Searches are Performed</a></h3>
<p><a id="IDX164" name="IDX164"></a><a id="IDX165" name="IDX165"></a> </p>
<p>When a prerequisite is found through directory search, regardless of type (general or selective), the pathname located may not be the one that <span style="font-family: courier, mono;">make</span> actually provides you in the prerequisite list. Sometimes the path discovered through directory search is thrown away.</p>
<p>The algorithm <span style="font-family: courier, mono;">make</span> uses to decide whether to keep or abandon a path found via directory search is as follows:</p>
<ol>
<li>If a target file does not exist at the path specified in the makefile, directory search is performed.</li>
<li>If the directory search is successful, that path is kept and this file is tentatively stored as the target.</li>
<li>All prerequisites of this target are examined using this same method.</li>
<li>After processing the prerequisites, the target may or may not need to be rebuilt:
<ol>
<li>If the target does <em>not</em> need to be rebuilt, the path to the file found during directory search is used for any prerequisite lists which contain this target. In short, if <span style="font-family: courier, mono;">make</span> doesn't need to rebuild the target then you use the path found via directory search.</li>
<li>If the target <em>does</em> need to be rebuilt (is out-of-date), the pathname found during directory search is <em>thrown away</em>, and the target is rebuilt using the file name specified in the makefile. In short, if <span style="font-family: courier, mono;">make</span> must rebuild, then the target is rebuilt locally, not in the directory found via directory search.</li>
</ol>
</li>
</ol>
<p>This algorithm may seem complex, but in practice it is quite often exactly what you want.</p>
<p><a id="IDX166" name="IDX166"></a><a id="IDX167" name="IDX167"></a>Other versions of <span style="font-family: courier, mono;">make</span> use a simpler algorithm: if the file does not exist, and it is found via directory search, then that pathname is always used whether or not the target needs to be built. Thus, if the target is rebuilt it is created at the pathname discovered during directory search.</p>
<p><a id="IDX168" name="IDX168"></a>If, in fact, this is the behavior you want for some or all of your directories, you can use the <span style="font-family: courier, mono;">GPATH</span> variable to indicate this to <span style="font-family: courier, mono;">make</span>.</p>
<p><span style="font-family: courier, mono;">GPATH</span> has the same syntax and format as <span style="font-family: courier, mono;">VPATH</span> (that is, a space- or colon-delimited list of pathnames). If an out-of-date target is found by directory search in a directory that also appears in <span style="font-family: courier, mono;">GPATH</span>, then that pathname is not thrown away. The target is rebuilt using the expanded path.</p>
<h3 class="subsubhead"><a id="SEC30" href="#TOC30" name="SEC30">Writing Shell Commands with Directory Search</a></h3>
<p><a id="IDX169" name="IDX169"></a><a id="IDX170" name="IDX170"></a> </p>
<p>When a prerequisite is found in another directory through directory search, this cannot change the commands of the rule; they will execute as written. Therefore, you must write the commands with care so that they will look for the prerequisite in the directory where <span style="font-family: courier, mono;">make</span> finds it.</p>
<p>This is done with the <strong>automatic variables</strong> such as <samp>`$^'</samp> (see section <a href="#SEC101">Automatic Variables</a>). For instance, the value of <samp>`$^'</samp> is a list of all the prerequisites of the rule, including the names of the directories in which they were found, and the value of <samp>`$@'</samp> is the target. Thus:</p>
<p>foo.o : foo.c cc -c $(CFLAGS) $^ -o $@</p>
<p>(The variable <span style="font-family: courier, mono;">CFLAGS</span> exists so you can specify flags for C compilation by implicit rules; we use it here for consistency so it will affect all C compilations uniformly; see section <a href="#SEC96">Variables Used by Implicit Rules</a>.)</p>
<p>Often the prerequisites include header files as well, which you do not want to mention in the commands. The automatic variable <samp>`$&lt;'</samp> is just the first prerequisite:</p>
<p>VPATH = src:../headersfoo.o : foo.c defs.h hack.h cc -c $(CFLAGS) $&lt; -o $@</p>
<h3 class="subsubhead"><a id="SEC31" href="#TOC31" name="SEC31">Directory Search and Implicit Rules</a></h3>
<p><a id="IDX171" name="IDX171"></a><a id="IDX172" name="IDX172"></a><a id="IDX173" name="IDX173"></a><a id="IDX174" name="IDX174"></a><a id="IDX175" name="IDX175"></a><a id="IDX176" name="IDX176"></a><a id="IDX177" name="IDX177"></a> </p>
<p>The search through the directories specified in <span style="font-family: courier, mono;">VPATH</span> or with <span style="font-family: courier, mono;">vpath</span> also happens during consideration of implicit rules (see section <a href="#SEC93">Using Implicit Rules</a>).</p>
<p>For example, when a file <tt>`foo.o'</tt> has no explicit rule, <span style="font-family: courier, mono;">make</span> considers implicit rules, such as the built-in rule to compile <tt>`foo.c'</tt> if that file exists. If such a file is lacking in the current directory, the appropriate directories are searched for it. If <tt>`foo.c'</tt> exists (or is mentioned in the makefile) in any of the directories, the implicit rule for C compilation is applied.</p>
<p>The commands of implicit rules normally use automatic variables as a matter of necessity; consequently they will use the file names found by directory search with no extra effort.</p>
<h3 class="subsubhead"><a id="SEC32" href="#TOC32" name="SEC32">Directory Search for Link Libraries</a></h3>
<p><a id="IDX178" name="IDX178"></a><a id="IDX179" name="IDX179"></a><a id="IDX180" name="IDX180"></a><a id="IDX181" name="IDX181"></a><a id="IDX182" name="IDX182"></a><a id="IDX183" name="IDX183"></a><a id="IDX184" name="IDX184"></a><a id="IDX185" name="IDX185"></a><a id="IDX186" name="IDX186"></a> </p>
<p>Directory search applies in a special way to libraries used with the linker. This special feature comes into play when you write a prerequisite whose name is of the form <samp>`-l<var>name</var>'</samp>. (You can tell something strange is going on here because the prerequisite is normally the name of a file, and the <em>file name</em> of a library generally looks like <tt>`lib<var>name</var>.a'</tt>, not like <samp>`-l<var>name</var>'</samp>.)</p>
<p>When a prerequisite's name has the form <samp>`-l<var>name</var>'</samp>, <span style="font-family: courier, mono;">make</span> handles it specially by searching for the file <tt>`lib<var>name</var>.so'</tt> in the current directory, in directories specified by matching <span style="font-family: courier, mono;">vpath</span> search paths and the <span style="font-family: courier, mono;">VPATH</span> search path, and then in the directories <tt>`/lib'</tt>, <tt>`/usr/lib'</tt>, and <tt>`<var>prefix</var>/lib'</tt> (normally <tt>`/usr/local/lib'</tt>, but MS-DOS/MS-Windows versions of <span style="font-family: courier, mono;">make</span> behave as if <var>prefix</var> is defined to be the root of the DJGPP installation tree).</p>
<p>If that file is not found, then the file <tt>`lib<var>name</var>.a'</tt> is searched for, in the same directories as above.</p>
<p>For example, if there is a <tt>`/usr/lib/libcurses.a'</tt> library on your system (and no <tt>`/usr/lib/libcurses.so'</tt> file), then</p>
<p>foo : foo.c -lcurses cc $^ -o $@</p>
<p>would cause the command <samp>`cc foo.c /usr/lib/libcurses.a -o foo'</samp> to be executed when <tt>`foo'</tt> is older than <tt>`foo.c'</tt> or than <tt>`/usr/lib/libcurses.a'</tt>.</p>
<p>Although the default set of files to be searched for is <tt>`lib<var>name</var>.so'</tt> and <tt>`lib<var>name</var>.a'</tt>, this is customizable via the <span style="font-family: courier, mono;">.LIBPATTERNS</span> variable. Each word in the value of this variable is a pattern string. When a prerequisite like <samp>`-l<var>name</var>'</samp> is seen, <span style="font-family: courier, mono;">make</span> will replace the percent in each pattern in the list with <var>name</var> and perform the above directory searches using that library filename. If no library is found, the next word in the list will be used.</p>
<p>The default value for <span style="font-family: courier, mono;">.LIBPATTERNS</span> is "<samp>`lib%.so lib%.a'</samp>", which provides the default behavior described above.</p>
<p>You can turn off link library expansion completely by setting this variable to an empty value.</p>
<h2 class="subhead"><a id="SEC33" href="#TOC33" name="SEC33">Phony Targets</a></h2>
<p><a id="IDX187" name="IDX187"></a><a id="IDX188" name="IDX188"></a><a id="IDX189" name="IDX189"></a> </p>
<p>A phony target is one that is not really the name of a file. It is just a name for some commands to be executed when you make an explicit request. There are two reasons to use a phony target: to avoid a conflict with a file of the same name, and to improve performance.</p>
<p>If you write a rule whose commands will not create the target file, the commands will be executed every time the target comes up for remaking. Here is an example:</p>
<p>clean: rm *.o temp</p>
<p>Because the <span style="font-family: courier, mono;">rm</span> command does not create a file named <tt>`clean'</tt>, probably no such file will ever exist. Therefore, the <span style="font-family: courier, mono;">rm</span> command will be executed every time you say <samp>`make clean'</samp>. <a id="IDX190" name="IDX190"></a></p>
<p><a id="IDX191" name="IDX191"></a>The phony target will cease to work if anything ever does create a file named <tt>`clean'</tt> in this directory. Since it has no prerequisites, the file <tt>`clean'</tt> would inevitably be considered up to date, and its commands would not be executed. To avoid this problem, you can explicitly declare the target to be phony, using the special target <span style="font-family: courier, mono;">.PHONY</span> (see section <a href="#SEC36">Special Built-in Target Names</a>) as follows:</p>
<p>.PHONY : clean</p>
<p>Once this is done, <samp>`make clean'</samp> will run the commands regardless of whether there is a file named <tt>`clean'</tt>.</p>
<p>Since it knows that phony targets do not name actual files that could be remade from other files, <span style="font-family: courier, mono;">make</span> skips the implicit rule search for phony targets (see section <a href="#SEC93">Using Implicit Rules</a>). This is why declaring a target phony is good for performance, even if you are not worried about the actual file existing.</p>
<p>Thus, you first write the line that states that <span style="font-family: courier, mono;">clean</span> is a phony target, then you write the rule, like this:</p>
<p>.PHONY: clean clean: rm *.o temp</p>
<p>Another example of the usefulness of phony targets is in conjunction with recursive invocations of <span style="font-family: courier, mono;">make</span>. In this case the makefile will often contain a variable which lists a number of subdirectories to be built. One way to handle this is with one rule whose command is a shell loop over the subdirectories, like this:</p>
<p>SUBDIRS = foo bar baz subdirs: for dir in $(SUBDIRS); do \ $(MAKE) -C $$dir; \ done</p>
<p>There are a few of problems with this method, however. First, any error detected in a submake is not noted by this rule, so it will continue to build the rest of the directories even when one fails. This can be overcome by adding shell commands to note the error and exit, but then it will do so even if <span style="font-family: courier, mono;">make</span> is invoked with the <span style="font-family: courier, mono;">-k</span> option, which is unfortunate. Second, and perhaps more importantly, you cannot take advantage of the parallel build capabilities of make using this method, since there is only one rule.</p>
<p>By declaring the subdirectories as phony targets (you must do this as the subdirectory obviously always exists; otherwise it won't be built) you can remove these problems:</p>
<p>SUBDIRS = foo bar baz .PHONY: subdirs $(SUBDIRS) subdirs: $(SUBDIRS) $(SUBDIRS): $(MAKE) -C $ foo: baz</p>
<p>Here we've also declared that the <tt>`foo'</tt> subdirectory cannot be built until after the <tt>`baz'</tt> subdirectory is complete; this kind of relationship declaration is particularly important when attempting parallel builds.</p>
<p>A phony target should not be a prerequisite of a real target file; if it is, its commands are run every time <span style="font-family: courier, mono;">make</span> goes to update that file. As long as a phony target is never a prerequisite of a real target, the phony target commands will be executed only when the phony target is a specified goal (see section <a href="#SEC87">Arguments to Specify the Goals</a>).</p>
<p>Phony targets can have prerequisites. When one directory contains multiple programs, it is most convenient to describe all of the programs in one makefile <tt>`./Makefile'</tt>. Since the target remade by default will be the first one in the makefile, it is common to make this a phony target named <samp>`all'</samp> and give it, as prerequisites, all the individual programs. For example:</p>
<p>all : prog1 prog2 prog3 .PHONY : all prog1 : prog1.o utils.o cc -o prog1 prog1.o utils.o prog2 : prog2.o cc -o prog2 prog2.o prog3 : prog3.o sort.o utils.o cc -o prog3 prog3.o sort.o utils.o</p>
<p>Now you can say just <samp>`make'</samp> to remake all three programs, or specify as arguments the ones to remake (as in <samp>`make prog1 prog3'</samp>).</p>
<p>When one phony target is a prerequisite of another, it serves as a subroutine of the other. For example, here <samp>`make cleanall'</samp> will delete the object files, the difference files, and the file <tt>`program'</tt>:</p>
<p>.PHONY: cleanall cleanobj cleandiff cleanall : cleanobj cleandiff rm program cleanobj : rm *.o cleandiff : rm *.diff</p>
<h2 class="subhead"><a id="SEC34" href="#TOC34" name="SEC34">Rules without Commands or Prerequisites</a></h2>
<p><br><a id="IDX192" name="IDX192"></a><a id="IDX193" name="IDX193"></a><a id="IDX194" name="IDX194"></a><a id="IDX195" name="IDX195"></a><br>
If a rule has no prerequisites or commands, and the target of the rule is a nonexistent file, then <span style="font-family: courier, mono;">make</span> imagines this target to have been updated whenever its rule is run. This implies that all targets depending on this one will always have their commands run.<br>
An example will illustrate this:</p>
<p>clean: FORCE rm $(objects) FORCE:</p>
<p><br>
Here the target <samp>`FORCE'</samp> satisfies the special conditions, so the target <tt>`clean'</tt> that depends on it is forced to run its commands. There is nothing special about the name <samp>`FORCE'</samp>, but that is one name commonly used this way.<br>
As you can see, using <samp>`FORCE'</samp> this way has the same results as using <samp>`.PHONY: clean'</samp>.<br>
Using <samp>`.PHONY'</samp> is more explicit and more efficient. However, other versions of <span style="font-family: courier, mono;">make</span> do not support <samp>`.PHONY'</samp>; thus <samp>`FORCE'</samp> appears in many makefiles. See section <a href="#SEC33">Phony Targets</a>.</p>
<h2 class="subhead"><a id="SEC35" href="#TOC35" name="SEC35">Empty Target Files to Record Events</a></h2>
<p><br><a id="IDX196" name="IDX196"></a><a id="IDX197" name="IDX197"></a><a id="IDX198" name="IDX198"></a><br>
The <strong>empty target</strong> is a variant of the phony target; it is used to hold commands for an action that you request explicitly from time to time. Unlike a phony target, this target file can really exist; but the file's contents do not matter, and usually are empty.<br>
The purpose of the empty target file is to record, with its last-modification time, when the rule's commands were last executed. It does so because one of the commands is a <span style="font-family: courier, mono;">touch</span> command to update the target file.<br>
The empty target file should have some prerequisites (otherwise it doesn't make sense). When you ask to remake the empty target, the commands are executed if any prerequisite is more recent than the target; in other words, if a prerequisite has changed since the last time you remade the target. Here is an example:</p>
<p>print: foo.c bar.c lpr -p $? touch print</p>
<p><br><a id="IDX199" name="IDX199"></a><a id="IDX200" name="IDX200"></a><a id="IDX201" name="IDX201"></a><br>
With this rule, <samp>`make print'</samp> will execute the <span style="font-family: courier, mono;">lpr</span> command if either source file has changed since the last <samp>`make print'</samp>. The automatic variable <samp>`$?'</samp> is used to print only those files that have changed (see section <a href="#SEC101">Automatic Variables</a>).</p>
<h2 class="subhead"><a id="SEC36" href="#TOC36" name="SEC36">Special Built-in Target Names</a></h2>
<p><br><a id="IDX202" name="IDX202"></a><a id="IDX203" name="IDX203"></a><a id="IDX204" name="IDX204"></a><br>
Certain names have special meanings if they appear as targets.</p>
<dl compact>
<dt><span style="font-family: courier, mono;">.PHONY</span></dt>
<dd>
<a id="IDX205" name="IDX205"></a>The prerequisites of the special target <span style="font-family: courier, mono;">.PHONY</span> are considered to be phony targets. When it is time to consider such a target, <span style="font-family: courier, mono;">make</span> will run its commands unconditionally, regardless of whether a file with that name exists or what its last-modification time is. See section <a href="#SEC33">Phony Targets</a>. <a id="IDX206" name="IDX206"></a>
</dd>
<dt><span style="font-family: courier, mono;">.SUFFIXES</span></dt>
<dd>The prerequisites of the special target <span style="font-family: courier, mono;">.SUFFIXES</span> are the list of suffixes to be used in checking for suffix rules. See section <a href="#SEC106">Old-Fashioned Suffix Rules</a>. <a id="IDX207" name="IDX207"></a>
</dd>
<dt><span style="font-family: courier, mono;">.DEFAULT</span></dt>
<dd>The commands specified for <span style="font-family: courier, mono;">.DEFAULT</span> are used for any target for which no rules are found (either explicit rules or implicit rules). See section <a href="#SEC105">Defining Last-Resort Default Rules</a>. If <span style="font-family: courier, mono;">.DEFAULT</span> commands are specified, every file mentioned as a prerequisite, but not as a target in a rule, will have these commands executed on its behalf. See section <a href="#SEC107">Implicit Rule Search Algorithm</a>. <a id="IDX208" name="IDX208"></a>
</dd>
<dt><span style="font-family: courier, mono;">.PRECIOUS</span></dt>
<dd>
<a id="IDX209" name="IDX209"></a><a id="IDX210" name="IDX210"></a>The targets which <span style="font-family: courier, mono;">.PRECIOUS</span> depends on are given the following special treatment: if <span style="font-family: courier, mono;">make</span> is killed or interrupted during the execution of their commands, the target is not deleted. See section <a href="#SEC49">Interrupting or Killing <span style="font-family: courier, mono;">make</span></a>. Also, if the target is an intermediate file, it will not be deleted after it is no longer needed, as is normally done. See section <a href="#SEC97">Chains of Implicit Rules</a>. In this latter respect it overlaps with the <span style="font-family: courier, mono;">.SECONDARY</span> special target. You can also list the target pattern of an implicit rule (such as <samp>`%.o'</samp>) as a prerequisite file of the special target <span style="font-family: courier, mono;">.PRECIOUS</span> to preserve intermediate files created by rules whose target patterns match that file's name. <a id="IDX211" name="IDX211"></a>
</dd>
<dt><span style="font-family: courier, mono;">.INTERMEDIATE</span></dt>
<dd>
<a id="IDX212" name="IDX212"></a>The targets which <span style="font-family: courier, mono;">.INTERMEDIATE</span> depends on are treated as intermediate files. See section <a href="#SEC97">Chains of Implicit Rules</a>. <span style="font-family: courier, mono;">.INTERMEDIATE</span> with no prerequisites has no effect. <a id="IDX213" name="IDX213"></a>
</dd>
<dt><span style="font-family: courier, mono;">.SECONDARY</span></dt>
<dd>
<a id="IDX214" name="IDX214"></a><a id="IDX215" name="IDX215"></a>The targets which <span style="font-family: courier, mono;">.SECONDARY</span> depends on are treated as intermediate files, except that they are never automatically deleted. See section <a href="#SEC97">Chains of Implicit Rules</a>. <span style="font-family: courier, mono;">.SECONDARY</span> with no prerequisites causes all targets to be treated as secondary (i.e., no target is removed because it is considered intermediate). <a id="IDX216" name="IDX216"></a>
</dd>
<dt><span style="font-family: courier, mono;">.DELETE_ON_ERROR</span></dt>
<dd>
<a id="IDX217" name="IDX217"></a>If <span style="font-family: courier, mono;">.DELETE_ON_ERROR</span> is mentioned as a target anywhere in the makefile, then <span style="font-family: courier, mono;">make</span> will delete the target of a rule if it has changed and its commands exit with a nonzero exit status, just as it does when it receives a signal. See section <a href="#SEC48">Errors in Commands</a>. <a id="IDX218" name="IDX218"></a>
</dd>
<dt><span style="font-family: courier, mono;">.IGNORE</span></dt>
<dd>If you specify prerequisites for <span style="font-family: courier, mono;">.IGNORE</span>, then <span style="font-family: courier, mono;">make</span> will ignore errors in execution of the commands run for those particular files. The commands for <span style="font-family: courier, mono;">.IGNORE</span> are not meaningful. If mentioned as a target with no prerequisites, <span style="font-family: courier, mono;">.IGNORE</span> says to ignore errors in execution of commands for all files. This usage of <samp>`.IGNORE'</samp> is supported only for historical compatibility. Since this affects every command in the makefile, it is not very useful; we recommend you use the more selective ways to ignore errors in specific commands. See section <a href="#SEC48">Errors in Commands</a>. <a id="IDX219" name="IDX219"></a>
</dd>
<dt><span style="font-family: courier, mono;">.SILENT</span></dt>
<dd>If you specify prerequisites for <span style="font-family: courier, mono;">.SILENT</span>, then <span style="font-family: courier, mono;">make</span> will not print the commands to remake those particular files before executing them. The commands for <span style="font-family: courier, mono;">.SILENT</span> are not meaningful. If mentioned as a target with no prerequisites, <span style="font-family: courier, mono;">.SILENT</span> says not to print any commands before executing them. This usage of <samp>`.SILENT'</samp> is supported only for historical compatibility. We recommend you use the more selective ways to silence specific commands. See section <a href="#SEC45">Command Echoing</a>. If you want to silence all commands for a particular run of <span style="font-family: courier, mono;">make</span>, use the <samp>`-s'</samp> or <samp>`--silent'</samp> option (see section <a href="#SEC92">Summary of Options</a>). <a id="IDX220" name="IDX220"></a>
</dd>
<dt><span style="font-family: courier, mono;">.EXPORT_ALL_VARIABLES</span></dt>
<dd>Simply by being mentioned as a target, this tells <span style="font-family: courier, mono;">make</span> to export all variables to child processes by default. See section <a href="#SEC52">Communicating Variables to a Sub-<span style="font-family: courier, mono;">make</span></a>. <a id="IDX221" name="IDX221"></a>
</dd>
<dt><span style="font-family: courier, mono;">.NOTPARALLEL</span></dt>
<dd>
<a id="IDX222" name="IDX222"></a>If <span style="font-family: courier, mono;">.NOTPARALLEL</span> is mentioned as a target, then this invocation of <span style="font-family: courier, mono;">make</span> will be run serially, even if the <samp>`-j'</samp> option is given. Any recursively invoked <span style="font-family: courier, mono;">make</span> command will still be run in parallel (unless its makefile contains this target). Any prerequisites on this target are ignored.</dd>
</dl>
<p><br>
Any defined implicit rule suffix also counts as a special target if it appears as a target, and so does the concatenation of two suffixes, such as <samp>`.c.o'</samp>. These targets are suffix rules, an obsolete way of defining implicit rules (but a way still widely used). In principle, any target name could be special in this way if you break it in two and add both pieces to the suffix list. In practice, suffixes normally begin with <samp>`.'</samp>, so these special target names also begin with <samp>`.'</samp>. See section <a href="#SEC106">Old-Fashioned Suffix Rules</a>.</p>
<h2 class="subhead"><a id="SEC37" href="#TOC37" name="SEC37">Multiple Targets in a Rule</a></h2>
<p><br><a id="IDX223" name="IDX223"></a><a id="IDX224" name="IDX224"></a><a id="IDX225" name="IDX225"></a><a id="IDX226" name="IDX226"></a><br>
A rule with multiple targets is equivalent to writing many rules, each with one target, and all identical aside from that. The same commands apply to all the targets, but their effects may vary because you can substitute the actual target name into the command using <samp>`$@'</samp>. The rule contributes the same prerequisites to all the targets also.<br>
This is useful in two cases.</p>
<ul>
<li>You want just prerequisites, no commands. For example:</li>
</ul>
<p>kbd.o command.o files.o: command.h</p>
<p>gives an additional prerequisite to each of the three object files mentioned.</p>
<ul class="noindent">
<li>Similar commands work for all the targets. The commands do not need to be absolutely identical, since the automatic variable <samp>`$@'</samp> can be used to substitute the particular target to be remade into the commands (see section <a href="#SEC101">Automatic Variables</a>). For example:</li>
</ul>
<p>bigoutput littleoutput : text.g generate text.g -$(subst output,,$@) &gt; $@</p>
<p><a id="IDX227" name="IDX227"></a>is equivalent to</p>
<p>bigoutput : text.g generate text.g -big &gt; bigoutput littleoutput : text.g generate text.g -little &gt; littleoutput</p>
<p>Here we assume the hypothetical program <span style="font-family: courier, mono;">generate</span> makes two types of output, one if given <samp>`-big'</samp> and one if given <samp>`-little'</samp>. See section <a href="#SEC77">Functions for String Substitution and Analysis</a>, for an explanation of the <span style="font-family: courier, mono;">subst</span> function.<br>
Suppose you would like to vary the prerequisites according to the target, much as the variable <samp>`$@'</samp> allows you to vary the commands. You cannot do this with multiple targets in an ordinary rule, but you can do it with a <strong>static pattern rule</strong>. See section <a href="#SEC39">Static Pattern Rules</a>.</p>
<h2 class="subhead"><a id="SEC38" href="#TOC38" name="SEC38">Multiple Rules for One Target</a></h2>
<p><br>
One file can be the target of several rules. All the prerequisites mentioned in all the rules are merged into one list of prerequisites for the target. If the target is older than any prerequisite from any rule, the commands are executed.<br>
There can only be one set of commands to be executed for a file. If more than one rule gives commands for the same file, <span style="font-family: courier, mono;">make</span> uses the last set given and prints an error message. (As a special case, if the file's name begins with a dot, no error message is printed. This odd behavior is only for compatibility with other implementations of <span style="font-family: courier, mono;">make</span>.) There is no reason to write your makefiles this way; that is why <span style="font-family: courier, mono;">make</span> gives you an error message.<br>
An extra rule with just prerequisites can be used to give a few extra prerequisites to many files at once. For example, one usually has a variable named <span style="font-family: courier, mono;">objects</span> containing a list of all the compiler output files in the system being made. An easy way to say that all of them must be recompiled if <tt>`config.h'</tt> changes is to write the following:</p>
<p>objects = foo.o bar.o foo.o : defs.h bar.o : defs.h test.h $(objects) : config.h</p>
<p><br>
This could be inserted or taken out without changing the rules that really specify how to make the object files, making it a convenient form to use if you wish to add the additional prerequisite intermittently.<br>
Another wrinkle is that the additional prerequisites could be specified with a variable that you set with a command argument to <span style="font-family: courier, mono;">make</span> (see section <a href="#SEC90">Overriding Variables</a>). For example,</p>
<p>extradeps= $(objects) : $(extradeps)</p>
<p><br>
means that the command <samp>`make extradeps=foo.h'</samp> will consider <tt>`foo.h'</tt> as a prerequisite of each object file, but plain <samp>`make'</samp> will not.<br>
If none of the explicit rules for a target has commands, then <span style="font-family: courier, mono;">make</span> searches for an applicable implicit rule to find some commands see section <a href="#SEC93">Using Implicit Rules</a>).</p>
<h2 class="subhead"><a id="SEC39" href="#TOC39" name="SEC39">Static Pattern Rules</a></h2>
<p><br><a id="IDX232" name="IDX232"></a><a id="IDX233" name="IDX233"></a><a id="IDX234" name="IDX234"></a><a id="IDX235" name="IDX235"></a><a id="IDX236" name="IDX236"></a><br><strong>Static pattern rules</strong> are rules which specify multiple targets and construct the prerequisite names for each target based on the target name. They are more general than ordinary rules with multiple targets because the targets do not have to have identical prerequisites. Their prerequisites must be <em>analogous</em>, but not necessarily <em>identical</em>.</p>
<h3 class="subsubhead"><a id="SEC40" href="#TOC40" name="SEC40">Syntax of Static Pattern Rules</a></h3>
<p><br><a id="IDX237" name="IDX237"></a><a id="IDX238" name="IDX238"></a><br>
Here is the syntax of a static pattern rule:</p>
<p><var>targets</var> ...: <var>target-pattern</var>: <var>dep-patterns</var> ... <var>commands</var> ...</p>
<p><br>
The <var>targets</var> list specifies the targets that the rule applies to. The targets can contain wildcard characters, just like the targets of ordinary rules (see section <a href="#SEC22">Using Wildcard Characters in File Names</a>).<br><a id="IDX239" name="IDX239"></a><a id="IDX240" name="IDX240"></a>The <var>target-pattern</var> and <var>dep-patterns</var> say how to compute the prerequisites of each target. Each target is matched against the <var>target-pattern</var> to extract a part of the target name, called the <strong>stem</strong>. This stem is substituted into each of the <var>dep-patterns</var> to make the prerequisite names (one from each <var>dep-pattern</var>).<br>
Each pattern normally contains the character <samp>`%'</samp> just once. When the <var>target-pattern</var> matches a target, the <samp>`%'</samp> can match any part of the target name; this part is called the <strong>stem</strong>. The rest of the pattern must match exactly. For example, the target <tt>`foo.o'</tt> matches the pattern <samp>`%.o'</samp>, with <samp>`foo'</samp> as the stem. The targets <tt>`foo.c'</tt> and <tt>`foo.out'</tt> do not match that pattern.<br><a id="IDX241" name="IDX241"></a>The prerequisite names for each target are made by substituting the stem for the <samp>`%'</samp> in each prerequisite pattern. For example, if one prerequisite pattern is <tt>`%.c'</tt>, then substitution of the stem <samp>`foo'</samp> gives the prerequisite name <tt>`foo.c'</tt>. It is legitimate to write a prerequisite pattern that does not contain <samp>`%'</samp>; then this prerequisite is the same for all targets.<br><a id="IDX242" name="IDX242"></a><a id="IDX243" name="IDX243"></a><a id="IDX244" name="IDX244"></a><a id="IDX245" name="IDX245"></a><a id="IDX246" name="IDX246"></a><samp>`%'</samp> characters in pattern rules can be quoted with preceding backslashes (<samp>`\'</samp>). Backslashes that would otherwise quote <samp>`%'</samp> characters can be quoted with more backslashes. Backslashes that quote <samp>`%'</samp> characters or other backslashes are removed from the pattern before it is compared to file names or has a stem substituted into it. Backslashes that are not in danger of quoting <samp>`%'</samp> characters go unmolested. For example, the pattern <tt>`the\%weird\\%pattern\\'</tt> has <samp>`the%weird\'</samp> preceding the operative <samp>`%'</samp> character, and <samp>`pattern\\'</samp> following it. The final two backslashes are left alone because they cannot affect any <samp>`%'</samp> character.<br>
Here is an example, which compiles each of <tt>`foo.o'</tt> and <tt>`bar.o'</tt> from the corresponding <tt>`.c'</tt> file:</p>
<p>objects = foo.o bar.o all: $(objects) $(objects): %.o: %.c $(CC) -c $(CFLAGS) $&lt; -o $@</p>
<p><br>
Here <samp>`$&lt;'</samp> is the automatic variable that holds the name of the prerequisite and <samp>`$@'</samp> is the automatic variable that holds the name of the target; see section <a href="#SEC101">Automatic Variables</a>.<br>
Each target specified must match the target pattern; a warning is issued for each target that does not. If you have a list of files, only some of which will match the pattern, you can use the <span style="font-family: courier, mono;">filter</span> function to remove nonmatching file names (see section <a href="#SEC77">Functions for String Substitution and Analysis</a>):</p>
<p>files = foo.elc bar.o lose.o $(filter %.o,$(files)): %.o: %.c $(CC) -c $(CFLAGS) $&lt; -o $@ $(filter %.elc,$(files)): %.elc: %.el emacs -f batch-byte-compile $&lt;</p>
<p><br>
In this example the result of <samp>`$(filter %.o,$(files))'</samp> is <tt>`bar.o lose.o'</tt>, and the first static pattern rule causes each of these object files to be updated by compiling the corresponding C source file. The result of <samp>`$(filter %.elc,$(files))'</samp> is <tt>`foo.elc'</tt>, so that file is made from <tt>`foo.el'</tt>.<br>
Another example shows how to use <span style="font-family: courier, mono;">$*</span> in static pattern rules: <a id="IDX247" name="IDX247"></a></p>
<p>bigoutput littleoutput : %output : text.g generate text.g -$* &gt; $@</p>
<p><br>
When the <span style="font-family: courier, mono;">generate</span> command is run, <span style="font-family: courier, mono;">$*</span> will expand to the stem, either <samp>`big'</samp> or <samp>`little'</samp>.</p>
<h3 class="subsubhead"><a id="SEC41" href="#TOC41" name="SEC41">Static Pattern Rules versus Implicit Rules</a></h3>
<p><br><a id="IDX248" name="IDX248"></a><a id="IDX249" name="IDX249"></a><br>
A static pattern rule has much in common with an implicit rule defined as a pattern rule (see section <a href="#SEC98">Defining and Redefining Pattern Rules</a>). Both have a pattern for the target and patterns for constructing the names of prerequisites. The difference is in how <span style="font-family: courier, mono;">make</span> decides <em>when</em> the rule applies.<br>
An implicit rule <em>can</em> apply to any target that matches its pattern, but it <em>does</em> apply only when the target has no commands otherwise specified, and only when the prerequisites can be found. If more than one implicit rule appears applicable, only one applies; the choice depends on the order of rules.<br>
By contrast, a static pattern rule applies to the precise list of targets that you specify in the rule. It cannot apply to any other target and it invariably does apply to each of the targets specified. If two conflicting rules apply, and both have commands, that's an error.<br>
The static pattern rule can be better than an implicit rule for these reasons:</p>
<ul>
<li>You may wish to override the usual implicit rule for a few files whose names cannot be categorized syntactically but can be given in an explicit list.</li>
<li>If you cannot be sure of the precise contents of the directories you are using, you may not be sure which other irrelevant files might lead <span style="font-family: courier, mono;">make</span> to use the wrong implicit rule. The choice might depend on the order in which the implicit rule search is done. With static pattern rules, there is no uncertainty: each rule applies to precisely the targets specified.</li>
</ul>
<h2 class="subhead"><a id="SEC42" href="#TOC42" name="SEC42">Double-Colon Rules</a></h2>
<p><br><a id="IDX250" name="IDX250"></a><a id="IDX251" name="IDX251"></a><a id="IDX252" name="IDX252"></a><a id="IDX253" name="IDX253"></a><br><strong>Double-colon</strong> rules are rules written with <samp>`::'</samp> instead of <samp>`:'</samp> after the target names. They are handled differently from ordinary rules when the same target appears in more than one rule.<br>
When a target appears in multiple rules, all the rules must be the same type: all ordinary, or all double-colon. If they are double-colon, each of them is independent of the others. Each double-colon rule's commands are executed if the target is older than any prerequisites of that rule. This can result in executing none, any, or all of the double-colon rules.<br>
Double-colon rules with the same target are in fact completely separate from one another. Each double-colon rule is processed individually, just as rules with different targets are processed.<br>
The double-colon rules for a target are executed in the order they appear in the makefile. However, the cases where double-colon rules really make sense are those where the order of executing the commands would not matter.<br>
Double-colon rules are somewhat obscure and not often very useful; they provide a mechanism for cases in which the method used to update a target differs depending on which prerequisite files caused the update, and such cases are rare.<br>
Each double-colon rule should specify commands; if it does not, an implicit rule will be used if one applies. See section <a href="#SEC93">Using Implicit Rules</a>.</p>
<h2 class="subhead"><a id="SEC43" href="#TOC43" name="SEC43">Generating Prerequisites Automatically</a></h2>
<p><br><a id="IDX254" name="IDX254"></a><a id="IDX255" name="IDX255"></a><a id="IDX256" name="IDX256"></a><br>
In the makefile for a program, many of the rules you need to write often say only that some object file depends on some header file. For example, if <tt>`main.c'</tt> uses <tt>`defs.h'</tt> via an <span style="font-family: courier, mono;">#include</span>, you would write:</p>
<p>main.o: defs.h</p>
<p><br>
You need this rule so that <span style="font-family: courier, mono;">make</span> knows that it must remake <tt>`main.o'</tt> whenever <tt>`defs.h'</tt> changes. You can see that for a large program you would have to write dozens of such rules in your makefile. And, you must always be very careful to update the makefile every time you add or remove an <span style="font-family: courier, mono;">#include</span>. <a id="IDX257" name="IDX257"></a><br><a id="IDX258" name="IDX258"></a>To avoid this hassle, most modern C compilers can write these rules for you, by looking at the <span style="font-family: courier, mono;">#include</span> lines in the source files. Usually this is done with the <samp>`-M'</samp> option to the compiler. For example, the command:</p>
<p>cc -M main.c</p>
<p><br>
generates the output:</p>
<p>main.o : main.c defs.h</p>
<p><br>
Thus you no longer have to write all those rules yourself. The compiler will do it for you.<br>
Note that such a prerequisite constitutes mentioning <tt>`main.o'</tt> in a makefile, so it can never be considered an intermediate file by implicit rule search. This means that <span style="font-family: courier, mono;">make</span> won't ever remove the file after using it; see section <a href="#SEC97">Chains of Implicit Rules</a>.<br><a id="IDX259" name="IDX259"></a>With old <span style="font-family: courier, mono;">make</span> programs, it was traditional practice to use this compiler feature to generate prerequisites on demand with a command like <samp>`make depend'</samp>. That command would create a file <tt>`depend'</tt> containing all the automatically-generated prerequisites; then the makefile could use <span style="font-family: courier, mono;">include</span> to read them in (see section <a href="#SEC15">Including Other Makefiles</a>).<br>
In GNU <span style="font-family: courier, mono;">make</span>, the feature of remaking makefiles makes this practice obsolete--you need never tell <span style="font-family: courier, mono;">make</span> explicitly to regenerate the prerequisites, because it always regenerates any makefile that is out of date. See section <a href="#SEC17">How Makefiles Are Remade</a>.<br>
The practice we recommend for automatic prerequisite generation is to have one makefile corresponding to each source file. For each source file <tt>`<var>name</var>.c'</tt> there is a makefile <tt>`<var>name</var>.d'</tt> which lists what files the object file <tt>`<var>name</var>.o'</tt> depends on. That way only the source files that have changed need to be rescanned to produce the new prerequisites.<br>
Here is the pattern rule to generate a file of prerequisites (i.e., a makefile) called <tt>`<var>name</var>.d'</tt> from a C source file called <tt>`<var>name</var>.c'</tt>:</p>
<p>%.d: %.c set -e; $(CC) -M $(CPPFLAGS) $&lt; \ | sed 's/\($*\)\.o[ :]*/\1.o $@ : /g' &gt; $@; \ [ -s $@ ] || rm -f $@</p>
<p><br>
See section <a href="#SEC98">Defining and Redefining Pattern Rules</a>, for information on defining pattern rules. The <samp>`-e'</samp> flag to the shell makes it exit immediately if the <span style="font-family: courier, mono;">$(CC)</span> command fails (exits with a nonzero status). Normally the shell exits with the status of the last command in the pipeline (<span style="font-family: courier, mono;">sed</span> in this case), so <span style="font-family: courier, mono;">make</span> would not notice a nonzero status from the compiler. <a id="IDX260" name="IDX260"></a><br><a id="IDX261" name="IDX261"></a>With the GNU C compiler, you may wish to use the <samp>`-MM'</samp> flag instead of <samp>`-M'</samp>. This omits prerequisites on system header files. See section `Options Controlling the Preprocessor' in <cite>Using GNU CC</cite>, for details.<br><a id="IDX262" name="IDX262"></a>The purpose of the <span style="font-family: courier, mono;">sed</span> command is to translate (for example):</p>
<p>main.o : main.c defs.h</p>
<p><br>
into:</p>
<p>main.o main.d : main.c defs.h</p>
<p><br><a id="IDX263" name="IDX263"></a>This makes each <samp>`.d'</samp> file depend on all the source and header files that the corresponding <samp>`.o'</samp> file depends on. <span style="font-family: courier, mono;">make</span> then knows it must regenerate the prerequisites whenever any of the source or header files changes.<br>
Once you've defined the rule to remake the <samp>`.d'</samp> files, you then use the <span style="font-family: courier, mono;">include</span> directive to read them all in. See section <a href="#SEC15">Including Other Makefiles</a>. For example:</p>
<p>sources = foo.c bar.c include $(sources:.c=.d)</p>
<p><br>
(This example uses a substitution variable reference to translate the list of source files <samp>`foo.c bar.c'</samp> into a list of prerequisite makefiles, <samp>`foo.d bar.d'</samp>. See section <a href="#SEC61">Substitution References</a>, for full information on substitution references.) Since the <samp>`.d'</samp> files are makefiles like any others, <span style="font-family: courier, mono;">make</span> will remake them as necessary with no further work from you. See section <a href="#SEC17">How Makefiles Are Remade</a>.<br></p>
<h2 class="subhead"><a id="SEC44" href="#TOC44" name="SEC44">Writing the Commands in Rules</a></h2>
<p><br><a id="IDX264" name="IDX264"></a><a id="IDX265" name="IDX265"></a><a id="IDX266" name="IDX266"></a><br>
The commands of a rule consist of shell command lines to be executed one by one. Each command line must start with a tab, except that the first command line may be attached to the target-and-prerequisites line with a semicolon in between. Blank lines and lines of just comments may appear among the command lines; they are ignored. (But beware, an apparently "blank" line that begins with a tab is <em>not</em> blank! It is an empty command; see section <a href="#SEC56">Using Empty Commands</a>.)<br>
Users use many different shell programs, but commands in makefiles are always interpreted by <tt>`/bin/sh'</tt> unless the makefile specifies otherwise. See section <a href="#SEC46">Command Execution</a>.<br><a id="IDX267" name="IDX267"></a><a id="IDX268" name="IDX268"></a><a id="IDX269" name="IDX269"></a>The shell that is in use determines whether comments can be written on command lines, and what syntax they use. When the shell is <tt>`/bin/sh'</tt>, a <samp>`#'</samp> starts a comment that extends to the end of the line. The <samp>`#'</samp> does not have to be at the beginning of a line. Text on a line before a <samp>`#'</samp> is not part of the comment.</p>
<h2 class="subhead"><a id="SEC45" href="#TOC45" name="SEC45">Command Echoing</a></h2>
<p><br><a id="IDX270" name="IDX270"></a><a id="IDX271" name="IDX271"></a><a id="IDX272" name="IDX272"></a><a id="IDX273" name="IDX273"></a><a id="IDX274" name="IDX274"></a><br>
Normally <span style="font-family: courier, mono;">make</span> prints each command line before it is executed. We call this <strong>echoing</strong> because it gives the appearance that you are typing the commands yourself.<br>
When a line starts with <samp>`@'</samp>, the echoing of that line is suppressed. The <samp>`@'</samp> is discarded before the command is passed to the shell. Typically you would use this for a command whose only effect is to print something, such as an <span style="font-family: courier, mono;">echo</span> command to indicate progress through the makefile:</p>
<p>@echo About to make distribution files</p>
<p><br><a id="IDX275" name="IDX275"></a><a id="IDX276" name="IDX276"></a><a id="IDX277" name="IDX277"></a><a id="IDX278" name="IDX278"></a>When <span style="font-family: courier, mono;">make</span> is given the flag <samp>`-n'</samp> or <samp>`--just-print'</samp> it only echoes commands, it won't execute them. See section <a href="#SEC92">Summary of Options</a>. In this case and only this case, even the commands starting with <samp>`@'</samp> are printed. This flag is useful for finding out which commands <span style="font-family: courier, mono;">make</span> thinks are necessary without actually doing them.<br><a id="IDX279" name="IDX279"></a><a id="IDX280" name="IDX280"></a><a id="IDX281" name="IDX281"></a><a id="IDX282" name="IDX282"></a>The <samp>`-s'</samp> or <samp>`--silent'</samp> flag to <span style="font-family: courier, mono;">make</span> prevents all echoing, as if all commands started with <samp>`@'</samp>. A rule in the makefile for the special target <span style="font-family: courier, mono;">.SILENT</span> without prerequisites has the same effect (see section <a href="#SEC36">Special Built-in Target Names</a>). <span style="font-family: courier, mono;">.SILENT</span> is essentially obsolete since <samp>`@'</samp> is more flexible.</p>
<h2 class="subhead"><a id="SEC46" href="#TOC46" name="SEC46">Command Execution</a></h2>
<p><br><a id="IDX283" name="IDX283"></a><a id="IDX284" name="IDX284"></a><a id="IDX285" name="IDX285"></a><a id="IDX286" name="IDX286"></a><br>
When it is time to execute commands to update a target, they are executed by making a new subshell for each line. (In practice, <span style="font-family: courier, mono;">make</span> may take shortcuts that do not affect the results.)<br><a id="IDX287" name="IDX287"></a><strong>Please note:</strong> this implies that shell commands such as <span style="font-family: courier, mono;">cd</span> that set variables local to each process will not affect the following command lines. <a id="DOCF2" href="#FOOT2" name="DOCF2">(2)</a>If you want to use <span style="font-family: courier, mono;">cd</span> to affect the next command, put the two on a single line with a semicolon between them. Then <span style="font-family: courier, mono;">make</span> will consider them a single command and pass them, together, to a shell which will execute them in sequence. For example:</p>
<p>foo : bar/lose cd bar; gobble lose &gt; ../foo</p>
<p><br><a id="IDX288" name="IDX288"></a><a id="IDX289" name="IDX289"></a><a id="IDX290" name="IDX290"></a><a id="IDX291" name="IDX291"></a><a id="IDX292" name="IDX292"></a><a id="IDX293" name="IDX293"></a>If you would like to split a single shell command into multiple lines of text, you must use a backslash at the end of all but the last subline. Such a sequence of lines is combined into a single line, by deleting the backslash-newline sequences, before passing it to the shell. Thus, the following is equivalent to the preceding example:</p>
<p>foo : bar/lose cd bar; \ gobble lose &gt; ../foo</p>
<p><br><a id="IDX294" name="IDX294"></a>The program used as the shell is taken from the variable <span style="font-family: courier, mono;">SHELL</span>. By default, the program <tt>`/bin/sh'</tt> is used.<br><a id="IDX295" name="IDX295"></a>On MS-DOS, if <span style="font-family: courier, mono;">SHELL</span> is not set, the value of the variable <span style="font-family: courier, mono;">COMSPEC</span> (which is always set) is used instead.<br><a id="IDX296" name="IDX296"></a>The processing of lines that set the variable <span style="font-family: courier, mono;">SHELL</span> in Makefiles is different on MS-DOS. The stock shell, <tt>`command.com'</tt>, is ridiculously limited in its functionality and many users of <span style="font-family: courier, mono;">make</span> tend to install a replacement shell. Therefore, on MS-DOS, <span style="font-family: courier, mono;">make</span> examines the value of <span style="font-family: courier, mono;">SHELL</span>, and changes its behavior based on whether it points to a Unix-style or DOS-style shell. This allows reasonable functionality even if <span style="font-family: courier, mono;">SHELL</span> points to <tt>`command.com'</tt>.<br>
If <span style="font-family: courier, mono;">SHELL</span> points to a Unix-style shell, <span style="font-family: courier, mono;">make</span> on MS-DOS additionally checks whether that shell can indeed be found; if not, it ignores the line that sets <span style="font-family: courier, mono;">SHELL</span>. In MS-DOS, GNU <span style="font-family: courier, mono;">make</span> searches for the shell in the following places:</p>
<ol>
<li>In the precise place pointed to by the value of <span style="font-family: courier, mono;">SHELL</span>. For example, if the makefile specifies <samp>`SHELL = /bin/sh'</samp>, <span style="font-family: courier, mono;">make</span> will look in the directory <tt>`/bin'</tt> on the current drive.</li>
<li>In the current directory.</li>
<li>In each of the directories in the <span style="font-family: courier, mono;">PATH</span> variable, in order.</li>
</ol>
<p><br>
In every directory it examines, <span style="font-family: courier, mono;">make</span> will first look for the specific file (<tt>`sh'</tt> in the example above). If this is not found, it will also look in that directory for that file with one of the known extensions which identify executable files. For example <tt>`.exe'</tt>, <tt>`.com'</tt>, <tt>`.bat'</tt>, <tt>`.btm'</tt>, <tt>`.sh'</tt>, and some others.<br>
If any of these attempts is successful, the value of <span style="font-family: courier, mono;">SHELL</span> will be set to the full pathname of the shell as found. However, if none of these is found, the value of <span style="font-family: courier, mono;">SHELL</span> will not be changed, and thus the line that sets it will be effectively ignored. This is so <span style="font-family: courier, mono;">make</span> will only support features specific to a Unix-style shell if such a shell is actually installed on the system where <span style="font-family: courier, mono;">make</span> runs.<br>
Note that this extended search for the shell is limited to the cases where <span style="font-family: courier, mono;">SHELL</span> is set from the Makefile; if it is set in the environment or command line, you are expected to set it to the full pathname of the shell, exactly as things are on Unix.<br>
The effect of the above DOS-specific processing is that a Makefile that says <samp>`SHELL = /bin/sh'</samp> (as many Unix makefiles do), will work on MS-DOS unaltered if you have e.g. <tt>`sh.exe'</tt> installed in some directory along your <span style="font-family: courier, mono;">PATH</span>.<br><a id="IDX297" name="IDX297"></a>Unlike most variables, the variable <span style="font-family: courier, mono;">SHELL</span> is never set from the environment. This is because the <span style="font-family: courier, mono;">SHELL</span> environment variable is used to specify your personal choice of shell program for interactive use. It would be very bad for personal choices like this to affect the functioning of makefiles. See section <a href="#SEC68">Variables from the Environment</a>. However, on MS-DOS and MS-Windows the value of <span style="font-family: courier, mono;">SHELL</span> in the environment <strong>is</strong> used, since on those systems most users do not set this variable, and therefore it is most likely set specifically to be used by <span style="font-family: courier, mono;">make</span>. On MS-DOS, if the setting of <span style="font-family: courier, mono;">SHELL</span> is not suitable for <span style="font-family: courier, mono;">make</span>, you can set the variable <span style="font-family: courier, mono;">MAKESHELL</span> to the shell that <span style="font-family: courier, mono;">make</span> should use; this will override the value of <span style="font-family: courier, mono;">SHELL</span>.</p>
<h2 class="subhead"><a id="SEC47" href="#TOC47" name="SEC47">Parallel Execution</a></h2>
<p><br><a id="IDX298" name="IDX298"></a><a id="IDX299" name="IDX299"></a><a id="IDX300" name="IDX300"></a><a id="IDX301" name="IDX301"></a><a id="IDX302" name="IDX302"></a><a id="IDX303" name="IDX303"></a><br>
GNU <span style="font-family: courier, mono;">make</span> knows how to execute several commands at once. Normally, <span style="font-family: courier, mono;">make</span> will execute only one command at a time, waiting for it to finish before executing the next. However, the <samp>`-j'</samp> or <samp>`--jobs'</samp> option tells <span style="font-family: courier, mono;">make</span> to execute many commands simultaneously.<br>
On MS-DOS, the <samp>`-j'</samp> option has no effect, since that system doesn't support multi-processing.<br>
If the <samp>`-j'</samp> option is followed by an integer, this is the number of commands to execute at once; this is called the number of <strong>job slots</strong>. If there is nothing looking like an integer after the <samp>`-j'</samp> option, there is no limit on the number of job slots. The default number of job slots is one, which means serial execution (one thing at a time).<br>
One unpleasant consequence of running several commands simultaneously is that output generated by the commands appears whenever each command sends it, so messages from different commands may be interspersed.<br>
Another problem is that two processes cannot both take input from the same device; so to make sure that only one command tries to take input from the terminal at once, <span style="font-family: courier, mono;">make</span> will invalidate the standard input streams of all but one running command. This means that attempting to read from standard input will usually be a fatal error (a <samp>`Broken pipe'</samp> signal) for most child processes if there are several. <a id="IDX304" name="IDX304"></a><a id="IDX305" name="IDX305"></a><br>
It is unpredictable which command will have a valid standard input stream (which will come from the terminal, or wherever you redirect the standard input of <span style="font-family: courier, mono;">make</span>). The first command run will always get it first, and the first command started after that one finishes will get it next, and so on.<br>
We will change how this aspect of <span style="font-family: courier, mono;">make</span> works if we find a better alternative. In the mean time, you should not rely on any command using standard input at all if you are using the parallel execution feature; but if you are not using this feature, then standard input works normally in all commands.<br>
Finally, handling recursive <span style="font-family: courier, mono;">make</span> invocations raises issues. For more information on this, see section <a href="#SEC53">Communicating Options to a Sub-<span style="font-family: courier, mono;">make</span></a>.<br>
If a command fails (is killed by a signal or exits with a nonzero status), and errors are not ignored for that command (see section <a href="#SEC48">Errors in Commands</a>), the remaining command lines to remake the same target will not be run. If a command fails and the <samp>`-k'</samp> or <samp>`--keep-going'</samp> option was not given (see section <a href="#SEC92">Summary of Options</a>), <span style="font-family: courier, mono;">make</span> aborts execution. If make terminates for any reason (including a signal) with child processes running, it waits for them to finish before actually exiting.<br><a id="IDX306" name="IDX306"></a><a id="IDX307" name="IDX307"></a><a id="IDX308" name="IDX308"></a><a id="IDX309" name="IDX309"></a><a id="IDX310" name="IDX310"></a><a id="IDX311" name="IDX311"></a>When the system is heavily loaded, you will probably want to run fewer jobs than when it is lightly loaded. You can use the <samp>`-l'</samp> option to tell <span style="font-family: courier, mono;">make</span> to limit the number of jobs to run at once, based on the load average. The <samp>`-l'</samp> or <samp>`--max-load'</samp> option is followed by a floating-point number. For example,</p>
<p>-l 2.5</p>
<p><br>
will not let <span style="font-family: courier, mono;">make</span> start more than one job if the load average is above 2.5. The <samp>`-l'</samp> option with no following number removes the load limit, if one was given with a previous <samp>`-l'</samp> option.<br>
More precisely, when <span style="font-family: courier, mono;">make</span> goes to start up a job, and it already has at least one job running, it checks the current load average; if it is not lower than the limit given with <samp>`-l'</samp>, <span style="font-family: courier, mono;">make</span> waits until the load average goes below that limit, or until all the other jobs finish.<br>
By default, there is no load limit.</p>
<h2 class="subhead"><a id="SEC48" href="#TOC48" name="SEC48">Errors in Commands</a></h2>
<p><br><a id="IDX312" name="IDX312"></a><a id="IDX313" name="IDX313"></a><a id="IDX314" name="IDX314"></a><br>
After each shell command returns, <span style="font-family: courier, mono;">make</span> looks at its exit status. If the command completed successfully, the next command line is executed in a new shell; after the last command line is finished, the rule is finished.<br>
If there is an error (the exit status is nonzero), <span style="font-family: courier, mono;">make</span> gives up on the current rule, and perhaps on all rules.<br>
Sometimes the failure of a certain command does not indicate a problem. For example, you may use the <span style="font-family: courier, mono;">mkdir</span> command to ensure that a directory exists. If the directory already exists, <span style="font-family: courier, mono;">mkdir</span> will report an error, but you probably want <span style="font-family: courier, mono;">make</span> to continue regardless.<br><a id="IDX315" name="IDX315"></a>To ignore errors in a command line, write a <samp>`-'</samp> at the beginning of the line's text (after the initial tab). The <samp>`-'</samp> is discarded before the command is passed to the shell for execution.<br>
For example,</p>
<p>clean: -rm -f *.o</p>
<p><br><a id="IDX316" name="IDX316"></a><br>
This causes <span style="font-family: courier, mono;">rm</span> to continue even if it is unable to remove a file.<br><a id="IDX317" name="IDX317"></a><a id="IDX318" name="IDX318"></a><a id="IDX319" name="IDX319"></a>When you run <span style="font-family: courier, mono;">make</span> with the <samp>`-i'</samp> or <samp>`--ignore-errors'</samp> flag, errors are ignored in all commands of all rules. A rule in the makefile for the special target <span style="font-family: courier, mono;">.IGNORE</span> has the same effect, if there are no prerequisites. These ways of ignoring errors are obsolete because <samp>`-'</samp> is more flexible.<br>
When errors are to be ignored, because of either a <samp>`-'</samp> or the <samp>`-i'</samp> flag, <span style="font-family: courier, mono;">make</span> treats an error return just like success, except that it prints out a message that tells you the status code the command exited with, and says that the error has been ignored.<br>
When an error happens that <span style="font-family: courier, mono;">make</span> has not been told to ignore, it implies that the current target cannot be correctly remade, and neither can any other that depends on it either directly or indirectly. No further commands will be executed for these targets, since their preconditions have not been achieved.<br><a id="IDX320" name="IDX320"></a><a id="IDX321" name="IDX321"></a>Normally <span style="font-family: courier, mono;">make</span> gives up immediately in this circumstance, returning a nonzero status. However, if the <samp>`-k'</samp> or <samp>`--keep-going'</samp> flag is specified, <span style="font-family: courier, mono;">make</span> continues to consider the other prerequisites of the pending targets, remaking them if necessary, before it gives up and returns nonzero status. For example, after an error in compiling one object file, <samp>`make -k'</samp> will continue compiling other object files even though it already knows that linking them will be impossible. See section <a href="#SEC92">Summary of Options</a>.<br>
The usual behavior assumes that your purpose is to get the specified targets up to date; once <span style="font-family: courier, mono;">make</span> learns that this is impossible, it might as well report the failure immediately. The <samp>`-k'</samp> option says that the real purpose is to test as many of the changes made in the program as possible, perhaps to find several independent problems so that you can correct them all before the next attempt to compile. This is why Emacs' <span style="font-family: courier, mono;">compile</span> command passes the <samp>`-k'</samp> flag by default. <a id="IDX322" name="IDX322"></a><br><a id="IDX323" name="IDX323"></a><a id="IDX324" name="IDX324"></a><a id="IDX325" name="IDX325"></a><a id="IDX326" name="IDX326"></a>Usually when a command fails, if it has changed the target file at all, the file is corrupted and cannot be used--or at least it is not completely updated. Yet the file's timestamp says that it is now up to date, so the next time <span style="font-family: courier, mono;">make</span> runs, it will not try to update that file. The situation is just the same as when the command is killed by a signal; see section <a href="#SEC49">Interrupting or Killing <span style="font-family: courier, mono;">make</span></a>. So generally the right thing to do is to delete the target file if the command fails after beginning to change the file. <span style="font-family: courier, mono;">make</span> will do this if <span style="font-family: courier, mono;">.DELETE_ON_ERROR</span> appears as a target. This is almost always what you want <span style="font-family: courier, mono;">make</span> to do, but it is not historical practice; so for compatibility, you must explicitly request it.</p>
<h2 class="subhead"><a id="SEC49" href="#TOC49" name="SEC49">Interrupting or Killing <span style="font-family: courier, mono;">make</span></a></h2>
<p><br>
If <span style="font-family: courier, mono;">make</span> gets a fatal signal while a command is executing, it may delete the target file that the command was supposed to update. This is done if the target file's last-modification time has changed since <span style="font-family: courier, mono;">make</span> first checked it.<br>
The purpose of deleting the target is to make sure that it is remade from scratch when <span style="font-family: courier, mono;">make</span> is next run. Why is this? Suppose you type <kbd>Ctrl-c</kbd> while a compiler is running, and it has begun to write an object file <tt>`foo.o'</tt>. The <kbd>Ctrl-c</kbd> kills the compiler, resulting in an incomplete file whose last-modification time is newer than the source file <tt>`foo.c'</tt>. But <span style="font-family: courier, mono;">make</span> also receives the <kbd>Ctrl-c</kbd> signal and deletes this incomplete file. If <span style="font-family: courier, mono;">make</span> did not do this, the next invocation of <span style="font-family: courier, mono;">make</span> would think that <tt>`foo.o'</tt> did not require updating--resulting in a strange error message from the linker when it tries to link an object file half of which is missing.<br><a id="IDX333" name="IDX333"></a>You can prevent the deletion of a target file in this way by making the special target <span style="font-family: courier, mono;">.PRECIOUS</span> depend on it. Before remaking a target, <span style="font-family: courier, mono;">make</span> checks to see whether it appears on the prerequisites of <span style="font-family: courier, mono;">.PRECIOUS</span>, and thereby decides whether the target should be deleted if a signal happens. Some reasons why you might do this are that the target is updated in some atomic fashion, or exists only to record a modification-time (its contents do not matter), or must exist at all times to prevent other sorts of trouble.</p>
<h2 class="subhead"><a id="SEC50" href="#TOC50" name="SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a></h2>
<p><br><a id="IDX334" name="IDX334"></a><a id="IDX335" name="IDX335"></a><br>
Recursive use of <span style="font-family: courier, mono;">make</span> means using <span style="font-family: courier, mono;">make</span> as a command in a makefile. This technique is useful when you want separate makefiles for various subsystems that compose a larger system. For example, suppose you have a subdirectory <tt>`subdir'</tt> which has its own makefile, and you would like the containing directory's makefile to run <span style="font-family: courier, mono;">make</span> on the subdirectory. You can do it by writing this:</p>
<p>subsystem: cd subdir &amp;&amp; $(MAKE)</p>
<p><br>
or, equivalently, this (see section <a href="#SEC92">Summary of Options</a>):</p>
<p>subsystem: $(MAKE) -C subdir</p>
<p><br><a id="IDX336" name="IDX336"></a><a id="IDX337" name="IDX337"></a><br>
You can write recursive <span style="font-family: courier, mono;">make</span> commands just by copying this example, but there are many things to know about how they work and why, and about how the sub-<span style="font-family: courier, mono;">make</span> relates to the top-level <span style="font-family: courier, mono;">make</span>.<br>
For your convenience, GNU <span style="font-family: courier, mono;">make</span> sets the variable <span style="font-family: courier, mono;">CURDIR</span> to the pathname of the current working directory for you. If <span style="font-family: courier, mono;">-C</span> is in effect, it will contain the path of the new directory, not the original. The value has the same precedence it would have if it were set in the makefile (by default, an environment variable <span style="font-family: courier, mono;">CURDIR</span> will not override this value). Note that setting this variable has no effect on the operation of <span style="font-family: courier, mono;">make</span></p>
<h3 class="subsubhead"><a id="SEC51" href="#TOC51" name="SEC51">How the <span style="font-family: courier, mono;">MAKE</span> Variable Works</a></h3>
<p><br><a id="IDX338" name="IDX338"></a><a id="IDX339" name="IDX339"></a><br>
Recursive <span style="font-family: courier, mono;">make</span> commands should always use the variable <span style="font-family: courier, mono;">MAKE</span>, not the explicit command name <samp>`make'</samp>, as shown here:</p>
<p>subsystem: cd subdir &amp;&amp; $(MAKE)</p>
<p><br>
The value of this variable is the file name with which <span style="font-family: courier, mono;">make</span> was invoked. If this file name was <tt>`/bin/make'</tt>, then the command executed is <samp>`cd subdir &amp;&amp; /bin/make'</samp>. If you use a special version of <span style="font-family: courier, mono;">make</span> to run the top-level makefile, the same special version will be executed for recursive invocations. <a id="IDX340" name="IDX340"></a><br>
As a special feature, using the variable <span style="font-family: courier, mono;">MAKE</span> in the commands of a rule alters the effects of the <samp>`-t'</samp> (<samp>`--touch'</samp>), <samp>`-n'</samp> (<samp>`--just-print'</samp>), or <samp>`-q'</samp> (<samp>`--question'</samp>) option. Using the <span style="font-family: courier, mono;">MAKE</span> variable has the same effect as using a <samp>`+'</samp> character at the beginning of the command line. See section <a href="#SEC88">Instead of Executing the Commands</a>.<br>
Consider the command <samp>`make -t'</samp> in the above example. (The <samp>`-t'</samp> option marks targets as up to date without actually running any commands; see section <a href="#SEC88">Instead of Executing the Commands</a>.) Following the usual definition of <samp>`-t'</samp>, a <samp>`make -t'</samp> command in the example would create a file named <tt>`subsystem'</tt> and do nothing else. What you really want it to do is run <samp>`cd subdir &amp;&amp; make -t'</samp>; but that would require executing the command, and <samp>`-t'</samp> says not to execute commands.<a id="IDX341" name="IDX341"></a><a id="IDX342" name="IDX342"></a><a id="IDX343" name="IDX343"></a><br>
The special feature makes this do what you want: whenever a command line of a rule contains the variable <span style="font-family: courier, mono;">MAKE</span>, the flags <samp>`-t'</samp>, <samp>`-n'</samp> and <samp>`-q'</samp> do not apply to that line. Command lines containing <span style="font-family: courier, mono;">MAKE</span> are executed normally despite the presence of a flag that causes most commands not to be run. The usual <span style="font-family: courier, mono;">MAKEFLAGS</span> mechanism passes the flags to the sub-<span style="font-family: courier, mono;">make</span> (see section <a href="#SEC53">Communicating Options to a Sub-<span style="font-family: courier, mono;">make</span></a>), so your request to touch the files, or print the commands, is propagated to the subsystem.</p>
<h3 class="subsubhead"><a id="SEC52" href="#TOC52" name="SEC52">Communicating Variables to a Sub-<span style="font-family: courier, mono;">make</span></a></h3>
<p><br><a id="IDX344" name="IDX344"></a><a id="IDX345" name="IDX345"></a><a id="IDX346" name="IDX346"></a><a id="IDX347" name="IDX347"></a><a id="IDX348" name="IDX348"></a><a id="IDX349" name="IDX349"></a><a id="IDX350" name="IDX350"></a><br>
Variable values of the top-level <span style="font-family: courier, mono;">make</span> can be passed to the sub-<span style="font-family: courier, mono;">make</span> through the environment by explicit request. These variables are defined in the sub-<span style="font-family: courier, mono;">make</span> as defaults, but do not override what is specified in the makefile used by the sub-<span style="font-family: courier, mono;">make</span> makefile unless you use the <samp>`-e'</samp> switch (see section <a href="#SEC92">Summary of Options</a>).<br>
To pass down, or <strong>export</strong>, a variable, <span style="font-family: courier, mono;">make</span> adds the variable and its value to the environment for running each command. The sub-<span style="font-family: courier, mono;">make</span>, in turn, uses the environment to initialize its table of variable values. See section <a href="#SEC68">Variables from the Environment</a>.<br>
Except by explicit request, <span style="font-family: courier, mono;">make</span> exports a variable only if it is either defined in the environment initially or set on the command line, and if its name consists only of letters, numbers, and underscores. Some shells cannot cope with environment variable names consisting of characters other than letters, numbers, and underscores.<br>
The special variables <span style="font-family: courier, mono;">SHELL</span> and <span style="font-family: courier, mono;">MAKEFLAGS</span> are always exported (unless you unexport them). <span style="font-family: courier, mono;">MAKEFILES</span> is exported if you set it to anything.<br><span style="font-family: courier, mono;">make</span> automatically passes down variable values that were defined on the command line, by putting them in the <span style="font-family: courier, mono;">MAKEFLAGS</span> variable. See the next section.<br>
Variables are <em>not</em> normally passed down if they were created by default by <span style="font-family: courier, mono;">make</span> (see section <a href="#SEC96">Variables Used by Implicit Rules</a>). The sub-<span style="font-family: courier, mono;">make</span> will define these for itself.<br><a id="IDX351" name="IDX351"></a>If you want to export specific variables to a sub-<span style="font-family: courier, mono;">make</span>, use the <span style="font-family: courier, mono;">export</span> directive, like this:</p>
<p>export <var>variable</var> ...</p>
<p><br><a id="IDX352" name="IDX352"></a>If you want to <em>prevent</em> a variable from being exported, use the <span style="font-family: courier, mono;">unexport</span> directive, like this:</p>
<p>unexport <var>variable</var> ...</p>
<p><br>
As a convenience, you can define a variable and export it at the same time by doing:</p>
<p>export <var>variable</var> = value</p>
<p><br>
has the same result as:</p>
<p><var>variable</var> = value export <var>variable</var></p>
<p><br>
and</p>
<p>export <var>variable</var> := value</p>
<p><br>
has the same result as:</p>
<p><var>variable</var> := value export <var>variable</var></p>
<p><br>
Likewise,</p>
<p>export <var>variable</var> += value</p>
<p><br>
is just like:</p>
<p><var>variable</var> += value export <var>variable</var></p>
<p><br>
See section <a href="#SEC65">Appending More Text to Variables</a>.<br>
You may notice that the <span style="font-family: courier, mono;">export</span> and <span style="font-family: courier, mono;">unexport</span> directives work in <span style="font-family: courier, mono;">make</span> in the same way they work in the shell, <span style="font-family: courier, mono;">sh</span>.<br>
If you want all variables to be exported by default, you can use <span style="font-family: courier, mono;">export</span> by itself:</p>
<p>export</p>
<p><br>
This tells <span style="font-family: courier, mono;">make</span> that variables which are not explicitly mentioned in an <span style="font-family: courier, mono;">export</span> or <span style="font-family: courier, mono;">unexport</span> directive should be exported. Any variable given in an <span style="font-family: courier, mono;">unexport</span> directive will still <em>not</em> be exported. If you use <span style="font-family: courier, mono;">export</span> by itself to export variables by default, variables whose names contain characters other than alphanumerics and underscores will not be exported unless specifically mentioned in an <span style="font-family: courier, mono;">export</span> directive.<br><a id="IDX353" name="IDX353"></a>The behavior elicited by an <span style="font-family: courier, mono;">export</span> directive by itself was the default in older versions of GNU <span style="font-family: courier, mono;">make</span>. If your makefiles depend on this behavior and you want to be compatible with old versions of <span style="font-family: courier, mono;">make</span>, you can write a rule for the special target <span style="font-family: courier, mono;">.EXPORT_ALL_VARIABLES</span> instead of using the <span style="font-family: courier, mono;">export</span> directive. This will be ignored by old <span style="font-family: courier, mono;">make</span>s, while the <span style="font-family: courier, mono;">export</span> directive will cause a syntax error.<a id="IDX354" name="IDX354"></a><br>
Likewise, you can use <span style="font-family: courier, mono;">unexport</span> by itself to tell <span style="font-family: courier, mono;">make</span> <em>not</em> to export variables by default. Since this is the default behavior, you would only need to do this if <span style="font-family: courier, mono;">export</span> had been used by itself earlier (in an included makefile, perhaps). You <strong>cannot</strong> use <span style="font-family: courier, mono;">export</span> and <span style="font-family: courier, mono;">unexport</span> by themselves to have variables exported for some commands and not for others. The last <span style="font-family: courier, mono;">export</span> or <span style="font-family: courier, mono;">unexport</span> directive that appears by itself determines the behavior for the entire run of <span style="font-family: courier, mono;">make</span>.<br><a id="IDX355" name="IDX355"></a><a id="IDX356" name="IDX356"></a>As a special feature, the variable <span style="font-family: courier, mono;">MAKELEVEL</span> is changed when it is passed down from level to level. This variable's value is a string which is the depth of the level as a decimal number. The value is <samp>`0'</samp> for the top-level <span style="font-family: courier, mono;">make</span>; <samp>`1'</samp> for a sub-<span style="font-family: courier, mono;">make</span>, <samp>`2'</samp> for a sub-sub-<span style="font-family: courier, mono;">make</span>, and so on. The incrementation happens when <span style="font-family: courier, mono;">make</span> sets up the environment for a command.<br>
The main use of <span style="font-family: courier, mono;">MAKELEVEL</span> is to test it in a conditional directive (see section <a href="#SEC71">Conditional Parts of Makefiles</a>); this way you can write a makefile that behaves one way if run recursively and another way if run directly by you.<br><a id="IDX357" name="IDX357"></a>You can use the variable <span style="font-family: courier, mono;">MAKEFILES</span> to cause all sub-<span style="font-family: courier, mono;">make</span> commands to use additional makefiles. The value of <span style="font-family: courier, mono;">MAKEFILES</span> is a whitespace-separated list of file names. This variable, if defined in the outer-level makefile, is passed down through the environment; then it serves as a list of extra makefiles for the sub-<span style="font-family: courier, mono;">make</span> to read before the usual or specified ones. See section <a href="#SEC16">The Variable <span style="font-family: courier, mono;">MAKEFILES</span></a>.</p>
<h3 class="subsubhead"><a id="SEC53" href="#TOC53" name="SEC53">Communicating Options to a Sub-<span style="font-family: courier, mono;">make</span></a></h3>
<p><br><a id="IDX358" name="IDX358"></a><a id="IDX359" name="IDX359"></a><br><a id="IDX360" name="IDX360"></a>Flags such as <samp>`-s'</samp> and <samp>`-k'</samp> are passed automatically to the sub-<span style="font-family: courier, mono;">make</span> through the variable <span style="font-family: courier, mono;">MAKEFLAGS</span>. This variable is set up automatically by <span style="font-family: courier, mono;">make</span> to contain the flag letters that <span style="font-family: courier, mono;">make</span> received. Thus, if you do <samp>`make -ks'</samp> then <span style="font-family: courier, mono;">MAKEFLAGS</span> gets the value <samp>`ks'</samp>.<br>
As a consequence, every sub-<span style="font-family: courier, mono;">make</span> gets a value for <span style="font-family: courier, mono;">MAKEFLAGS</span> in its environment. In response, it takes the flags from that value and processes them as if they had been given as arguments. See section <a href="#SEC92">Summary of Options</a>.<br><a id="IDX361" name="IDX361"></a><a id="IDX362" name="IDX362"></a><a id="IDX363" name="IDX363"></a>Likewise variables defined on the command line are passed to the sub-<span style="font-family: courier, mono;">make</span> through <span style="font-family: courier, mono;">MAKEFLAGS</span>. Words in the value of <span style="font-family: courier, mono;">MAKEFLAGS</span> that contain <samp>`='</samp>, <span style="font-family: courier, mono;">make</span> treats as variable definitions just as if they appeared on the command line. See section <a href="#SEC90">Overriding Variables</a>.<br><a id="IDX364" name="IDX364"></a><a id="IDX365" name="IDX365"></a><a id="IDX366" name="IDX366"></a><a id="IDX367" name="IDX367"></a><a id="IDX368" name="IDX368"></a><a id="IDX369" name="IDX369"></a><a id="IDX370" name="IDX370"></a><a id="IDX371" name="IDX371"></a><a id="IDX372" name="IDX372"></a><a id="IDX373" name="IDX373"></a><a id="IDX374" name="IDX374"></a><a id="IDX375" name="IDX375"></a><a id="IDX376" name="IDX376"></a><a id="IDX377" name="IDX377"></a>The options <samp>`-C'</samp>, <samp>`-f'</samp>, <samp>`-o'</samp>, and <samp>`-W'</samp> are not put into <span style="font-family: courier, mono;">MAKEFLAGS</span>; these options are not passed down.<br><a id="IDX378" name="IDX378"></a><a id="IDX379" name="IDX379"></a><a id="IDX380" name="IDX380"></a><a id="IDX381" name="IDX381"></a>The <samp>`-j'</samp> option is a special case (see section <a href="#SEC47">Parallel Execution</a>). If you set it to some numeric value <samp>`N'</samp> and your operating system supports it (most any UNIX system will; others typically won't), the parent <span style="font-family: courier, mono;">make</span> and all the sub-<span style="font-family: courier, mono;">make</span>s will communicate to ensure that there are only <samp>`N'</samp> jobs running at the same time between them all. Note that any job that is marked recursive (see section <a href="#SEC88">Instead of Executing the Commands</a>) doesn't count against the total jobs (otherwise we could get <samp>`N'</samp> sub-<span style="font-family: courier, mono;">make</span>s running and have no slots left over for any real work!)<br>
If your operating system doesn't support the above communication, then <samp>`-j 1'</samp> is always put into <span style="font-family: courier, mono;">MAKEFLAGS</span> instead of the value you specified. This is because if the <samp>`-j'</samp> option were passed down to sub-<span style="font-family: courier, mono;">make</span>s, you would get many more jobs running in parallel than you asked for. If you give <samp>`-j'</samp> with no numeric argument, meaning to run as many jobs as possible in parallel, this is passed down, since multiple infinities are no more than one.<br>
If you do not want to pass the other flags down, you must change the value of <span style="font-family: courier, mono;">MAKEFLAGS</span>, like this:</p>
<p>subsystem: cd subdir &amp;&amp; $(MAKE) MAKEFLAGS=</p>
<p><br><a id="IDX382" name="IDX382"></a>The command line variable definitions really appear in the variable <span style="font-family: courier, mono;">MAKEOVERRIDES</span>, and <span style="font-family: courier, mono;">MAKEFLAGS</span> contains a reference to this variable. If you do want to pass flags down normally, but don't want to pass down the command line variable definitions, you can reset <span style="font-family: courier, mono;">MAKEOVERRIDES</span> to empty, like this:</p>
<p>MAKEOVERRIDES =</p>
<p><br><a id="IDX383" name="IDX383"></a><a id="IDX384" name="IDX384"></a>This is not usually useful to do. However, some systems have a small fixed limit on the size of the environment, and putting so much information into the value of <span style="font-family: courier, mono;">MAKEFLAGS</span> can exceed it. If you see the error message <samp>`Arg list too long'</samp>, this may be the problem. <a id="IDX385" name="IDX385"></a><a id="IDX386" name="IDX386"></a>(For strict compliance with POSIX.2, changing <span style="font-family: courier, mono;">MAKEOVERRIDES</span> does not affect <span style="font-family: courier, mono;">MAKEFLAGS</span> if the special target <samp>`.POSIX'</samp> appears in the makefile. You probably do not care about this.)<br><a id="IDX387" name="IDX387"></a>A similar variable <span style="font-family: courier, mono;">MFLAGS</span> exists also, for historical compatibility. It has the same value as <span style="font-family: courier, mono;">MAKEFLAGS</span> except that it does not contain the command line variable definitions, and it always begins with a hyphen unless it is empty (<span style="font-family: courier, mono;">MAKEFLAGS</span> begins with a hyphen only when it begins with an option that has no single-letter version, such as <samp>`--warn-undefined-variables'</samp>). <span style="font-family: courier, mono;">MFLAGS</span> was traditionally used explicitly in the recursive <span style="font-family: courier, mono;">make</span> command, like this:</p>
<p>subsystem: cd subdir &amp;&amp; $(MAKE) $(MFLAGS)</p>
<p><br>
but now <span style="font-family: courier, mono;">MAKEFLAGS</span> makes this usage redundant. If you want your makefiles to be compatible with old <span style="font-family: courier, mono;">make</span> programs, use this technique; it will work fine with more modern <span style="font-family: courier, mono;">make</span> versions too.<br><a id="IDX388" name="IDX388"></a><a id="IDX389" name="IDX389"></a><a id="IDX390" name="IDX390"></a><a id="IDX391" name="IDX391"></a>The <span style="font-family: courier, mono;">MAKEFLAGS</span> variable can also be useful if you want to have certain options, such as <samp>`-k'</samp> (see section <a href="#SEC92">Summary of Options</a>), set each time you run <span style="font-family: courier, mono;">make</span>. You simply put a value for <span style="font-family: courier, mono;">MAKEFLAGS</span> in your environment. You can also set <span style="font-family: courier, mono;">MAKEFLAGS</span> in a makefile, to specify additional flags that should also be in effect for that makefile. (Note that you cannot use <span style="font-family: courier, mono;">MFLAGS</span> this way. That variable is set only for compatibility; <span style="font-family: courier, mono;">make</span> does not interpret a value you set for it in any way.)<br>
When <span style="font-family: courier, mono;">make</span> interprets the value of <span style="font-family: courier, mono;">MAKEFLAGS</span> (either from the environment or from a makefile), it first prepends a hyphen if the value does not already begin with one. Then it chops the value into words separated by blanks, and parses these words as if they were options given on the command line (except that <samp>`-C'</samp>, <samp>`-f'</samp>, <samp>`-h'</samp>, <samp>`-o'</samp>, <samp>`-W'</samp>, and their long-named versions are ignored; and there is no error for an invalid option).<br>
If you do put <span style="font-family: courier, mono;">MAKEFLAGS</span> in your environment, you should be sure not to include any options that will drastically affect the actions of <span style="font-family: courier, mono;">make</span> and undermine the purpose of makefiles and of <span style="font-family: courier, mono;">make</span> itself. For instance, the <samp>`-t'</samp>, <samp>`-n'</samp>, and <samp>`-q'</samp> options, if put in one of these variables, could have disastrous consequences and would certainly have at least surprising and probably annoying effects.</p>
<h3 class="subsubhead"><a id="SEC54" href="#TOC54" name="SEC54">The <samp>`--print-directory'</samp> Option</a></h3>
<p><br><a id="IDX392" name="IDX392"></a><a id="IDX393" name="IDX393"></a><a id="IDX394" name="IDX394"></a><br>
If you use several levels of recursive <span style="font-family: courier, mono;">make</span> invocations, the <samp>`-w'</samp> or <samp>`--print-directory'</samp> option can make the output a lot easier to understand by showing each directory as <span style="font-family: courier, mono;">make</span> starts processing it and as <span style="font-family: courier, mono;">make</span> finishes processing it. For example, if <samp>`make -w'</samp> is run in the directory <tt>`/u/gnu/make'</tt>, <span style="font-family: courier, mono;">make</span> will print a line of the form:</p>
<p>make: Entering directory `/u/gnu/make'.</p>
<p>before doing anything else, and a line of the form:</p>
<p>make: Leaving directory `/u/gnu/make'.</p>
<p>when processing is completed.</p>
<p>Normally, you do not need to specify this option because <samp>`make'</samp> does it for you: <samp>`-w'</samp> is turned on automatically when you use the <samp>`-C'</samp> option, and in sub-<span style="font-family: courier, mono;">make</span>s. <span style="font-family: courier, mono;">make</span> will not automatically turn on <samp>`-w'</samp> if you also use <samp>`-s'</samp>, which says to be silent, or if you use <samp>`--no-print-directory'</samp> to explicitly disable it.</p>
<h2 class="subhead"><a id="SEC55" href="#TOC55" name="SEC55">Defining Canned Command Sequences</a></h2>
<p><a id="IDX405" name="IDX405"></a><a id="IDX406" name="IDX406"></a> </p>
<p>When the same sequence of commands is useful in making various targets, you can define it as a canned sequence with the <span style="font-family: courier, mono;">define</span> directive, and refer to the canned sequence from the rules for those targets. The canned sequence is actually a variable, so the name must not conflict with other variable names.</p>
<p>Here is an example of defining a canned sequence of commands:</p>
<p>define run-yaccyacc $(firstword $^)mv y.tab.c $@endef</p>
<p><a id="IDX407" name="IDX407"></a> </p>
<p>Here <span style="font-family: courier, mono;">run-yacc</span> is the name of the variable being defined; <span style="font-family: courier, mono;">endef</span> marks the end of the definition; the lines in between are the commands. The <span style="font-family: courier, mono;">define</span> directive does not expand variable references and function calls in the canned sequence; the <samp>`$'</samp> characters, parentheses, variable names, and so on, all become part of the value of the variable you are defining. See section <a href="#SEC67">Defining Variables Verbatim</a>, for a complete explanation of <span style="font-family: courier, mono;">define</span>.</p>
<p>The first command in this example runs Yacc on the first prerequisite of whichever rule uses the canned sequence. The output file from Yacc is always named <tt>`y.tab.c'</tt>. The second command moves the output to the rule's target file name.</p>
<p>To use the canned sequence, substitute the variable into the commands of a rule. You can substitute it like any other variable (see section <a href="#SEC58">Basics of Variable References</a>). Because variables defined by <span style="font-family: courier, mono;">define</span> are recursively expanded variables, all the variable references you wrote inside the <span style="font-family: courier, mono;">define</span> are expanded now. For example:</p>
<p>foo.c : foo.y $(run-yacc)</p>
<p><samp>`foo.y'</samp> will be substituted for the variable <samp>`$^'</samp> when it occurs in <span style="font-family: courier, mono;">run-yacc</span>'s value, and <samp>`foo.c'</samp> for <samp>`$@'</samp>.</p>
<p>This is a realistic example, but this particular one is not needed in practice because <span style="font-family: courier, mono;">make</span> has an implicit rule to figure out these commands based on the file names involved (see section <a href="#SEC93">Using Implicit Rules</a>).</p>
<p><a id="IDX408" name="IDX408"></a><a id="IDX409" name="IDX409"></a><a id="IDX410" name="IDX410"></a>In command execution, each line of a canned sequence is treated just as if the line appeared on its own in the rule, preceded by a tab. In particular, <span style="font-family: courier, mono;">make</span> invokes a separate subshell for each line. You can use the special prefix characters that affect command lines (<samp>`@'</samp>, <samp>`-'</samp>, and <samp>`+'</samp>) on each line of a canned sequence. See section <a href="#SEC44">Writing the Commands in Rules</a>. For example, using this canned sequence:</p>
<p>define frobnicate@echo "frobnicating target $@"frob-step-1 $&lt; -o $@-step-1 frob-step-2 $@-step-1 -o $@endef</p>
<p><span style="font-family: courier, mono;">make</span> will not echo the first line, the <span style="font-family: courier, mono;">echo</span> command. But it <em>will</em> echo the following two command lines.</p>
<p>On the other hand, prefix characters on the command line that refers to a canned sequence apply to every line in the sequence. So the rule:</p>
<p>frob.out: frob.in @$(frobnicate)</p>
<p>does not echo <em>any</em> commands. (See section <a href="#SEC45">Command Echoing</a>, for a full explanation of <samp>`@'</samp>.)</p>
<h2 class="subhead"><a id="SEC56" href="#TOC56" name="SEC56">Using Empty Commands</a></h2>
<p><a id="IDX411" name="IDX411"></a><a id="IDX412" name="IDX412"></a> </p>
<p>It is sometimes useful to define commands which do nothing. This is done simply by giving a command that consists of nothing but whitespace. For example:</p>
<p>target: ;</p>
<p>defines an empty command string for <tt>`target'</tt>. You could also use a line beginning with a tab character to define an empty command string, but this would be confusing because such a line looks empty.</p>
<p><a id="IDX413" name="IDX413"></a>You may be wondering why you would want to define a command string that does nothing. The only reason this is useful is to prevent a target from getting implicit commands (from implicit rules or the <span style="font-family: courier, mono;">.DEFAULT</span> special target; see section <a href="#SEC93">Using Implicit Rules</a>and see section <a href="#SEC105">Defining Last-Resort Default Rules</a>).</p>
<p>You may be inclined to define empty command strings for targets that are not actual files, but only exist so that their prerequisites can be remade. However, this is not the best way to do that, because the prerequisites may not be remade properly if the target file actually does exist. See section <a href="#SEC33">Phony Targets</a>, for a better way to do this.</p>
<h2 class="subhead"><a id="SEC57" href="#TOC57" name="SEC57">How to Use Variables</a></h2>
<p><a id="IDX414" name="IDX414"></a><a id="IDX415" name="IDX415"></a><a id="IDX416" name="IDX416"></a><a id="IDX417" name="IDX417"></a> </p>
<p>A <strong>variable</strong> is a name defined in a makefile to represent a string of text, called the variable's <strong>value</strong>. These values are substituted by explicit request into targets, prerequisites, commands, and other parts of the makefile. (In some other versions of <span style="font-family: courier, mono;">make</span>, variables are called <strong>macros</strong>.) <a id="IDX418" name="IDX418"></a></p>
<p>Variables and functions in all parts of a makefile are expanded when read, except for the shell commands in rules, the right-hand sides of variable definitions using <samp>`='</samp>, and the bodies of variable definitions using the <span style="font-family: courier, mono;">define</span> directive.</p>
<p>Variables can represent lists of file names, options to pass to compilers, programs to run, directories to look in for source files, directories to write output in, or anything else you can imagine.</p>
<p>A variable name may be any sequence of characters not containing <samp>`:'</samp>, <samp>`#'</samp>, <samp>`='</samp>, or leading or trailing whitespace. However, variable names containing characters other than letters, numbers, and underscores should be avoided, as they may be given special meanings in the future, and with some shells they cannot be passed through the environment to a sub-<span style="font-family: courier, mono;">make</span> (see section <a href="#SEC52">Communicating Variables to a Sub-<span style="font-family: courier, mono;">make</span></a>).</p>
<p>Variable names are case-sensitive. The names <samp>`foo'</samp>, <samp>`FOO'</samp>, and <samp>`Foo'</samp> all refer to different variables.</p>
<p>It is traditional to use upper case letters in variable names, but we recommend using lower case letters for variable names that serve internal purposes in the makefile, and reserving upper case for parameters that control implicit rules or for parameters that the user should override with command options (see section <a href="#SEC90">Overriding Variables</a>).</p>
<p>A few variables have names that are a single punctuation character or just a few characters. These are the <strong>automatic variables</strong>, and they have particular specialized uses. See section <a href="#SEC101">Automatic Variables</a>.</p>
<h2 class="subhead"><a id="SEC58" href="#TOC58" name="SEC58">Basics of Variable References</a></h2>
<p><a id="IDX419" name="IDX419"></a><a id="IDX420" name="IDX420"></a><a id="IDX421" name="IDX421"></a><a id="IDX422" name="IDX422"></a> </p>
<p>To substitute a variable's value, write a dollar sign followed by the name of the variable in parentheses or braces: either <samp>`$(foo)'</samp> or <samp>`${foo}'</samp> is a valid reference to the variable <span style="font-family: courier, mono;">foo</span>. This special significance of <samp>`$'</samp> is why you must write <samp>`$$'</samp> to have the effect of a single dollar sign in a file name or command.</p>
<p>Variable references can be used in any context: targets, prerequisites, commands, most directives, and new variable values. Here is an example of a common case, where a variable holds the names of all the object files in a program:</p>
<p>objects = program.o foo.o utils.oprogram : $(objects) cc -o program $(objects)$(objects) : defs.h</p>
<p>Variable references work by strict textual substitution. Thus, the rule</p>
<p>foo = cprog.o : prog.$(foo) $(foo)$(foo) -$(foo) prog.$(foo)</p>
<p>could be used to compile a C program <tt>`prog.c'</tt>. Since spaces before the variable value are ignored in variable assignments, the value of <span style="font-family: courier, mono;">foo</span> is precisely <samp>`c'</samp>. (Don't actually write your makefiles this way!)</p>
<p>A dollar sign followed by a character other than a dollar sign, open-parenthesis or open-brace treats that single character as the variable name. Thus, you could reference the variable <span style="font-family: courier, mono;">x</span> with <samp>`$x'</samp>. However, this practice is strongly discouraged, except in the case of the automatic variables (see section <a href="#SEC101">Automatic Variables</a>).</p>
<h2 class="subhead"><a id="SEC59" href="#TOC59" name="SEC59">The Two Flavors of Variables</a></h2>
<p><a id="IDX423" name="IDX423"></a><a id="IDX424" name="IDX424"></a><a id="IDX425" name="IDX425"></a><a id="IDX426" name="IDX426"></a><a id="IDX427" name="IDX427"></a> </p>
<p>There are two ways that a variable in GNU <span style="font-family: courier, mono;">make</span> can have a value; we call them the two <strong>flavors</strong> of variables. The two flavors are distinguished in how they are defined and in what they do when expanded.</p>
<p><a id="IDX428" name="IDX428"></a>The first flavor of variable is a <strong>recursively expanded</strong> variable. Variables of this sort are defined by lines using <samp>`='</samp> (see section <a href="#SEC64">Setting Variables</a>) or by the <span style="font-family: courier, mono;">define</span> directive (see section <a href="#SEC67">Defining Variables Verbatim</a>). The value you specify is installed verbatim; if it contains references to other variables, these references are expanded whenever this variable is substituted (in the course of expanding some other string). When this happens, it is called <strong>recursive expansion</strong>.</p>
<p>For example,</p>
<p>foo = $(bar)bar = $(ugh)ugh = Huh?all:;echo $(foo)</p>
<p>will echo <samp>`Huh?'</samp>: <samp>`$(foo)'</samp> expands to <samp>`$(bar)'</samp> which expands to <samp>`$(ugh)'</samp> which finally expands to <samp>`Huh?'</samp>.</p>
<p>This flavor of variable is the only sort supported by other versions of <span style="font-family: courier, mono;">make</span>. It has its advantages and its disadvantages. An advantage (most would say) is that:</p>
<p>CFLAGS = $(include_dirs) -Oinclude_dirs = -Ifoo -Ibar</p>
<p>will do what was intended: when <samp>`CFLAGS'</samp> is expanded in a command, it will expand to <samp>`-Ifoo -Ibar -O'</samp>. A major disadvantage is that you cannot append something on the end of a variable, as in</p>
<p>CFLAGS = $(CFLAGS) -O</p>
<p>because it will cause an infinite loop in the variable expansion. (Actually <span style="font-family: courier, mono;">make</span> detects the infinite loop and reports an error.) <a id="IDX429" name="IDX429"></a><a id="IDX430" name="IDX430"></a></p>
<p>Another disadvantage is that any functions (see section <a href="#SEC75">Functions for Transforming Text</a>) referenced in the definition will be executed every time the variable is expanded. This makes <span style="font-family: courier, mono;">make</span> run slower; worse, it causes the <span style="font-family: courier, mono;">wildcard</span> and <span style="font-family: courier, mono;">shell</span> functions to give unpredictable results because you cannot easily control when they are called, or even how many times.</p>
<p>To avoid all the problems and inconveniences of recursively expanded variables, there is another flavor: simply expanded variables.</p>
<p><a id="IDX431" name="IDX431"></a><a id="IDX432" name="IDX432"></a><a id="IDX433" name="IDX433"></a><strong>Simply expanded variables</strong> are defined by lines using <samp>`:='</samp> (see section <a href="#SEC64">Setting Variables</a>). The value of a simply expanded variable is scanned once and for all, expanding any references to other variables and functions, when the variable is defined. The actual value of the simply expanded variable is the result of expanding the text that you write. It does not contain any references to other variables; it contains their values <em>as of the time this variable was defined</em>. Therefore,</p>
<p>x := fooy := $(x) barx := later</p>
<p>is equivalent to</p>
<p>y := foo barx := later</p>
<p>When a simply expanded variable is referenced, its value is substituted verbatim.</p>
<p>Here is a somewhat more complicated example, illustrating the use of <samp>`:='</samp> in conjunction with the <span style="font-family: courier, mono;">shell</span> function. (See section <a href="#SEC83">The <span style="font-family: courier, mono;">shell</span> Function</a>.) This example also shows use of the variable <span style="font-family: courier, mono;">MAKELEVEL</span>, which is changed when it is passed down from level to level. (See section <a href="#SEC52">Communicating Variables to a Sub-<span style="font-family: courier, mono;">make</span></a>, for information about <span style="font-family: courier, mono;">MAKELEVEL</span>.)</p>
<p><a id="IDX434" name="IDX434"></a><a id="IDX435" name="IDX435"></a> </p>
<p>ifeq (0,${MAKELEVEL})cur-dir := $(shell pwd)whoami := $(shell whoami) host-type := $(shell arch) MAKE := ${MAKE} host-type=${host-type} whoami=${whoami}endif</p>
<p>An advantage of this use of <samp>`:='</samp> is that a typical `descend into a directory' command then looks like this:</p>
<p>${subdirs}: ${MAKE} cur-dir=${cur-dir}/$@ -C $@ all</p>
<p>Simply expanded variables generally make complicated makefile programming more predictable because they work like variables in most programming languages. They allow you to redefine a variable using its own value (or its value processed in some way by one of the expansion functions) and to use the expansion functions much more efficiently (see section <a href="#SEC75">Functions for Transforming Text</a>).</p>
<p><a id="IDX436" name="IDX436"></a><a id="IDX437" name="IDX437"></a><a id="IDX438" name="IDX438"></a>You can also use them to introduce controlled leading whitespace into variable values. Leading whitespace characters are discarded from your input before substitution of variable references and function calls; this means you can include leading spaces in a variable value by protecting them with variable references, like this:</p>
<p>nullstring :=space := $(nullstring) # end of the line</p>
<p>Here the value of the variable <span style="font-family: courier, mono;">space</span> is precisely one space. The comment <samp>`# end of the line'</samp> is included here just for clarity. Since trailing space characters are <em>not</em> stripped from variable values, just a space at the end of the line would have the same effect (but be rather hard to read). If you put whitespace at the end of a variable value, it is a good idea to put a comment like that at the end of the line to make your intent clear. Conversely, if you do <em>not</em> want any whitespace characters at the end of your variable value, you must remember not to put a random comment on the end of the line after some whitespace, such as this:</p>
<p>dir := /foo/bar # directory to put the frobs in</p>
<p>Here the value of the variable <span style="font-family: courier, mono;">dir</span> is <samp>`/foo/bar '</samp> (with four trailing spaces), which was probably not the intention. (Imagine something like <samp>`$(dir)/file'</samp> with this definition!)</p>
<p><a id="IDX439" name="IDX439"></a><a id="IDX440" name="IDX440"></a><a id="IDX441" name="IDX441"></a>There is another assignment operator for variables, <samp>`?='</samp>. This is called a conditional variable assignment operator, because it only has an effect if the variable is not yet defined. This statement:</p>
<p>FOO ?= bar</p>
<p>is exactly equivalent to this (see section <a href="#SEC82">The <span style="font-family: courier, mono;">origin</span> Function</a>):</p>
<p>ifeq ($(origin FOO), undefined) FOO = barendif</p>
<p>Note that a variable set to an empty value is still defined, so <samp>`?='</samp> will not set that variable.</p>
<h2 class="subhead"><a id="SEC60" href="#TOC60" name="SEC60">Advanced Features for Reference to Variables</a></h2>
<p><a id="IDX442" name="IDX442"></a> </p>
<p>This section describes some advanced features you can use to reference variables in more flexible ways.</p>
<h3 class="subsubhead"><a id="SEC61" href="#TOC61" name="SEC61">Substitution References</a></h3>
<p><a id="IDX443" name="IDX443"></a><a id="IDX444" name="IDX444"></a><a id="IDX445" name="IDX445"></a><a id="IDX446" name="IDX446"></a> </p>
<p><a id="IDX447" name="IDX447"></a><a id="IDX448" name="IDX448"></a>A <strong>substitution reference</strong> substitutes the value of a variable with alterations that you specify. It has the form <samp>`$(<var>var</var>:<var>a</var>=<var>b</var>)'</samp> (or <samp>`${<var>var</var>:<var>a</var>=<var>b</var>}'</samp>) and its meaning is to take the value of the variable <var>var</var>, replace every <var>a</var> at the end of a word with <var>b</var> in that value, and substitute the resulting string.</p>
<p>When we say "at the end of a word", we mean that <var>a</var> must appear either followed by whitespace or at the end of the value in order to be replaced; other occurrences of <var>a</var> in the value are unaltered. For example:</p>
<p>foo := a.o b.o c.obar := $(foo:.o=.c)</p>
<p>sets <samp>`bar'</samp> to <samp>`a.c b.c c.c'</samp>. See section <a href="#SEC64">Setting Variables</a>.</p>
<p>A substitution reference is actually an abbreviation for use of the <span style="font-family: courier, mono;">patsubst</span> expansion function (see section <a href="#SEC77">Functions for String Substitution and Analysis</a>). We provide substitution references as well as <span style="font-family: courier, mono;">patsubst</span> for compatibility with other implementations of <span style="font-family: courier, mono;">make</span>.</p>
<p><a id="IDX449" name="IDX449"></a>Another type of substitution reference lets you use the full power of the <span style="font-family: courier, mono;">patsubst</span> function. It has the same form <samp>`$(<var>var</var>:<var>a</var>=<var>b</var>)'</samp> described above, except that now <var>a</var> must contain a single <samp>`%'</samp> character. This case is equivalent to <samp>`$(patsubst <var>a</var>,<var>b</var>,$(<var>var</var>))'</samp>. See section <a href="#SEC77">Functions for String Substitution and Analysis</a>, for a description of the <span style="font-family: courier, mono;">patsubst</span> function.</p>
<p>For example:foo := a.o b.o c.obar := $(foo:%.o=%.c)</p>
<p>sets <samp>`bar'</samp> to <samp>`a.c b.c c.c'</samp>.</p>
<h3 class="subsubhead"><a id="SEC62" href="#TOC62" name="SEC62">Computed Variable Names</a></h3>
<p><a id="IDX450" name="IDX450"></a><a id="IDX451" name="IDX451"></a><a id="IDX452" name="IDX452"></a><a id="IDX453" name="IDX453"></a><a id="IDX454" name="IDX454"></a><a id="IDX455" name="IDX455"></a><a id="IDX456" name="IDX456"></a> </p>
<p>Computed variable names are a complicated concept needed only for sophisticated makefile programming. For most purposes you need not consider them, except to know that making a variable with a dollar sign in its name might have strange results. However, if you are the type that wants to understand everything, or you are actually interested in what they do, read on.</p>
<p>Variables may be referenced inside the name of a variable. This is called a <strong>computed variable name</strong> or a <strong>nested variable reference</strong>. For example,</p>
<p>x = yy = za := $($(x))</p>
<p>defines <span style="font-family: courier, mono;">a</span> as <samp>`z'</samp>: the <samp>`$(x)'</samp> inside <samp>`$($(x))'</samp> expands to <samp>`y'</samp>, so <samp>`$($(x))'</samp> expands to <samp>`$(y)'</samp> which in turn expands to <samp>`z'</samp>. Here the name of the variable to reference is not stated explicitly; it is computed by expansion of <samp>`$(x)'</samp>. The reference <samp>`$(x)'</samp> here is nested within the outer variable reference.</p>
<p>The previous example shows two levels of nesting, but any number of levels is possible. For example, here are three levels:</p>
<p>x = yy = zz = ua := $($($(x)))</p>
<p>Here the innermost <samp>`$(x)'</samp> expands to <samp>`y'</samp>, so <samp>`$($(x))'</samp> expands to <samp>`$(y)'</samp> which in turn expands to <samp>`z'</samp>; now we have <samp>`$(z)'</samp>, which becomes <samp>`u'</samp>.</p>
<p>References to recursively-expanded variables within a variable name are reexpanded in the usual fashion. For example:</p>
<p>x = $(y)y = zz = Helloa := $($(x))</p>
<p>defines <span style="font-family: courier, mono;">a</span> as <samp>`Hello'</samp>: <samp>`$($(x))'</samp> becomes <samp>`$($(y))'</samp> which becomes <samp>`$(z)'</samp> which becomes <samp>`Hello'</samp>.</p>
<p>Nested variable references can also contain modified references and function invocations (see section <a href="#SEC75">Functions for Transforming Text</a>), just like any other reference. For example, using the <span style="font-family: courier, mono;">subst</span> function (see section <a href="#SEC77">Functions for String Substitution and Analysis</a>):</p>
<p>x = variable1variable2 := Helloy = $(subst 1,2,$(x))z = ya := $($($(z)))</p>
<p>eventually defines <span style="font-family: courier, mono;">a</span> as <samp>`Hello'</samp>. It is doubtful that anyone would ever want to write a nested reference as convoluted as this one, but it works: <samp>`$($($(z)))'</samp> expands to <samp>`$($(y))'</samp> which becomes <samp>`$($(subst 1,2,$(x)))'</samp>. This gets the value <samp>`variable1'</samp> from <span style="font-family: courier, mono;">x</span> and changes it by substitution to <samp>`variable2'</samp>, so that the entire string becomes <samp>`$(variable2)'</samp>, a simple variable reference whose value is <samp>`Hello'</samp>.</p>
<p>A computed variable name need not consist entirely of a single variable reference. It can contain several variable references, as well as some invariant text. For example,</p>
<p>a_dirs := dira dirb1_dirs := dir1 dir2a_files := filea fileb 1_files := file1 file2ifeq "$(use_a)" "yes"a1 := aelsea1 := 1endif ifeq "$(use_dirs)" "yes"df := dirselsedf := filesendifdirs := $($(a1)_$(df))</p>
<p>will give <span style="font-family: courier, mono;">dirs</span> the same value as <span style="font-family: courier, mono;">a_dirs</span>, <span style="font-family: courier, mono;">1_dirs</span>, <span style="font-family: courier, mono;">a_files</span> or <span style="font-family: courier, mono;">1_files</span> depending on the settings of <span style="font-family: courier, mono;">use_a</span> and <span style="font-family: courier, mono;">use_dirs</span>.</p>
<p>Computed variable names can also be used in substitution references:</p>
<p>a_objects := a.o b.o c.o1_objects := 1.o 2.o 3.o sources := $($(a1)_objects:.o=.c)</p>
<p>defines <span style="font-family: courier, mono;">sources</span> as either <samp>`a.c b.c c.c'</samp> or <samp>`1.c 2.c 3.c'</samp>, depending on the value of <span style="font-family: courier, mono;">a1</span>.</p>
<p>The only restriction on this sort of use of nested variable references is that they cannot specify part of the name of a function to be called. This is because the test for a recognized function name is done before the expansion of nested references. For example,</p>
<p>ifdef do_sortfunc := sortelsefunc := stripendifbar := a d b g q c foo := $($(func) $(bar))</p>
<p>attempts to give <samp>`foo'</samp> the value of the variable <samp>`sort a d b g q c'</samp> or <samp>`strip a d b g q c'</samp>, rather than giving <samp>`a d b g q c'</samp> as the argument to either the <span style="font-family: courier, mono;">sort</span> or the <span style="font-family: courier, mono;">strip</span> function. This restriction could be removed in the future if that change is shown to be a good idea.</p>
<p>You can also use computed variable names in the left-hand side of a variable assignment, or in a <span style="font-family: courier, mono;">define</span> directive, as in:</p>
<p>dir = foo$(dir)_sources := $(wildcard $(dir)/*.c)define $(dir)_print lpr $($(dir)_sources)endef</p>
<p>This example defines the variables <samp>`dir'</samp>, <samp>`foo_sources'</samp>, and <samp>`foo_print'</samp>.</p>
<p>Note that <strong>nested variable references</strong> are quite different from <strong>recursively expanded variables</strong> (see section <a href="#SEC59">The Two Flavors of Variables</a>), though both are used together in complex ways when doing makefile programming.</p>
<h2 class="subhead"><a id="SEC63" href="#TOC63" name="SEC63">How Variables Get Their Values</a></h2>
<p><a id="IDX457" name="IDX457"></a><a id="IDX458" name="IDX458"></a> </p>
<p>Variables can get values in several different ways:</p>
<ul>
<li>You can specify an overriding value when you run <span style="font-family: courier, mono;">make</span>. See section <a href="#SEC90">Overriding Variables</a>.</li>
<li>You can specify a value in the makefile, either with an assignment (see section <a href="#SEC64">Setting Variables</a>) or with a verbatim definition (see section <a href="#SEC67">Defining Variables Verbatim</a>).</li>
<li>Variables in the environment become <span style="font-family: courier, mono;">make</span> variables. See section <a href="#SEC68">Variables from the Environment</a>.</li>
<li>Several <strong>automatic</strong> variables are given new values for each rule. Each of these has a single conventional use. See section <a href="#SEC101">Automatic Variables</a>.</li>
<li>Several variables have constant initial values. See section <a href="#SEC96">Variables Used by Implicit Rules</a>.</li>
</ul>
<h2 class="subhead"><a id="SEC64" href="#TOC64" name="SEC64">Setting Variables</a></h2>
<p><a id="IDX459" name="IDX459"></a><a id="IDX460" name="IDX460"></a><a id="IDX461" name="IDX461"></a><a id="IDX462" name="IDX462"></a><a id="IDX463" name="IDX463"></a> </p>
<p>To set a variable from the makefile, write a line starting with the variable name followed by <samp>`='</samp> or <samp>`:='</samp>. Whatever follows the <samp>`='</samp> or <samp>`:='</samp> on the line becomes the value. For example,</p>
<p>objects = main.o foo.o bar.o utils.o</p>
<p>defines a variable named <span style="font-family: courier, mono;">objects</span>. Whitespace around the variable name and immediately after the <samp>`='</samp> is ignored.</p>
<p>Variables defined with <samp>`='</samp> are <strong>recursively expanded</strong> variables. Variables defined with <samp>`:='</samp> are <strong>simply expanded</strong> variables; these definitions can contain variable references which will be expanded before the definition is made. See section <a href="#SEC59">The Two Flavors of Variables</a>.</p>
<p>The variable name may contain function and variable references, which are expanded when the line is read to find the actual variable name to use.</p>
<p>There is no limit on the length of the value of a variable except the amount of swapping space on the computer. When a variable definition is long, it is a good idea to break it into several lines by inserting backslash-newline at convenient places in the definition. This will not affect the functioning of <span style="font-family: courier, mono;">make</span>, but it will make the makefile easier to read.</p>
<p>Most variable names are considered to have the empty string as a value if you have never set them. Several variables have built-in initial values that are not empty, but you can set them in the usual ways (see section <a href="#SEC96">Variables Used by Implicit Rules</a>). Several special variables are set automatically to a new value for each rule; these are called the <strong>automatic</strong> variables (see section <a href="#SEC101">Automatic Variables</a>).</p>
<p>If you'd like a variable to be set to a value only if it's not already set, then you can use the shorthand operator <samp>`?='</samp> instead of <samp>`='</samp>. These two settings of the variable <samp>`FOO'</samp> are identical (see section <a href="#SEC82">The <span style="font-family: courier, mono;">origin</span> Function</a>):</p>
<p>FOO ?= bar</p>
<p>and</p>
<p>ifeq ($(origin FOO), undefined)FOO = barendif</p>
<h2 class="subhead"><a id="SEC65" href="#TOC65" name="SEC65">Appending More Text to Variables</a></h2>
<p><a id="IDX464" name="IDX464"></a><a id="IDX465" name="IDX465"></a><a id="IDX466" name="IDX466"></a> </p>
<p>Often it is useful to add more text to the value of a variable already defined. You do this with a line containing <samp>`+='</samp>, like this:</p>
<p>objects += another.o</p>
<p>This takes the value of the variable <span style="font-family: courier, mono;">objects</span>, and adds the text <samp>`another.o'</samp> to it (preceded by a single space). Thus:</p>
<p>objects = main.o foo.o bar.o utils.oobjects += another.o</p>
<p>sets <span style="font-family: courier, mono;">objects</span> to <samp>`main.o foo.o bar.o utils.o another.o'</samp>.</p>
<p>Using <samp>`+='</samp> is similar to:</p>
<p>objects = main.o foo.o bar.o utils.oobjects := $(objects) another.o</p>
<p>but differs in ways that become important when you use more complex values.</p>
<p>When the variable in question has not been defined before, <samp>`+='</samp> acts just like normal <samp>`='</samp>: it defines a recursively-expanded variable. However, when there <em>is</em> a previous definition, exactly what <samp>`+='</samp> does depends on what flavor of variable you defined originally. See section <a href="#SEC59">The Two Flavors of Variables</a>, for an explanation of the two flavors of variables.</p>
<p>When you add to a variable's value with <samp>`+='</samp>, <span style="font-family: courier, mono;">make</span> acts essentially as if you had included the extra text in the initial definition of the variable. If you defined it first with <samp>`:='</samp>, making it a simply-expanded variable, <samp>`+='</samp> adds to that simply-expanded definition, and expands the new text before appending it to the old value just as <samp>`:='</samp> does (see section <a href="#SEC64">Setting Variables</a>, for a full explanation of <samp>`:='</samp>). In fact,</p>
<p>variable := valuevariable += more</p>
<p>is exactly equivalent to:</p>
<p> </p>
<p>variable := valuevariable := $(variable) more</p>
<p>On the other hand, when you use <samp>`+='</samp> with a variable that you defined first to be recursively-expanded using plain <samp>`='</samp>, <span style="font-family: courier, mono;">make</span> does something a bit different. Recall that when you define a recursively-expanded variable, <span style="font-family: courier, mono;">make</span> does not expand the value you set for variable and function references immediately. Instead it stores the text verbatim, and saves these variable and function references to be expanded later, when you refer to the new variable (see section <a href="#SEC59">The Two Flavors of Variables</a>). When you use <samp>`+='</samp> on a recursively-expanded variable, it is this unexpanded text to which <span style="font-family: courier, mono;">make</span> appends the new text you specify.</p>
<p>variable = valuevariable += more</p>
<p>is roughly equivalent to:</p>
<p>temp = valuevariable = $(temp) more</p>
<p>except that of course it never defines a variable called <span style="font-family: courier, mono;">temp</span>. The importance of this comes when the variable's old value contains variable references. Take this common example:</p>
<p>CFLAGS = $(includes) -O...CFLAGS += -pg # enable profiling</p>
<p>The first line defines the <span style="font-family: courier, mono;">CFLAGS</span> variable with a reference to another variable, <span style="font-family: courier, mono;">includes</span>. (<span style="font-family: courier, mono;">CFLAGS</span> is used by the rules for C compilation; see section <a href="#SEC95">Catalogue of Implicit Rules</a>.) Using <samp>`='</samp> for the definition makes <span style="font-family: courier, mono;">CFLAGS</span> a recursively-expanded variable, meaning <samp>`$(includes) -O'</samp> is <em>not</em> expanded when <span style="font-family: courier, mono;">make</span> processes the definition of <span style="font-family: courier, mono;">CFLAGS</span>. Thus, <span style="font-family: courier, mono;">includes</span> need not be defined yet for its value to take effect. It only has to be defined before any reference to <span style="font-family: courier, mono;">CFLAGS</span>. If we tried to append to the value of <span style="font-family: courier, mono;">CFLAGS</span> without using <samp>`+='</samp>, we might do it like this:</p>
<p>CFLAGS := $(CFLAGS) -pg # enable profiling</p>
<p>This is pretty close, but not quite what we want. Using <samp>`:='</samp> redefines <span style="font-family: courier, mono;">CFLAGS</span> as a simply-expanded variable; this means <span style="font-family: courier, mono;">make</span> expands the text <samp>`$(CFLAGS) -pg'</samp> before setting the variable. If <span style="font-family: courier, mono;">includes</span> is not yet defined, we get <samp>` -O -pg'</samp>, and a later definition of <span style="font-family: courier, mono;">includes</span> will have no effect. Conversely, by using <samp>`+='</samp> we set <span style="font-family: courier, mono;">CFLAGS</span> to the <em>unexpanded</em> value <samp>`$(includes) -O -pg'</samp>. Thus we preserve the reference to <span style="font-family: courier, mono;">includes</span>, so if that variable gets defined at any later point, a reference like <samp>`$(CFLAGS)'</samp> still uses its value.</p>
<h2 class="subhead"><a id="SEC66" href="#TOC66" name="SEC66">The <span style="font-family: courier, mono;">override</span> Directive</a></h2>
<p><a id="IDX467" name="IDX467"></a><a id="IDX468" name="IDX468"></a><a id="IDX469" name="IDX469"></a> </p>
<p>If a variable has been set with a command argument (see section <a href="#SEC90">Overriding Variables</a>), then ordinary assignments in the makefile are ignored. If you want to set the variable in the makefile even though it was set with a command argument, you can use an <span style="font-family: courier, mono;">override</span> directive, which is a line that looks like this:</p>
<p>override <var>variable</var> = <var>value</var></p>
<p>or</p>
<p>override <var>variable</var> := <var>value</var></p>
<p>To append more text to a variable defined on the command line, use:</p>
<p>override <var>variable</var> += <var>more text</var></p>
<p>See section <a href="#SEC65">Appending More Text to Variables</a>.</p>
<p>The <span style="font-family: courier, mono;">override</span> directive was not invented for escalation in the war between makefiles and command arguments. It was invented so you can alter and add to values that the user specifies with command arguments.</p>
<p>For example, suppose you always want the <samp>`-g'</samp> switch when you run the C compiler, but you would like to allow the user to specify the other switches with a command argument just as usual. You could use this <span style="font-family: courier, mono;">override</span> directive:</p>
<p>override CFLAGS += -g</p>
<p>You can also use <span style="font-family: courier, mono;">override</span> directives with <span style="font-family: courier, mono;">define</span> directives. This is done as you might expect:</p>
<p>override define foobarendef</p>
<p>See the next section for information about <span style="font-family: courier, mono;">define</span>.</p>
<h2 class="subhead"><a id="SEC67" href="#TOC67" name="SEC67">Defining Variables Verbatim</a></h2>
<p><a id="IDX470" name="IDX470"></a><a id="IDX471" name="IDX471"></a><a id="IDX472" name="IDX472"></a><a id="IDX473" name="IDX473"></a><a id="IDX474" name="IDX474"></a> </p>
<p>Another way to set the value of a variable is to use the <span style="font-family: courier, mono;">define</span> directive. This directive has an unusual syntax which allows newline characters to be included in the value, which is convenient for defining canned sequences of commands (see section <a href="#SEC55">Defining Canned Command Sequences</a>).</p>
<p>The <span style="font-family: courier, mono;">define</span> directive is followed on the same line by the name of the variable and nothing more. The value to give the variable appears on the following lines. The end of the value is marked by a line containing just the word <span style="font-family: courier, mono;">endef</span>. Aside from this difference in syntax, <span style="font-family: courier, mono;">define</span> works just like <samp>`='</samp>: it creates a recursively-expanded variable (see section <a href="#SEC59">The Two Flavors of Variables</a>). The variable name may contain function and variable references, which are expanded when the directive is read to find the actual variable name to use.</p>
<p>define two-linesecho fooecho $(bar)endef</p>
<p>The value in an ordinary assignment cannot contain a newline; but the newlines that separate the lines of the value in a <span style="font-family: courier, mono;">define</span> become part of the variable's value (except for the final newline which precedes the <span style="font-family: courier, mono;">endef</span> and is not considered part of the value).</p>
<p>The previous example is functionally equivalent to this:</p>
<p>two-lines = echo foo; echo $(bar)</p>
<p>since two commands separated by semicolon behave much like two separate shell commands. However, note that using two separate lines means <span style="font-family: courier, mono;">make</span> will invoke the shell twice, running an independent subshell for each line. See section <a href="#SEC46">Command Execution</a>.</p>
<p>If you want variable definitions made with <span style="font-family: courier, mono;">define</span> to take precedence over command-line variable definitions, you can use the <span style="font-family: courier, mono;">override</span> directive together with <span style="font-family: courier, mono;">define</span>:</p>
<p>override define two-linesfoo$(bar)endef</p>
<p>See section <a href="#SEC66">The <span style="font-family: courier, mono;">override</span> Directive</a>.</p>
<h2 class="subhead"><a id="SEC68" href="#TOC68" name="SEC68">Variables from the Environment</a></h2>
<p><a id="IDX475" name="IDX475"></a><a id="IDX476" name="IDX476"></a>Variables in <span style="font-family: courier, mono;">make</span> can come from the environment in which <span style="font-family: courier, mono;">make</span> is run. Every environment variable that <span style="font-family: courier, mono;">make</span> sees when it starts up is transformed into a <span style="font-family: courier, mono;">make</span> variable with the same name and value. But an explicit assignment in the makefile, or with a command argument, overrides the environment. (If the <samp>`-e'</samp> flag is specified, then values from the environment override assignments in the makefile. See section <a href="#SEC92">Summary of Options</a>. But this is not recommended practice.)</p>
<p>Thus, by setting the variable <span style="font-family: courier, mono;">CFLAGS</span> in your environment, you can cause all C compilations in most makefiles to use the compiler switches you prefer. This is safe for variables with standard or conventional meanings because you know that no makefile will use them for other things. (But this is not totally reliable; some makefiles set <span style="font-family: courier, mono;">CFLAGS</span> explicitly and therefore are not affected by the value in the environment.)</p>
<p>When <span style="font-family: courier, mono;">make</span> is invoked recursively, variables defined in the outer invocation can be passed to inner invocations through the environment (see section <a href="#SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>). By default, only variables that came from the environment or the command line are passed to recursive invocations. You can use the <span style="font-family: courier, mono;">export</span> directive to pass other variables. See section <a href="#SEC52">Communicating Variables to a Sub-<span style="font-family: courier, mono;">make</span></a>, for full details.</p>
<p>Other use of variables from the environment is not recommended. It is not wise for makefiles to depend for their functioning on environment variables set up outside their control, since this would cause different users to get different results from the same makefile. This is against the whole purpose of most makefiles.</p>
<p>Such problems would be especially likely with the variable <span style="font-family: courier, mono;">SHELL</span>, which is normally present in the environment to specify the user's choice of interactive shell. It would be very undesirable for this choice to affect <span style="font-family: courier, mono;">make</span>. So <span style="font-family: courier, mono;">make</span> ignores the environment value of <span style="font-family: courier, mono;">SHELL</span> (except on MS-DOS and MS-Windows, where <span style="font-family: courier, mono;">SHELL</span> is usually not set. See section <a href="#SEC46">Command Execution</a>.)</p>
<h2 class="subhead"><a id="SEC69" href="#TOC69" name="SEC69">Target-specific Variable Values</a></h2>
<p><a id="IDX477" name="IDX477"></a><a id="IDX478" name="IDX478"></a></p>
<p>Variable values in <span style="font-family: courier, mono;">make</span> are usually global; that is, they are the same regardless of where they are evaluated (unless they're reset, of course). One exception to that is automatic variables (see section <a href="#SEC101">Automatic Variables</a>).</p>
<p>The other exception is <strong>target-specific variable values</strong>. This feature allows you to define different values for the same variable, based on the target that <span style="font-family: courier, mono;">make</span> is currently building. As with automatic variables, these values are only available within the context of a target's command script (and in other target-specific assignments).</p>
<p>Set a target-specific variable value like this:</p>
<p><var>target</var> ... : <var>variable-assignment</var></p>
<p>or like this:</p>
<p><var>target</var> ... : override <var>variable-assignment</var></p>
<p>Multiple <var>target</var> values create a target-specific variable value for each member of the target list individually.</p>
<p>The <var>variable-assignment</var> can be any valid form of assignment; recursive (<samp>`='</samp>), static (<samp>`:='</samp>), appending (<samp>`+='</samp>), or conditional (<samp>`?='</samp>). All variables that appear within the <var>variable-assignment</var> are evaluated within the context of the target: thus, any previously-defined target-specific variable values will be in effect. Note that this variable is actually distinct from any "global" value: the two variables do not have to have the same flavor (recursive vs. static).</p>
<p>Target-specific variables have the same priority as any other makefile variable. Variables provided on the command-line (and in the environment if the <samp>`-e'</samp> option is in force) will take precedence. Specifying the <span style="font-family: courier, mono;">override</span> directive will allow the target-specific variable value to be preferred.</p>
<p>There is one more special feature of target-specific variables: when you define a target-specific variable, that variable value is also in effect for all prerequisites of this target (unless those prerequisites override it with their own target-specific variable value). So, for example, a statement like this:</p>
<p>prog : CFLAGS = -gprog : prog.o foo.o bar.o</p>
<p>will set <span style="font-family: courier, mono;">CFLAGS</span> to <samp>`-g'</samp> in the command script for <tt>`prog'</tt>, but it will also set <span style="font-family: courier, mono;">CFLAGS</span> to <samp>`-g'</samp> in the command scripts that create <tt>`prog.o'</tt>, <tt>`foo.o'</tt>, and <tt>`bar.o'</tt>, and any command scripts which create their prerequisites.</p>
<h2 class="subhead"><a id="SEC70" href="#TOC70" name="SEC70">Pattern-specific Variable Values</a></h2>
<p><a id="IDX479" name="IDX479"></a><a id="IDX480" name="IDX480"></a> </p>
<p>In addition to target-specific variable values (see section <a href="#SEC69">Target-specific Variable Values</a>), GNU <span style="font-family: courier, mono;">make</span> supports pattern-specific variable values. In this form, a variable is defined for any target that matches the pattern specified. Variables defined in this way are searched after any target-specific variables defined explicitly for that target, and before target-specific variables defined for the parent target.</p>
<p>Set a pattern-specific variable value like this:</p>
<p><var>pattern</var> ... : <var>variable-assignment</var></p>
<p>or like this:</p>
<p><var>pattern</var> ... : override <var>variable-assignment</var></p>
<p>where <var>pattern</var> is a %-pattern. As with target-specific variable values, multiple <var>pattern</var> values create a pattern-specific variable value for each pattern individually. The <var>variable-assignment</var> can be any valid form of assignment. Any command-line variable setting will take precedence, unless <span style="font-family: courier, mono;">override</span> is specified.</p>
<p>For example:</p>
<p>%.o : CFLAGS = -O</p>
<p>will assign <span style="font-family: courier, mono;">CFLAGS</span> the value of <samp>`-O'</samp> for all targets matching the pattern <span style="font-family: courier, mono;">%.o</span>.</p>
<h2 class="subhead"><a id="SEC71" href="#TOC71" name="SEC71">Conditional Parts of Makefiles</a></h2>
<p><a id="IDX481" name="IDX481"></a>A <strong>conditional</strong> causes part of a makefile to be obeyed or ignored depending on the values of variables. Conditionals can compare the value of one variable to another, or the value of a variable to a constant string. Conditionals control what <span style="font-family: courier, mono;">make</span> actually "sees" in the makefile, so they <em>cannot</em> be used to control shell commands at the time of execution.</p>
<h2 class="subhead"><a id="SEC72" href="#TOC72" name="SEC72">Example of a Conditional</a></h2>
<p>The following example of a conditional tells <span style="font-family: courier, mono;">make</span> to use one set of libraries if the <span style="font-family: courier, mono;">CC</span> variable is <samp>`gcc'</samp>, and a different set of libraries otherwise. It works by controlling which of two command lines will be used as the command for a rule. The result is that <samp>`CC=gcc'</samp> as an argument to <span style="font-family: courier, mono;">make</span> changes not only which compiler is used but also which libraries are linked.</p>
<p>libs_for_gcc = -lgnunormal_libs =foo: $(objects)ifeq ($(CC),gcc) $(CC) -o foo $(objects) $(libs_for_gcc)else $(CC) -o foo $(objects) $(normal_libs)endif</p>
<p>This conditional uses three directives: one <span style="font-family: courier, mono;">ifeq</span>, one <span style="font-family: courier, mono;">else</span> and one <span style="font-family: courier, mono;">endif</span>.</p>
<p>The <span style="font-family: courier, mono;">ifeq</span> directive begins the conditional, and specifies the condition. It contains two arguments, separated by a comma and surrounded by parentheses. Variable substitution is performed on both arguments and then they are compared. The lines of the makefile following the <span style="font-family: courier, mono;">ifeq</span> are obeyed if the two arguments match; otherwise they are ignored.</p>
<p>The <span style="font-family: courier, mono;">else</span> directive causes the following lines to be obeyed if the previous conditional failed. In the example above, this means that the second alternative linking command is used whenever the first alternative is not used. It is optional to have an <span style="font-family: courier, mono;">else</span> in a conditional.</p>
<p>The <span style="font-family: courier, mono;">endif</span> directive ends the conditional. Every conditional must end with an <span style="font-family: courier, mono;">endif</span>. Unconditional makefile text follows.</p>
<p>As this example illustrates, conditionals work at the textual level: the lines of the conditional are treated as part of the makefile, or ignored, according to the condition. This is why the larger syntactic units of the makefile, such as rules, may cross the beginning or the end of the conditional.</p>
<p>When the variable <span style="font-family: courier, mono;">CC</span> has the value <samp>`gcc'</samp>, the above example has this effect:</p>
<p>foo: $(objects) $(CC) -o foo $(objects) $(libs_for_gcc)</p>
<p>When the variable <span style="font-family: courier, mono;">CC</span> has any other value, the effect is this:</p>
<p>foo: $(objects) $(CC) -o foo $(objects) $(normal_libs)</p>
<p>Equivalent results can be obtained in another way by conditionalizing a variable assignment and then using the variable unconditionally:</p>
<p>libs_for_gcc = -lgnunormal_libs =ifeq ($(CC),gcc) libs=$(libs_for_gcc)else libs=$(normal_libs)endiffoo: $(objects) $(CC) -o foo $(objects) $(libs)</p>
<h2 class="subhead"><a id="SEC73" href="#TOC73" name="SEC73">Syntax of Conditionals</a></h2>
<p><a id="IDX482" name="IDX482"></a><a id="IDX483" name="IDX483"></a><a id="IDX484" name="IDX484"></a><a id="IDX485" name="IDX485"></a><a id="IDX486" name="IDX486"></a><a id="IDX487" name="IDX487"></a> </p>
<p>The syntax of a simple conditional with no <span style="font-family: courier, mono;">else</span> is as follows:</p>
<p><var>conditional-directive</var> <var>text-if-true</var>endif</p>
<p>The <var>text-if-true</var> may be any lines of text, to be considered as part of the makefile if the condition is true. If the condition is false, no text is used instead.</p>
<p>The syntax of a complex conditional is as follows:</p>
<p><var>conditional-directive</var> <var>text-if-true</var>else <var>text-if-false</var>endif</p>
<p>If the condition is true, <var>text-if-true</var> is used; otherwise, <var>text-if-false</var> is used instead. The <var>text-if-false</var> can be any number of lines of text.</p>
<p>The syntax of the <var>conditional-directive</var> is the same whether the conditional is simple or complex. There are four different directives that test different conditions. Here is a table of them:</p>
<dl compact>
<dt><span style="font-family: courier, mono;">ifeq (<var>arg1</var>, <var>arg2</var>)</span></dt>
<dt><span style="font-family: courier, mono;">ifeq '<var>arg1</var>' '<var>arg2</var>'</span></dt>
<dt><span style="font-family: courier, mono;">ifeq "<var>arg1</var>" "<var>arg2</var>"</span></dt>
<dt><span style="font-family: courier, mono;">ifeq "<var>arg1</var>" '<var>arg2</var>'</span></dt>
<dt><span style="font-family: courier, mono;">ifeq '<var>arg1</var>' "<var>arg2</var>"</span></dt>
<dd>Expand all variable references in <var>arg1</var> and <var>arg2</var> and compare them. If they are identical, the <var>text-if-true</var> is effective; otherwise, the <var>text-if-false</var>, if any, is effective. Often you want to test if a variable has a non-empty value. When the value results from complex expansions of variables and functions, expansions you would consider empty may actually contain whitespace characters and thus are not seen as empty. However, you can use the <span style="font-family: courier, mono;">strip</span> function (see section <a href="#SEC77">Functions for String Substitution and Analysis</a>) to avoid interpreting whitespace as a non-empty value. For example:
<p>ifeq ($(strip $(foo)),)<var>text-if-empty</var>endif</p>
will evaluate <var>text-if-empty</var> even if the expansion of <span style="font-family: courier, mono;">$(foo)</span> contains whitespace characters.</dd>
<dt><span style="font-family: courier, mono;">ifneq (<var>arg1</var>, <var>arg2</var>)</span></dt>
<dt><span style="font-family: courier, mono;">ifneq '<var>arg1</var>' '<var>arg2</var>'</span></dt>
<dt><span style="font-family: courier, mono;">ifneq "<var>arg1</var>" "<var>arg2</var>"</span></dt>
<dt><span style="font-family: courier, mono;">ifneq "<var>arg1</var>" '<var>arg2</var>'</span></dt>
<dt><span style="font-family: courier, mono;">ifneq '<var>arg1</var>' "<var>arg2</var>"</span></dt>
<dd>Expand all variable references in <var>arg1</var> and <var>arg2</var> and compare them. If they are different, the <var>text-if-true</var> is effective; otherwise, the <var>text-if-false</var>, if any, is effective.</dd>
<dt><span style="font-family: courier, mono;">ifdef <var>variable-name</var></span></dt>
<dd>If the variable <var>variable-name</var> has a non-empty value, the <var>text-if-true</var> is effective; otherwise, the <var>text-if-false</var>, if any, is effective. Variables that have never been defined have an empty value. Note that <span style="font-family: courier, mono;">ifdef</span> only tests whether a variable has a value. It does not expand the variable to see if that value is nonempty. Consequently, tests using <span style="font-family: courier, mono;">ifdef</span> return true for all definitions except those like <span style="font-family: courier, mono;">foo =</span>. To test for an empty value, use <span style="font-family: courier, mono;">ifeq ($(foo),)</span>. For example,
<p>bar =foo = $(bar)ifdef foofrobozz = yeselsefrobozz = noendif</p>
sets <samp>`frobozz'</samp> to <samp>`yes'</samp>, while:
<p>foo =ifdef foofrobozz = yeselsefrobozz = noendif</p>
sets <samp>`frobozz'</samp> to <samp>`no'</samp>.</dd>
<dt><span style="font-family: courier, mono;">ifndef <var>variable-name</var></span></dt>
<dd>If the variable <var>variable-name</var> has an empty value, the <var>text-if-true</var> is effective; otherwise, the <var>text-if-false</var>, if any, is effective.</dd>
</dl>
<p>Extra spaces are allowed and ignored at the beginning of the conditional directive line, but a tab is not allowed. (If the line begins with a tab, it will be considered a command for a rule.) Aside from this, extra spaces or tabs may be inserted with no effect anywhere except within the directive name or within an argument. A comment starting with <samp>`#'</samp> may appear at the end of the line.</p>
<p>The other two directives that play a part in a conditional are <span style="font-family: courier, mono;">else</span> and <span style="font-family: courier, mono;">endif</span>. Each of these directives is written as one word, with no arguments. Extra spaces are allowed and ignored at the beginning of the line, and spaces or tabs at the end. A comment starting with <samp>`#'</samp> may appear at the end of the line.</p>
<p>Conditionals affect which lines of the makefile <span style="font-family: courier, mono;">make</span> uses. If the condition is true, <span style="font-family: courier, mono;">make</span> reads the lines of the <var>text-if-true</var> as part of the makefile; if the condition is false, <span style="font-family: courier, mono;">make</span> ignores those lines completely. It follows that syntactic units of the makefile, such as rules, may safely be split across the beginning or the end of the conditional.</p>
<p><span style="font-family: courier, mono;">make</span> evaluates conditionals when it reads a makefile. Consequently, you cannot use automatic variables in the tests of conditionals because they are not defined until commands are run (see section <a href="#SEC101">Automatic Variables</a>).</p>
<p>To prevent intolerable confusion, it is not permitted to start a conditional in one makefile and end it in another. However, you may write an <span style="font-family: courier, mono;">include</span> directive within a conditional, provided you do not attempt to terminate the conditional inside the included file.</p>
<h2 class="subhead"><a id="SEC74" href="#TOC74" name="SEC74">Conditionals that Test Flags</a></h2>
<p>You can write a conditional that tests <span style="font-family: courier, mono;">make</span> command flags such as <samp>`-t'</samp> by using the variable <span style="font-family: courier, mono;">MAKEFLAGS</span> together with the <span style="font-family: courier, mono;">findstring</span> function (see section <a href="#SEC77">Functions for String Substitution and Analysis</a>). This is useful when <span style="font-family: courier, mono;">touch</span> is not enough to make a file appear up to date.</p>
<p>The <span style="font-family: courier, mono;">findstring</span> function determines whether one string appears as a substring of another. If you want to test for the <samp>`-t'</samp> flag, use <samp>`t'</samp> as the first string and the value of <span style="font-family: courier, mono;">MAKEFLAGS</span> as the other.</p>
<p>For example, here is how to arrange to use <samp>`ranlib -t'</samp> to finish marking an archive file up to date:</p>
<p>archive.a: ...ifneq (,$(findstring t,$(MAKEFLAGS))) +touch archive.a +ranlib -t archive.aelse ranlib archive.aendif</p>
<p>The <samp>`+'</samp> prefix marks those command lines as "recursive" so that they will be executed despite use of the <samp>`-t'</samp> flag. See section <a href="#SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>.</p>
<h2 class="subhead"><a id="SEC75" href="#TOC75" name="SEC75">Functions for Transforming Text</a></h2>
<p><a id="IDX488" name="IDX488"></a> </p>
<p><strong>Functions</strong> allow you to do text processing in the makefile to compute the files to operate on or the commands to use. You use a function in a <strong>function call</strong>, where you give the name of the function and some text (the <strong>arguments</strong>) for the function to operate on. The result of the function's processing is substituted into the makefile at the point of the call, just as a variable might be substituted.</p>
<h2 class="subhead"><a id="SEC76" href="#TOC76" name="SEC76">Function Call Syntax</a></h2>
<p><a id="IDX489" name="IDX489"></a><a id="IDX490" name="IDX490"></a><a id="IDX491" name="IDX491"></a><a id="IDX492" name="IDX492"></a> </p>
<p>A function call resembles a variable reference. It looks like this:</p>
<p>$(<var>function</var> <var>arguments</var>)</p>
<p>or like this:</p>
<p>${<var>function</var> <var>arguments</var>}</p>
<p>Here <var>function</var> is a function name; one of a short list of names that are part of <span style="font-family: courier, mono;">make</span>. You can also essentially create your own functions by using the <span style="font-family: courier, mono;">call</span> builtin function.</p>
<p>The <var>arguments</var> are the arguments of the function. They are separated from the function name by one or more spaces or tabs, and if there is more than one argument, then they are separated by commas. Such whitespace and commas are not part of an argument's value. The delimiters which you use to surround the function call, whether parentheses or braces, can appear in an argument only in matching pairs; the other kind of delimiters may appear singly. If the arguments themselves contain other function calls or variable references, it is wisest to use the same kind of delimiters for all the references; write <samp>`$(subst a,b,$(x))'</samp>, not <samp>`$(subst a,b,${x})'</samp>. This is because it is clearer, and because only one type of delimiter is matched to find the end of the reference.</p>
<p>The text written for each argument is processed by substitution of variables and function calls to produce the argument value, which is the text on which the function acts. The substitution is done in the order in which the arguments appear.</p>
<p>Commas and unmatched parentheses or braces cannot appear in the text of an argument as written; leading spaces cannot appear in the text of the first argument as written. These characters can be put into the argument value by variable substitution. First define variables <span style="font-family: courier, mono;">comma</span> and <span style="font-family: courier, mono;">space</span> whose values are isolated comma and space characters, then substitute these variables where such characters are wanted, like this:</p>
<p>comma:= ,empty:=space:= $(empty) $(empty)foo:= a b c bar:= $(subst $(space),$(comma),$(foo))# bar is now `a,b,c'.</p>
<p>Here the <span style="font-family: courier, mono;">subst</span> function replaces each space with a comma, through the value of <span style="font-family: courier, mono;">foo</span>, and substitutes the result.</p>
<h2 class="subhead"><a id="SEC77" href="#TOC77" name="SEC77">Functions for String Substitution and Analysis</a></h2>
<p><a id="IDX493" name="IDX493"></a> </p>
<p>Here are some functions that operate on strings:</p>
<dl compact>
<dt><span style="font-family: courier, mono;">$(subst <var>from</var>,<var>to</var>,<var>text</var>)</span></dt>
<dd>
<a id="IDX494" name="IDX494"></a>Performs a textual replacement on the text <var>text</var>: each occurrence of <var>from</var> is replaced by <var>to</var>. The result is substituted for the function call. For example,
<p>$(subst ee,EE,feet on the street)</p>
substitutes the string <samp>`fEEt on the strEEt'</samp>.</dd>
<dt><span style="font-family: courier, mono;">$(patsubst <var>pattern</var>,<var>replacement</var>,<var>text</var>)</span></dt>
<dd>
<a id="IDX495" name="IDX495"></a>Finds whitespace-separated words in <var>text</var> that match <var>pattern</var> and replaces them with <var>replacement</var>. Here <var>pattern</var> may contain a <samp>`%'</samp> which acts as a wildcard, matching any number of any characters within a word. If <var>replacement</var> also contains a <samp>`%'</samp>, the <samp>`%'</samp> is replaced by the text that matched the <samp>`%'</samp> in <var>pattern</var>. <a id="IDX496" name="IDX496"></a><a id="IDX497" name="IDX497"></a><a id="IDX498" name="IDX498"></a><a id="IDX499" name="IDX499"></a><a id="IDX500" name="IDX500"></a><samp>`%'</samp> characters in <span style="font-family: courier, mono;">patsubst</span> function invocations can be quoted with preceding backslashes (<samp>`\'</samp>). Backslashes that would otherwise quote <samp>`%'</samp> characters can be quoted with more backslashes. Backslashes that quote <samp>`%'</samp> characters or other backslashes are removed from the pattern before it is compared file names or has a stem substituted into it. Backslashes that are not in danger of quoting <samp>`%'</samp> characters go unmolested. For example, the pattern <tt>`the\%weird\\%pattern\\'</tt> has <samp>`the%weird\'</samp> preceding the operative <samp>`%'</samp> character, and <samp>`pattern\\'</samp> following it. The final two backslashes are left alone because they cannot affect any <samp>`%'</samp> character. Whitespace between words is folded into single space characters; leading and trailing whitespace is discarded. For example,
<p>$(patsubst %.c,%.o,x.c.c bar.c)</p>
produces the value <samp>`x.c.o bar.o'</samp>. Substitution references (see section <a href="#SEC61">Substitution References</a>) are a simpler way to get the effect of the <span style="font-family: courier, mono;">patsubst</span> function:
<p>$(<var>var</var>:<var>pattern</var>=<var>replacement</var>)</p>
is equivalent to
<p>$(patsubst <var>pattern</var>,<var>replacement</var>,$(<var>var</var>))</p>
The second shorthand simplifies one of the most common uses of <span style="font-family: courier, mono;">patsubst</span>: replacing the suffix at the end of file names.
<p>$(<var>var</var>:<var>suffix</var>=<var>replacement</var>)</p>
is equivalent to
<p>$(patsubst %<var>suffix</var>,%<var>replacement</var>,$(<var>var</var>))</p>
For example, you might have a list of object files:
<p>objects = foo.o bar.o baz.o</p>
To get the list of corresponding source files, you could simply write:
<p>$(objects:.o=.c)</p>
instead of using the general form:
<p>$(patsubst %.o,%.c,$(objects))</p>
</dd>
<dt><span style="font-family: courier, mono;">$(strip <var>string</var>)</span></dt>
<dd>
<a id="IDX501" name="IDX501"></a><a id="IDX502" name="IDX502"></a><a id="IDX503" name="IDX503"></a><a id="IDX504" name="IDX504"></a>Removes leading and trailing whitespace from <var>string</var> and replaces each internal sequence of one or more whitespace characters with a single space. Thus, <samp>`$(strip a b c )'</samp> results in <samp>`a b c'</samp>. The function <span style="font-family: courier, mono;">strip</span> can be very useful when used in conjunction with conditionals. When comparing something with the empty string <samp>`'</samp> using <span style="font-family: courier, mono;">ifeq</span> or <span style="font-family: courier, mono;">ifneq</span>, you usually want a string of just whitespace to match the empty string (see section <a href="#SEC71">Conditional Parts of Makefiles</a>). Thus, the following may fail to have the desired results:
<p>.PHONY: allifneq "$(needs_made)" ""all: $(needs_made)else all:;@echo 'Nothing to make!'endif</p>
Replacing the variable reference <samp>`$(needs_made)'</samp> with the function call <samp>`$(strip $(needs_made))'</samp> in the <span style="font-family: courier, mono;">ifneq</span> directive would make it more robust.</dd>
<dt><span style="font-family: courier, mono;">$(findstring <var>find</var>,<var>in</var>)</span></dt>
<dd>
<a id="IDX505" name="IDX505"></a><a id="IDX506" name="IDX506"></a><a id="IDX507" name="IDX507"></a><a id="IDX508" name="IDX508"></a>Searches <var>in</var> for an occurrence of <var>find</var>. If it occurs, the value is <var>find</var>; otherwise, the value is empty. You can use this function in a conditional to test for the presence of a specific substring in a given string. Thus, the two examples,
<p>$(findstring a,a b c)$(findstring a,b c)</p>
produce the values <samp>`a'</samp> and <samp>`'</samp> (the empty string), respectively. See section <a href="#SEC74">Conditionals that Test Flags</a>, for a practical application of <span style="font-family: courier, mono;">findstring</span>. <a id="IDX509" name="IDX509"></a><a id="IDX510" name="IDX510"></a><a id="IDX511" name="IDX511"></a>
</dd>
<dt><span style="font-family: courier, mono;">$(filter <var>pattern</var>...,<var>text</var>)</span></dt>
<dd>Returns all whitespace-separated words in <var>text</var> that <em>do</em> match any of the <var>pattern</var> words, removing any words that <em>do not</em> match. The patterns are written using <samp>`%'</samp>, just like the patterns used in the <span style="font-family: courier, mono;">patsubst</span> function above. The <span style="font-family: courier, mono;">filter</span> function can be used to separate out different types of strings (such as file names) in a variable. For example:
<p>sources := foo.c bar.c baz.s ugh.hfoo: $(sources) cc $(filter %.c %.s,$(sources)) -o foo</p>
says that <tt>`foo'</tt> depends of <tt>`foo.c'</tt>, <tt>`bar.c'</tt>, <tt>`baz.s'</tt> and <tt>`ugh.h'</tt> but only <tt>`foo.c'</tt>, <tt>`bar.c'</tt> and <tt>`baz.s'</tt> should be specified in the command to the compiler.</dd>
<dt><span style="font-family: courier, mono;">$(filter-out <var>pattern</var>...,<var>text</var>)</span></dt>
<dd>
<a id="IDX512" name="IDX512"></a><a id="IDX513" name="IDX513"></a><a id="IDX514" name="IDX514"></a>Returns all whitespace-separated words in <var>text</var> that <em>do not</em> match any of the <var>pattern</var> words, removing the words that <em>do</em> match one or more. This is the exact opposite of the <span style="font-family: courier, mono;">filter</span> function. Removes all whitespace-separated words in <var>text</var> that <em>do</em> match the <var>pattern</var> words, returning only the words that <em>do not</em> match. This is the exact opposite of the <span style="font-family: courier, mono;">filter</span> function. For example, given:
<p>objects=main1.o foo.o main2.o bar.omains=main1.o main2.o</p>
the following generates a list which contains all the object files not in <samp>`mains'</samp>:
<p>$(filter-out $(mains),$(objects))</p>
<a id="IDX515" name="IDX515"></a><a id="IDX516" name="IDX516"></a>
</dd>
<dt><span style="font-family: courier, mono;">$(sort <var>list</var>)</span></dt>
<dd>Sorts the words of <var>list</var> in lexical order, removing duplicate words. The output is a list of words separated by single spaces. Thus,
<p>$(sort foo bar lose)</p>
returns the value <samp>`bar foo lose'</samp>. <a id="IDX517" name="IDX517"></a><a id="IDX518" name="IDX518"></a><a id="IDX519" name="IDX519"></a>Incidentally, since <span style="font-family: courier, mono;">sort</span> removes duplicate words, you can use it for this purpose even if you don't care about the sort order.</dd>
</dl>
<p>Here is a realistic example of the use of <span style="font-family: courier, mono;">subst</span> and <span style="font-family: courier, mono;">patsubst</span>. Suppose that a makefile uses the <span style="font-family: courier, mono;">VPATH</span> variable to specify a list of directories that <span style="font-family: courier, mono;">make</span> should search for prerequisite files (see section <a href="#SEC27"><span style="font-family: courier, mono;">VPATH</span>: Search Path for All Prerequisites</a>). This example shows how to tell the C compiler to search for header files in the same list of directories.</p>
<p>The value of <span style="font-family: courier, mono;">VPATH</span> is a list of directories separated by colons, such as <samp>`src:../headers'</samp>. First, the <span style="font-family: courier, mono;">subst</span> function is used to change the colons to spaces:</p>
<p>$(subst :, ,$(VPATH))</p>
<p>This produces <samp>`src ../headers'</samp>. Then <span style="font-family: courier, mono;">patsubst</span> is used to turn each directory name into a <samp>`-I'</samp> flag. These can be added to the value of the variable <span style="font-family: courier, mono;">CFLAGS</span>, which is passed automatically to the C compiler, like this:</p>
<p>override CFLAGS += $(patsubst %,-I%,$(subst :, ,$(VPATH)))</p>
<p>The effect is to append the text <samp>`-Isrc -I../headers'</samp> to the previously given value of <span style="font-family: courier, mono;">CFLAGS</span>. The <span style="font-family: courier, mono;">override</span> directive is used so that the new value is assigned even if the previous value of <span style="font-family: courier, mono;">CFLAGS</span> was specified with a command argument (see section <a href="#SEC66">The <span style="font-family: courier, mono;">override</span> Directive</a>).</p>
<h2 class="subhead"><a id="SEC78" href="#TOC78" name="SEC78">Functions for File Names</a></h2>
<p><a id="IDX520" name="IDX520"></a><a id="IDX521" name="IDX521"></a> </p>
<p>Several of the built-in expansion functions relate specifically to taking apart file names or lists of file names.</p>
<p>Each of the following functions performs a specific transformation on a file name. The argument of the function is regarded as a series of file names, separated by whitespace. (Leading and trailing whitespace is ignored.) Each file name in the series is transformed in the same way and the results are concatenated with single spaces between them.</p>
<dl compact>
<dt><span style="font-family: courier, mono;">$(dir <var>names</var>...)</span></dt>
<dd>
<a id="IDX522" name="IDX522"></a><a id="IDX523" name="IDX523"></a><a id="IDX524" name="IDX524"></a>Extracts the directory-part of each file name in <var>names</var>. The directory-part of the file name is everything up through (and including) the last slash in it. If the file name contains no slash, the directory part is the string <samp>`./'</samp>. For example,
<p>$(dir src/foo.c hacks)</p>
produces the result <samp>`src/ ./'</samp>.</dd>
<dt><span style="font-family: courier, mono;">$(notdir <var>names</var>...)</span></dt>
<dd>
<a id="IDX525" name="IDX525"></a><a id="IDX526" name="IDX526"></a><a id="IDX527" name="IDX527"></a>Extracts all but the directory-part of each file name in <var>names</var>. If the file name contains no slash, it is left unchanged. Otherwise, everything through the last slash is removed from it. A file name that ends with a slash becomes an empty string. This is unfortunate, because it means that the result does not always have the same number of whitespace-separated file names as the argument had; but we do not see any other valid alternative. For example,
<p>$(notdir src/foo.c hacks)</p>
produces the result <samp>`foo.c hacks'</samp>.</dd>
<dt><span style="font-family: courier, mono;">$(suffix <var>names</var>...)</span></dt>
<dd>
<a id="IDX528" name="IDX528"></a><a id="IDX529" name="IDX529"></a><a id="IDX530" name="IDX530"></a>Extracts the suffix of each file name in <var>names</var>. If the file name contains a period, the suffix is everything starting with the last period. Otherwise, the suffix is the empty string. This frequently means that the result will be empty when <var>names</var> is not, and if <var>names</var> contains multiple file names, the result may contain fewer file names. For example,
<p>$(suffix src/foo.c src-1.0/bar.c hacks)</p>
produces the result <samp>`.c .c'</samp>.</dd>
<dt><span style="font-family: courier, mono;">$(basename <var>names</var>...)</span></dt>
<dd>
<a id="IDX531" name="IDX531"></a><a id="IDX532" name="IDX532"></a><a id="IDX533" name="IDX533"></a>Extracts all but the suffix of each file name in <var>names</var>. If the file name contains a period, the basename is everything starting up to (and not including) the last period. Periods in the directory part are ignored. If there is no period, the basename is the entire file name. For example,
<p>$(basename src/foo.c src-1.0/bar hacks)</p>
produces the result <samp>`src/foo src-1.0/bar hacks'</samp>.</dd>
<dt><span style="font-family: courier, mono;">$(addsuffix <var>suffix</var>,<var>names</var>...)</span></dt>
<dd>
<a id="IDX534" name="IDX534"></a><a id="IDX535" name="IDX535"></a><a id="IDX536" name="IDX536"></a>The argument <var>names</var> is regarded as a series of names, separated by whitespace; <var>suffix</var> is used as a unit. The value of <var>suffix</var> is appended to the end of each individual name and the resulting larger names are concatenated with single spaces between them. For example,
<p>$(addsuffix .c,foo bar)</p>
produces the result <samp>`foo.c bar.c'</samp>.</dd>
<dt><span style="font-family: courier, mono;">$(addprefix <var>prefix</var>,<var>names</var>...)</span></dt>
<dd>
<a id="IDX537" name="IDX537"></a><a id="IDX538" name="IDX538"></a><a id="IDX539" name="IDX539"></a>The argument <var>names</var> is regarded as a series of names, separated by whitespace; <var>prefix</var> is used as a unit. The value of <var>prefix</var> is prepended to the front of each individual name and the resulting larger names are concatenated with single spaces between them. For example,
<p>$(addprefix src/,foo bar)</p>
produces the result <samp>`src/foo src/bar'</samp>.</dd>
<dt><span style="font-family: courier, mono;">$(join <var>list1</var>,<var>list2</var>)</span></dt>
<dd>
<a id="IDX540" name="IDX540"></a><a id="IDX541" name="IDX541"></a><a id="IDX542" name="IDX542"></a>Concatenates the two arguments word by word: the two first words (one from each argument) concatenated form the first word of the result, the two second words form the second word of the result, and so on. So the <var>n</var>th word of the result comes from the <var>n</var>th word of each argument. If one argument has more words that the other, the extra words are copied unchanged into the result. For example, <samp>`$(join a b,.c .o)'</samp> produces <samp>`a.c b.o'</samp>. Whitespace between the words in the lists is not preserved; it is replaced with a single space. This function can merge the results of the <span style="font-family: courier, mono;">dir</span> and <span style="font-family: courier, mono;">notdir</span> functions, to produce the original list of files which was given to those two functions.</dd>
<dt><span style="font-family: courier, mono;">$(word <var>n</var>,<var>text</var>)</span></dt>
<dd>
<a id="IDX543" name="IDX543"></a><a id="IDX544" name="IDX544"></a><a id="IDX545" name="IDX545"></a>Returns the <var>n</var>th word of <var>text</var>. The legitimate values of <var>n</var> start from 1. If <var>n</var> is bigger than the number of words in <var>text</var>, the value is empty. For example,
<p>$(word 2, foo bar baz)</p>
returns <samp>`bar'</samp>.</dd>
<dt><span style="font-family: courier, mono;">$(wordlist <var>s</var>,<var>e</var>,<var>text</var>)</span></dt>
<dd>
<a id="IDX546" name="IDX546"></a><a id="IDX547" name="IDX547"></a><a id="IDX548" name="IDX548"></a>Returns the list of words in <var>text</var> starting with word <var>s</var> and ending with word <var>e</var> (inclusive). The legitimate values of <var>s</var> and <var>e</var> start from 1. If <var>s</var> is bigger than the number of words in <var>text</var>, the value is empty. If <var>e</var> is bigger than the number of words in <var>text</var>, words up to the end of <var>text</var> are returned. If <var>s</var> is greater than <var>e</var>, nothing is returned. For example,
<p>$(wordlist 2, 3, foo bar baz)</p>
returns <samp>`bar baz'</samp>.</dd>
<dt><span style="font-family: courier, mono;">$(words <var>text</var>)</span></dt>
<dd>
<a id="IDX549" name="IDX549"></a><a id="IDX550" name="IDX550"></a>Returns the number of words in <var>text</var>. Thus, the last word of <var>text</var> is <span style="font-family: courier, mono;">$(word $(words <var>text</var>),<var>text</var>)</span>.</dd>
<dt><span style="font-family: courier, mono;">$(firstword <var>names</var>...)</span></dt>
<dd>
<a id="IDX551" name="IDX551"></a><a id="IDX552" name="IDX552"></a>The argument <var>names</var> is regarded as a series of names, separated by whitespace. The value is the first name in the series. The rest of the names are ignored. For example,
<p>$(firstword foo bar)</p>
produces the result <samp>`foo'</samp>. Although <span style="font-family: courier, mono;">$(firstword <var>text</var>)</span> is the same as <span style="font-family: courier, mono;">$(word 1,<var>text</var>)</span>, the <span style="font-family: courier, mono;">firstword</span> function is retained for its simplicity.</dd>
<dt><span style="font-family: courier, mono;">$(wildcard <var>pattern</var>)</span></dt>
<dd>
<a id="IDX553" name="IDX553"></a><a id="IDX554" name="IDX554"></a>The argument <var>pattern</var> is a file name pattern, typically containing wildcard characters (as in shell file name patterns). The result of <span style="font-family: courier, mono;">wildcard</span> is a space-separated list of the names of existing files that match the pattern. See section <a href="#SEC22">Using Wildcard Characters in File Names</a>.</dd>
</dl>
<h2 class="subhead"><a id="SEC79" href="#TOC79" name="SEC79">The <span style="font-family: courier, mono;">foreach</span> Function</a></h2>
<p><a id="IDX555" name="IDX555"></a><a id="IDX556" name="IDX556"></a> </p>
<p>The <span style="font-family: courier, mono;">foreach</span> function is very different from other functions. It causes one piece of text to be used repeatedly, each time with a different substitution performed on it. It resembles the <span style="font-family: courier, mono;">for</span> command in the shell <span style="font-family: courier, mono;">sh</span> and the <span style="font-family: courier, mono;">foreach</span> command in the C-shell <span style="font-family: courier, mono;">csh</span>.</p>
<p>The syntax of the <span style="font-family: courier, mono;">foreach</span> function is:</p>
<p>$(foreach <var>var</var>,<var>list</var>,<var>text</var>)</p>
<p>The first two arguments, <var>var</var> and <var>list</var>, are expanded before anything else is done; note that the last argument, <var>text</var>, is <strong>not</strong> expanded at the same time. Then for each word of the expanded value of <var>list</var>, the variable named by the expanded value of <var>var</var> is set to that word, and <var>text</var> is expanded. Presumably <var>text</var> contains references to that variable, so its expansion will be different each time.</p>
<p>The result is that <var>text</var> is expanded as many times as there are whitespace-separated words in <var>list</var>. The multiple expansions of <var>text</var> are concatenated, with spaces between them, to make the result of <span style="font-family: courier, mono;">foreach</span>.</p>
<p>This simple example sets the variable <samp>`files'</samp> to the list of all files in the directories in the list <samp>`dirs'</samp>:</p>
<p>dirs := a b c dfiles := $(foreach dir,$(dirs),$(wildcard $(dir)/*))</p>
<p>Here <var>text</var> is <samp>`$(wildcard $(dir)/*)'</samp>. The first repetition finds the value <samp>`a'</samp> for <span style="font-family: courier, mono;">dir</span>, so it produces the same result as <samp>`$(wildcard a/*)'</samp>; the second repetition produces the result of <samp>`$(wildcard b/*)'</samp>; and the third, that of <samp>`$(wildcard c/*)'</samp>.</p>
<p>This example has the same result (except for setting <samp>`dirs'</samp>) as the following example:</p>
<p>files := $(wildcard a/* b/* c/* d/*)</p>
<p>When <var>text</var> is complicated, you can improve readability by giving it a name, with an additional variable:</p>
<p>find_files = $(wildcard $(dir)/*)dirs := a b c d files := $(foreach dir,$(dirs),$(find_files))</p>
<p>Here we use the variable <span style="font-family: courier, mono;">find_files</span> this way. We use plain <samp>`='</samp> to define a recursively-expanding variable, so that its value contains an actual function call to be reexpanded under the control of <span style="font-family: courier, mono;">foreach</span>; a simply-expanded variable would not do, since <span style="font-family: courier, mono;">wildcard</span> would be called only once at the time of defining <span style="font-family: courier, mono;">find_files</span>.</p>
<p>The <span style="font-family: courier, mono;">foreach</span> function has no permanent effect on the variable <var>var</var>; its value and flavor after the <span style="font-family: courier, mono;">foreach</span> function call are the same as they were beforehand. The other values which are taken from <var>list</var> are in effect only temporarily, during the execution of <span style="font-family: courier, mono;">foreach</span>. The variable <var>var</var> is a simply-expanded variable during the execution of <span style="font-family: courier, mono;">foreach</span>. If <var>var</var> was undefined before the <span style="font-family: courier, mono;">foreach</span> function call, it is undefined after the call. See section <a href="#SEC59">The Two Flavors of Variables</a>.</p>
<p>You must take care when using complex variable expressions that result in variable names because many strange things are valid variable names, but are probably not what you intended. For example,</p>
<p>files := $(foreach Esta escrito en espanol!,b c ch,$(find_files))</p>
<p>might be useful if the value of <span style="font-family: courier, mono;">find_files</span> references the variable whose name is <samp>`Esta escrito en espanol!'</samp> (es un nombre bastante largo, no?), but it is more likely to be a mistake.</p>
<h2 class="subhead"><a id="SEC80" href="#TOC80" name="SEC80">The <span style="font-family: courier, mono;">if</span> Function</a></h2>
<p><a id="IDX557" name="IDX557"></a><a id="IDX558" name="IDX558"></a> </p>
<p>The <span style="font-family: courier, mono;">if</span> function provides support for conditional expansion in a functional context (as opposed to the GNU <span style="font-family: courier, mono;">make</span> makefile conditionals such as <span style="font-family: courier, mono;">ifeq</span> (see section <a href="#SEC73">Syntax of Conditionals</a>).</p>
<p>An <span style="font-family: courier, mono;">if</span> function call can contain either two or three arguments:</p>
<p>$(if <var>condition</var>,<var>then-part</var>[,<var>else-part</var>])</p>
<p>The first argument, <var>condition</var>, first has all preceding and trailing whitespace stripped, then is expanded. If it expands to any non-empty string, then the condition is considered to be true. If it expands to an empty string, the condition is considered to be false.</p>
<p>If the condition is true then the second argument, <var>then-part</var>, is evaluated and this is used as the result of the evaluation of the entire <span style="font-family: courier, mono;">if</span> function.</p>
<p>If the condition is false then the third argument, <var>else-part</var>, is evaluated and this is the result of the <span style="font-family: courier, mono;">if</span> function. If there is no third argument, the <span style="font-family: courier, mono;">if</span> function evaluates to nothing (the empty string).</p>
<p>Note that only one of the <var>then-part</var> or the <var>else-part</var> will be evaluated, never both. Thus, either can contain side-effects (such as <span style="font-family: courier, mono;">shell</span> function calls, etc.)</p>
<h2 class="subhead"><a id="SEC81" href="#TOC81" name="SEC81">The <span style="font-family: courier, mono;">call</span> Function</a></h2>
<p><a id="IDX559" name="IDX559"></a><a id="IDX560" name="IDX560"></a><a id="IDX561" name="IDX561"></a> </p>
<p>The <span style="font-family: courier, mono;">call</span> function is unique in that it can be used to create new parameterized functions. You can write a complex expression as the value of a variable, then use <span style="font-family: courier, mono;">call</span> to expand it with different values.</p>
<p>The syntax of the <span style="font-family: courier, mono;">call</span> function is:</p>
<p>$(call <var>variable</var>,<var>param</var>,<var>param</var>,...)</p>
<p>When <span style="font-family: courier, mono;">make</span> expands this function, it assigns each <var>param</var> to temporary variables <span style="font-family: courier, mono;">$(1)</span>, <span style="font-family: courier, mono;">$(2)</span>, etc. The variable <span style="font-family: courier, mono;">$(0)</span> will contain <var>variable</var>. There is no maximum number of parameter arguments. There is no minimum, either, but it doesn't make sense to use <span style="font-family: courier, mono;">call</span> with no parameters.</p>
<p>Then <var>variable</var> is expanded as a <span style="font-family: courier, mono;">make</span> variable in the context of these temporary assignments. Thus, any reference to <span style="font-family: courier, mono;">$(1)</span> in the value of <var>variable</var> will resolve to the first <var>param</var> in the invocation of <span style="font-family: courier, mono;">call</span>.</p>
<p>Note that <var>variable</var> is the <em>name</em> of a variable, not a <em>reference</em> to that variable. Therefore you would not normally use a <samp>`$'</samp> or parentheses when writing it. (You can, however, use a variable reference in the name if you want the name not to be a constant.)</p>
<p>If <var>variable</var> is the name of a builtin function, the builtin function is always invoked (even if a <span style="font-family: courier, mono;">make</span> variable by that name also exists).</p>
<p>The <span style="font-family: courier, mono;">call</span> function expands the <var>param</var> arguments before assigning them to temporary variables. This means that <var>variable</var> values containing references to builtin functions that have special expansion rules, like <span style="font-family: courier, mono;">foreach</span> or <span style="font-family: courier, mono;">if</span>, may not work as you expect.</p>
<p>Some examples may make this clearer.</p>
<p>This macro simply reverses its arguments:</p>
<p>reverse = $(2) $(1)foo = $(call reverse,a,b)</p>
<p>Here <var>foo</var> will contain <samp>`b a'</samp>.</p>
<p>This one is slightly more interesting: it defines a macro to search for the first instance of a program in <span style="font-family: courier, mono;">PATH</span>:</p>
<p>pathsearch = $(firstword $(wildcard $(addsufix /$(1),$(subst :, ,$(PATH))))) LS := $(call pathsearch,ls)</p>
<p>Now the variable LS contains <span style="font-family: courier, mono;">/bin/ls</span> or similar.</p>
<p>The <span style="font-family: courier, mono;">call</span> function can be nested. Each recursive invocation gets its own local values for <span style="font-family: courier, mono;">$(1)</span>, etc. that mask the values of higher-level <span style="font-family: courier, mono;">call</span>. For example, here is an implementation of a <strong>map</strong> function:</p>
<p>map = $(foreach a,$(2),$(call $(1),$(a)))</p>
<p>Now you can <var>map</var> a function that normally takes only one argument, such as <span style="font-family: courier, mono;">origin</span>, to multiple values in one step:</p>
<p>o = $(call map,origin,o map MAKE)</p>
<p>and end up with <var>o</var> containing something like <samp>`file file default'</samp>.</p>
<p>A final caution: be careful when adding whitespace to the arguments to <span style="font-family: courier, mono;">call</span>. As with other functions, any whitespace contained in the second and subsequent arguments is kept; this can cause strange effects. It's generally safest to remove all extraneous whitespace when providing parameters to <span style="font-family: courier, mono;">call</span>.</p>
<h2 class="subhead"><a id="SEC82" href="#TOC82" name="SEC82">The <span style="font-family: courier, mono;">origin</span> Function</a></h2>
<p><a id="IDX562" name="IDX562"></a><a id="IDX563" name="IDX563"></a><a id="IDX564" name="IDX564"></a> </p>
<p>The <span style="font-family: courier, mono;">origin</span> function is unlike most other functions in that it does not operate on the values of variables; it tells you something <em>about</em> a variable. Specifically, it tells you where it came from.</p>
<p>The syntax of the <span style="font-family: courier, mono;">origin</span> function is:</p>
<p>$(origin <var>variable</var>)</p>
<p>Note that <var>variable</var> is the <em>name</em> of a variable to inquire about; not a <em>reference</em> to that variable. Therefore you would not normally use a <samp>`$'</samp> or parentheses when writing it. (You can, however, use a variable reference in the name if you want the name not to be a constant.)</p>
<p>The result of this function is a string telling you how the variable <var>variable</var> was defined:</p>
<dl compact>
<dt><samp>`undefined'</samp></dt>
<dd>if <var>variable</var> was never defined.</dd>
<dt><samp>`default'</samp></dt>
<dd>if <var>variable</var> has a default definition, as is usual with <span style="font-family: courier, mono;">CC</span> and so on. See section <a href="#SEC96">Variables Used by Implicit Rules</a>. Note that if you have redefined a default variable, the <span style="font-family: courier, mono;">origin</span> function will return the origin of the later definition.</dd>
<dt><samp>`environment'</samp></dt>
<dd>if <var>variable</var> was defined as an environment variable and the <samp>`-e'</samp> option is <em>not</em> turned on (see section <a href="#SEC92">Summary of Options</a>).</dd>
<dt><samp>`environment override'</samp></dt>
<dd>if <var>variable</var> was defined as an environment variable and the <samp>`-e'</samp> option <em>is</em> turned on (see section <a href="#SEC92">Summary of Options</a>).</dd>
<dt><samp>`file'</samp></dt>
<dd>if <var>variable</var> was defined in a makefile.</dd>
<dt><samp>`command line'</samp></dt>
<dd>if <var>variable</var> was defined on the command line.</dd>
<dt><samp>`override'</samp></dt>
<dd>if <var>variable</var> was defined with an <span style="font-family: courier, mono;">override</span> directive in a makefile (see section <a href="#SEC66">The <span style="font-family: courier, mono;">override</span> Directive</a>).</dd>
<dt><samp>`automatic'</samp></dt>
<dd>if <var>variable</var> is an automatic variable defined for the execution of the commands for each rule (see section <a href="#SEC101">Automatic Variables</a>).</dd>
</dl>
<p>This information is primarily useful (other than for your curiosity) to determine if you want to believe the value of a variable. For example, suppose you have a makefile <tt>`foo'</tt> that includes another makefile <tt>`bar'</tt>. You want a variable <span style="font-family: courier, mono;">bletch</span> to be defined in <tt>`bar'</tt> if you run the command <samp>`make -f bar'</samp>, even if the environment contains a definition of <span style="font-family: courier, mono;">bletch</span>. However, if <tt>`foo'</tt> defined <span style="font-family: courier, mono;">bletch</span> before including <tt>`bar'</tt>, you do not want to override that definition. This could be done by using an <span style="font-family: courier, mono;">override</span> directive in <tt>`foo'</tt>, giving that definition precedence over the later definition in <tt>`bar'</tt>; unfortunately, the <span style="font-family: courier, mono;">override</span> directive would also override any command line definitions. So, <tt>`bar'</tt> could include:</p>
<p>ifdef bletchifeq "$(origin bletch)" "environment"bletch = barf, gag, etc.endif endif</p>
<p>If <span style="font-family: courier, mono;">bletch</span> has been defined from the environment, this will redefine it.</p>
<p>If you want to override a previous definition of <span style="font-family: courier, mono;">bletch</span> if it came from the environment, even under <samp>`-e'</samp>, you could instead write:</p>
<p>ifneq "$(findstring environment,$(origin bletch))" ""bletch = barf, gag, etc. endif</p>
<p>Here the redefinition takes place if <samp>`$(origin bletch)'</samp> returns either <samp>`environment'</samp> or <samp>`environment override'</samp>. See section <a href="#SEC77">Functions for String Substitution and Analysis</a>.</p>
<h2 class="subhead"><a id="SEC83" href="#TOC83" name="SEC83">The <span style="font-family: courier, mono;">shell</span> Function</a></h2>
<p><a id="IDX565" name="IDX565"></a><a id="IDX566" name="IDX566"></a><a id="IDX567" name="IDX567"></a><a id="IDX568" name="IDX568"></a> </p>
<p>The <span style="font-family: courier, mono;">shell</span> function is unlike any other function except the <span style="font-family: courier, mono;">wildcard</span> function (see section <a href="#SEC25">The Function <span style="font-family: courier, mono;">wildcard</span></a>) in that it communicates with the world outside of <span style="font-family: courier, mono;">make</span>.</p>
<p>The <span style="font-family: courier, mono;">shell</span> function performs the same function that backquotes (<samp>``'</samp>) perform in most shells: it does <strong>command expansion</strong>. This means that it takes an argument that is a shell command and returns the output of the command. The only processing <span style="font-family: courier, mono;">make</span> does on the result, before substituting it into the surrounding text, is to convert each newline or carriage-return / newline pair to a single space. It also removes the trailing (carriage-return and) newline, if it's the last thing in the result.</p>
<p>The commands run by calls to the <span style="font-family: courier, mono;">shell</span> function are run when the function calls are expanded. In most cases, this is when the makefile is read in. The exception is that function calls in the commands of the rules are expanded when the commands are run, and this applies to <span style="font-family: courier, mono;">shell</span> function calls like all others.</p>
<p>Here are some examples of the use of the <span style="font-family: courier, mono;">shell</span> function:</p>
<p>contents := $(shell cat foo)</p>
<p>sets <span style="font-family: courier, mono;">contents</span> to the contents of the file <tt>`foo'</tt>, with a space (rather than a newline) separating each line.</p>
<p>files := $(shell echo *.c)</p>
<p>sets <span style="font-family: courier, mono;">files</span> to the expansion of <samp>`*.c'</samp>. Unless <span style="font-family: courier, mono;">make</span> is using a very strange shell, this has the same result as <samp>`$(wildcard *.c)'</samp>.</p>
<h2 class="subhead"><a id="SEC84" href="#TOC84" name="SEC84">Functions That Control Make</a></h2>
<p><a id="IDX569" name="IDX569"></a><a id="IDX570" name="IDX570"></a> </p>
<p>These functions control the way make runs. Generally, they are used to provide information to the user of the makefile or to cause make to stop if some sort of environmental error is detected.</p>
<dl compact>
<dt><span style="font-family: courier, mono;">$(error <var>text</var>...)</span></dt>
<dd>
<a id="IDX571" name="IDX571"></a><a id="IDX572" name="IDX572"></a><a id="IDX573" name="IDX573"></a>Generates a fatal error where the message is <var>text</var>. Note that the error is generated whenever this function is evaluated. So, if you put it inside a command script or on the right side of a recursive variable assignment, it won't be evaluated until later. The <var>text</var> will be expanded before the error is generated. For example,
<p>ifdef ERROR1$(error error is $(ERROR1))endif</p>
will generate a fatal error during the read of the makefile if the <span style="font-family: courier, mono;">make</span> variable <span style="font-family: courier, mono;">ERROR1</span> is defined. Or,
<p>ERR = $(error found an error!).PHONY: errerr: ; $(ERR)</p>
will generate a fatal error while <span style="font-family: courier, mono;">make</span> is running, if the <span style="font-family: courier, mono;">err</span> target is invoked.</dd>
<dt><span style="font-family: courier, mono;">$(warning <var>text</var>...)</span></dt>
<dd>
<a id="IDX574" name="IDX574"></a><a id="IDX575" name="IDX575"></a><a id="IDX576" name="IDX576"></a>This function works similarly to the <span style="font-family: courier, mono;">error</span> function, above, except that <span style="font-family: courier, mono;">make</span> doesn't exit. Instead, <var>text</var> is expanded and the resulting message is displayed, but processing of the makefile continues. The result of the expansion of this function is the empty string.</dd>
</dl>
<h2 class="subhead"><a id="SEC85" href="#TOC85" name="SEC85">How to Run <span style="font-family: courier, mono;">make</span></a></h2>
<p>A makefile that says how to recompile a program can be used in more than one way. The simplest use is to recompile every file that is out of date. Usually, makefiles are written so that if you run <span style="font-family: courier, mono;">make</span> with no arguments, it does just that.</p>
<p>But you might want to update only some of the files; you might want to use a different compiler or different compiler options; you might want just to find out which files are out of date without changing them.</p>
<p>By giving arguments when you run <span style="font-family: courier, mono;">make</span>, you can do any of these things and many others.</p>
<p>The exit status of <span style="font-family: courier, mono;">make</span> is always one of three values:</p>
<dl compact>
<dt><span style="font-family: courier, mono;">0</span></dt>
<dd>The exit status is zero if <span style="font-family: courier, mono;">make</span> is successful.</dd>
<dt><span style="font-family: courier, mono;">2</span></dt>
<dd>The exit status is two if <span style="font-family: courier, mono;">make</span> encounters any errors. It will print messages describing the particular errors.</dd>
<dt><span style="font-family: courier, mono;">1</span></dt>
<dd>The exit status is one if you use the <samp>`-q'</samp> flag and <span style="font-family: courier, mono;">make</span> determines that some target is not already up to date. See section <a href="#SEC88">Instead of Executing the Commands</a>.</dd>
</dl>
<h2 class="subhead"><a id="SEC86" href="#TOC86" name="SEC86">Arguments to Specify the Makefile</a></h2>
<p><a id="IDX577" name="IDX577"></a><a id="IDX578" name="IDX578"></a><a id="IDX579" name="IDX579"></a> </p>
<p>The way to specify the name of the makefile is with the <samp>`-f'</samp> or <samp>`--file'</samp> option (<samp>`--makefile'</samp> also works). For example, <samp>`-f altmake'</samp> says to use the file <tt>`altmake'</tt> as the makefile.</p>
<p>If you use the <samp>`-f'</samp> flag several times and follow each <samp>`-f'</samp> with an argument, all the specified files are used jointly as makefiles.</p>
<p>If you do not use the <samp>`-f'</samp> or <samp>`--file'</samp> flag, the default is to try <tt>`GNUmakefile'</tt>, <tt>`makefile'</tt>, and <tt>`Makefile'</tt>, in that order, and use the first of these three which exists or can be made (see section <a href="#SEC12">Writing Makefiles</a>).</p>
<h2 class="subhead"><a id="SEC87" href="#TOC87" name="SEC87">Arguments to Specify the Goals</a></h2>
<p><a id="IDX580" name="IDX580"></a> </p>
<p>The <strong>goals</strong> are the targets that <span style="font-family: courier, mono;">make</span> should strive ultimately to update. Other targets are updated as well if they appear as prerequisites of goals, or prerequisites of prerequisites of goals, etc.</p>
<p>By default, the goal is the first target in the makefile (not counting targets that start with a period). Therefore, makefiles are usually written so that the first target is for compiling the entire program or programs they describe. If the first rule in the makefile has several targets, only the first target in the rule becomes the default goal, not the whole list.</p>
<p>You can specify a different goal or goals with arguments to <span style="font-family: courier, mono;">make</span>. Use the name of the goal as an argument. If you specify several goals, <span style="font-family: courier, mono;">make</span> processes each of them in turn, in the order you name them.</p>
<p>Any target in the makefile may be specified as a goal (unless it starts with <samp>`-'</samp> or contains an <samp>`='</samp>, in which case it will be parsed as a switch or variable definition, respectively). Even targets not in the makefile may be specified, if <span style="font-family: courier, mono;">make</span> can find implicit rules that say how to make them.</p>
<p><a id="IDX581" name="IDX581"></a><a id="IDX582" name="IDX582"></a><span style="font-family: courier, mono;">Make</span> will set the special variable <span style="font-family: courier, mono;">MAKECMDGOALS</span> to the list of goals you specified on the command line. If no goals were given on the command line, this variable is empty. Note that this variable should be used only in special circumstances.</p>
<p>An example of appropriate use is to avoid including <tt>`.d'</tt> files during <span style="font-family: courier, mono;">clean</span> rules (see section <a href="#SEC43">Generating Prerequisites Automatically</a>), so <span style="font-family: courier, mono;">make</span> won't create them only to immediately remove them again:</p>
<p>sources = foo.c bar.cifneq ($(MAKECMDGOALS),clean)include $(sources:.c=.d)endif</p>
<p>One use of specifying a goal is if you want to compile only a part of the program, or only one of several programs. Specify as a goal each file that you wish to remake. For example, consider a directory containing several programs, with a makefile that starts like this:</p>
<p>.PHONY: allall: size nm ld ar as</p>
<p>If you are working on the program <span style="font-family: courier, mono;">size</span>, you might want to say <samp>`make size'</samp> so that only the files of that program are recompiled.</p>
<p>Another use of specifying a goal is to make files that are not normally made. For example, there may be a file of debugging output, or a version of the program that is compiled specially for testing, which has a rule in the makefile but is not a prerequisite of the default goal.</p>
<p>Another use of specifying a goal is to run the commands associated with a phony target (see section <a href="#SEC33">Phony Targets</a>) or empty target (see section <a href="#SEC35">Empty Target Files to Record Events</a>). Many makefiles contain a phony target named <tt>`clean'</tt> which deletes everything except source files. Naturally, this is done only if you request it explicitly with <samp>`make clean'</samp>. Following is a list of typical phony and empty target names. See section <a href="#SEC121">Standard Targets for Users</a>, for a detailed list of all the standard target names which GNU software packages use.</p>
<dl compact>
<dt><tt>`all'</tt></dt>
<dd>
<a id="IDX583" name="IDX583"></a>Make all the top-level targets the makefile knows about.</dd>
<dt><tt>`clean'</tt></dt>
<dd>
<a id="IDX584" name="IDX584"></a>Delete all files that are normally created by running <span style="font-family: courier, mono;">make</span>.</dd>
<dt><tt>`mostlyclean'</tt></dt>
<dd>
<a id="IDX585" name="IDX585"></a>Like <samp>`clean'</samp>, but may refrain from deleting a few files that people normally don't want to recompile. For example, the <samp>`mostlyclean'</samp> target for GCC does not delete <tt>`libgcc.a'</tt>, because recompiling it is rarely necessary and takes a lot of time.</dd>
<dt><tt>`distclean'</tt></dt>
<dd><a id="IDX586" name="IDX586"></a></dd>
<dt><tt>`realclean'</tt></dt>
<dd><a id="IDX587" name="IDX587"></a></dd>
<dt><tt>`clobber'</tt></dt>
<dd>
<a id="IDX588" name="IDX588"></a>Any of these targets might be defined to delete <em>more</em> files than <samp>`clean'</samp> does. For example, this would delete configuration files or links that you would normally create as preparation for compilation, even if the makefile itself cannot create these files.</dd>
<dt><tt>`install'</tt></dt>
<dd>
<a id="IDX589" name="IDX589"></a>Copy the executable file into a directory that users typically search for commands; copy any auxiliary files that the executable uses into the directories where it will look for them.</dd>
<dt><tt>`print'</tt></dt>
<dd>
<a id="IDX590" name="IDX590"></a>Print listings of the source files that have changed.</dd>
<dt><tt>`tar'</tt></dt>
<dd>
<a id="IDX591" name="IDX591"></a>Create a tar file of the source files.</dd>
<dt><tt>`shar'</tt></dt>
<dd>
<a id="IDX592" name="IDX592"></a>Create a shell archive (shar file) of the source files.</dd>
<dt><tt>`dist'</tt></dt>
<dd>
<a id="IDX593" name="IDX593"></a>Create a distribution file of the source files. This might be a tar file, or a shar file, or a compressed version of one of the above, or even more than one of the above.</dd>
<dt><tt>`TAGS'</tt></dt>
<dd>
<a id="IDX594" name="IDX594"></a>Update a tags table for this program.</dd>
<dt><tt>`check'</tt></dt>
<dd><a id="IDX595" name="IDX595"></a></dd>
<dt><tt>`test'</tt></dt>
<dd>
<a id="IDX596" name="IDX596"></a>Perform self tests on the program this makefile builds.</dd>
</dl>
<h2 class="subhead"><a id="SEC88" href="#TOC88" name="SEC88">Instead of Executing the Commands</a></h2>
<p><a id="IDX597" name="IDX597"></a><a id="IDX598" name="IDX598"></a> </p>
<p>The makefile tells <span style="font-family: courier, mono;">make</span> how to tell whether a target is up to date, and how to update each target. But updating the targets is not always what you want. Certain options specify other activities for <span style="font-family: courier, mono;">make</span>.</p>
<dl compact>
<dt><samp>`-n'</samp></dt>
<dt><samp>`--just-print'</samp></dt>
<dt><samp>`--dry-run'</samp></dt>
<dt><samp>`--recon'</samp></dt>
<dd>
<a id="IDX599" name="IDX599"></a><a id="IDX600" name="IDX600"></a><a id="IDX601" name="IDX601"></a><a id="IDX602" name="IDX602"></a>"No-op". The activity is to print what commands would be used to make the targets up to date, but not actually execute them.</dd>
<dt><samp>`-t'</samp></dt>
<dt><samp>`--touch'</samp></dt>
<dd>
<a id="IDX603" name="IDX603"></a><a id="IDX604" name="IDX604"></a><a id="IDX605" name="IDX605"></a><a id="IDX606" name="IDX606"></a>"Touch". The activity is to mark the targets as up to date without actually changing them. In other words, <span style="font-family: courier, mono;">make</span> pretends to compile the targets but does not really change their contents.</dd>
<dt><samp>`-q'</samp></dt>
<dt><samp>`--question'</samp></dt>
<dd>
<a id="IDX607" name="IDX607"></a><a id="IDX608" name="IDX608"></a><a id="IDX609" name="IDX609"></a>"Question". The activity is to find out silently whether the targets are up to date already; but execute no commands in either case. In other words, neither compilation nor output will occur.</dd>
<dt><samp>`-W <var>file</var>'</samp></dt>
<dt><samp>`--what-if=<var>file</var>'</samp></dt>
<dt><samp>`--assume-new=<var>file</var>'</samp></dt>
<dt><samp>`--new-file=<var>file</var>'</samp></dt>
<dd>
<a id="IDX610" name="IDX610"></a><a id="IDX611" name="IDX611"></a><a id="IDX612" name="IDX612"></a><a id="IDX613" name="IDX613"></a><a id="IDX614" name="IDX614"></a><a id="IDX615" name="IDX615"></a>"What if". Each <samp>`-W'</samp> flag is followed by a file name. The given files' modification times are recorded by <span style="font-family: courier, mono;">make</span> as being the present time, although the actual modification times remain the same. You can use the <samp>`-W'</samp> flag in conjunction with the <samp>`-n'</samp> flag to see what would happen if you were to modify specific files.</dd>
</dl>
<p>With the <samp>`-n'</samp> flag, <span style="font-family: courier, mono;">make</span> prints the commands that it would normally execute but does not execute them.</p>
<p>With the <samp>`-t'</samp> flag, <span style="font-family: courier, mono;">make</span> ignores the commands in the rules and uses (in effect) the command <span style="font-family: courier, mono;">touch</span> for each target that needs to be remade. The <span style="font-family: courier, mono;">touch</span> command is also printed, unless <samp>`-s'</samp> or <span style="font-family: courier, mono;">.SILENT</span> is used. For speed, <span style="font-family: courier, mono;">make</span> does not actually invoke the program <span style="font-family: courier, mono;">touch</span>. It does the work directly.</p>
<p>With the <samp>`-q'</samp> flag, <span style="font-family: courier, mono;">make</span> prints nothing and executes no commands, but the exit status code it returns is zero if and only if the targets to be considered are already up to date. If the exit status is one, then some updating needs to be done. If <span style="font-family: courier, mono;">make</span> encounters an error, the exit status is two, so you can distinguish an error from a target that is not up to date.</p>
<p>It is an error to use more than one of these three flags in the same invocation of <span style="font-family: courier, mono;">make</span>.</p>
<p>The <samp>`-n'</samp>, <samp>`-t'</samp>, and <samp>`-q'</samp> options do not affect command lines that begin with <samp>`+'</samp> characters or contain the strings <samp>`$(MAKE)'</samp> or <samp>`${MAKE}'</samp>. Note that only the line containing the <samp>`+'</samp> character or the strings <samp>`$(MAKE)'</samp> or <samp>`${MAKE}'</samp> is run regardless of these options. Other lines in the same rule are not run unless they too begin with <samp>`+'</samp> or contain <samp>`$(MAKE)'</samp> or <samp>`${MAKE}'</samp> (See section <a href="#SEC51">How the <span style="font-family: courier, mono;">MAKE</span> Variable Works</a>.)</p>
<p>The <samp>`-W'</samp> flag provides two features:</p>
<ul>
<li>If you also use the <samp>`-n'</samp> or <samp>`-q'</samp> flag, you can see what <span style="font-family: courier, mono;">make</span> would do if you were to modify some files.</li>
<li>Without the <samp>`-n'</samp> or <samp>`-q'</samp> flag, when <span style="font-family: courier, mono;">make</span> is actually executing commands, the <samp>`-W'</samp> flag can direct <span style="font-family: courier, mono;">make</span> to act as if some files had been modified, without actually modifying the files.</li>
</ul>
<p>Note that the options <samp>`-p'</samp> and <samp>`-v'</samp> allow you to obtain other information about <span style="font-family: courier, mono;">make</span> or about the makefiles in use (see section <a href="#SEC92">Summary of Options</a>).</p>
<h2 class="subhead"><a id="SEC89" href="#TOC89" name="SEC89">Avoiding Recompilation of Some Files</a></h2>
<p><a id="IDX616" name="IDX616"></a><a id="IDX617" name="IDX617"></a><a id="IDX618" name="IDX618"></a><a id="IDX619" name="IDX619"></a><a id="IDX620" name="IDX620"></a><a id="IDX621" name="IDX621"></a> </p>
<p>Sometimes you may have changed a source file but you do not want to recompile all the files that depend on it. For example, suppose you add a macro or a declaration to a header file that many other files depend on. Being conservative, <span style="font-family: courier, mono;">make</span> assumes that any change in the header file requires recompilation of all dependent files, but you know that they do not need to be recompiled and you would rather not waste the time waiting for them to compile.</p>
<p>If you anticipate the problem before changing the header file, you can use the <samp>`-t'</samp> flag. This flag tells <span style="font-family: courier, mono;">make</span> not to run the commands in the rules, but rather to mark the target up to date by changing its last-modification date. You would follow this procedure:</p>
<ol>
<li>Use the command <samp>`make'</samp> to recompile the source files that really need recompilation.</li>
<li>Make the changes in the header files.</li>
<li>Use the command <samp>`make -t'</samp> to mark all the object files as up to date. The next time you run <span style="font-family: courier, mono;">make</span>, the changes in the header files will not cause any recompilation.</li>
</ol>
<p>If you have already changed the header file at a time when some files do need recompilation, it is too late to do this. Instead, you can use the <samp>`-o <var>file</var>'</samp> flag, which marks a specified file as "old" (see section <a href="#SEC92">Summary of Options</a>). This means that the file itself will not be remade, and nothing else will be remade on its account. Follow this procedure:</p>
<ol>
<li>Recompile the source files that need compilation for reasons independent of the particular header file, with <samp>`make -o <var>headerfile</var>'</samp>. If several header files are involved, use a separate <samp>`-o'</samp> option for each header file.</li>
<li>Touch all the object files with <samp>`make -t'</samp>.</li>
</ol>
<h2 class="subhead"><a id="SEC90" href="#TOC90" name="SEC90">Overriding Variables</a></h2>
<p><a id="IDX622" name="IDX622"></a><a id="IDX623" name="IDX623"></a><a id="IDX624" name="IDX624"></a><a id="IDX625" name="IDX625"></a> </p>
<p>An argument that contains <samp>`='</samp> specifies the value of a variable: <samp>`<var>v</var>=<var>x</var>'</samp> sets the value of the variable <var>v</var> to <var>x</var>. If you specify a value in this way, all ordinary assignments of the same variable in the makefile are ignored; we say they have been <strong>overridden</strong> by the command line argument.</p>
<p>The most common way to use this facility is to pass extra flags to compilers. For example, in a properly written makefile, the variable <span style="font-family: courier, mono;">CFLAGS</span> is included in each command that runs the C compiler, so a file <tt>`foo.c'</tt> would be compiled something like this:</p>
<p>cc -c $(CFLAGS) foo.c</p>
<p>Thus, whatever value you set for <span style="font-family: courier, mono;">CFLAGS</span> affects each compilation that occurs. The makefile probably specifies the usual value for <span style="font-family: courier, mono;">CFLAGS</span>, like this:</p>
<p>CFLAGS=-g</p>
<p>Each time you run <span style="font-family: courier, mono;">make</span>, you can override this value if you wish. For example, if you say <samp>`make CFLAGS='-g -O''</samp>, each C compilation will be done with <samp>`cc -c -g -O'</samp>. (This illustrates how you can use quoting in the shell to enclose spaces and other special characters in the value of a variable when you override it.)</p>
<p>The variable <span style="font-family: courier, mono;">CFLAGS</span> is only one of many standard variables that exist just so that you can change them this way. See section <a href="#SEC96">Variables Used by Implicit Rules</a>, for a complete list.</p>
<p>You can also program the makefile to look at additional variables of your own, giving the user the ability to control other aspects of how the makefile works by changing the variables.</p>
<p>When you override a variable with a command argument, you can define either a recursively-expanded variable or a simply-expanded variable. The examples shown above make a recursively-expanded variable; to make a simply-expanded variable, write <samp>`:='</samp> instead of <samp>`='</samp>. But, unless you want to include a variable reference or function call in the <em>value</em> that you specify, it makes no difference which kind of variable you create.</p>
<p>There is one way that the makefile can change a variable that you have overridden. This is to use the <span style="font-family: courier, mono;">override</span> directive, which is a line that looks like this: <samp>`override <var>variable</var> = <var>value</var>'</samp> (see section <a href="#SEC66">The <span style="font-family: courier, mono;">override</span> Directive</a>).</p>
<h2 class="subhead"><a id="SEC91" href="#TOC91" name="SEC91">Testing the Compilation of a Program</a></h2>
<p><a id="IDX626" name="IDX626"></a><a id="IDX627" name="IDX627"></a> </p>
<p>Normally, when an error happens in executing a shell command, <span style="font-family: courier, mono;">make</span> gives up immediately, returning a nonzero status. No further commands are executed for any target. The error implies that the goal cannot be correctly remade, and <span style="font-family: courier, mono;">make</span> reports this as soon as it knows.</p>
<p>When you are compiling a program that you have just changed, this is not what you want. Instead, you would rather that <span style="font-family: courier, mono;">make</span> try compiling every file that can be tried, to show you as many compilation errors as possible.</p>
<p><a id="IDX628" name="IDX628"></a><a id="IDX629" name="IDX629"></a>On these occasions, you should use the <samp>`-k'</samp> or <samp>`--keep-going'</samp> flag. This tells <span style="font-family: courier, mono;">make</span> to continue to consider the other prerequisites of the pending targets, remaking them if necessary, before it gives up and returns nonzero status. For example, after an error in compiling one object file, <samp>`make -k'</samp> will continue compiling other object files even though it already knows that linking them will be impossible. In addition to continuing after failed shell commands, <samp>`make -k'</samp> will continue as much as possible after discovering that it does not know how to make a target or prerequisite file. This will always cause an error message, but without <samp>`-k'</samp>, it is a fatal error (see section <a href="#SEC92">Summary of Options</a>).</p>
<p>The usual behavior of <span style="font-family: courier, mono;">make</span> assumes that your purpose is to get the goals up to date; once <span style="font-family: courier, mono;">make</span> learns that this is impossible, it might as well report the failure immediately. The <samp>`-k'</samp> flag says that the real purpose is to test as much as possible of the changes made in the program, perhaps to find several independent problems so that you can correct them all before the next attempt to compile. This is why Emacs' <kbd>M-x compile</kbd> command passes the <samp>`-k'</samp> flag by default.</p>
<h2 class="subhead"><a id="SEC92" href="#TOC92" name="SEC92">Summary of Options</a></h2>
<p><a id="IDX630" name="IDX630"></a><a id="IDX631" name="IDX631"></a><a id="IDX632" name="IDX632"></a> </p>
<p>Here is a table of all the options <span style="font-family: courier, mono;">make</span> understands:</p>
<dl compact>
<dt><samp>`-b'</samp></dt>
<dd><a id="IDX633" name="IDX633"></a></dd>
<dt><samp>`-m'</samp></dt>
<dd>
<a id="IDX634" name="IDX634"></a>These options are ignored for compatibility with other versions of <span style="font-family: courier, mono;">make</span>.</dd>
<dt><samp>`-C <var>dir</var>'</samp></dt>
<dd><a id="IDX635" name="IDX635"></a></dd>
<dt><samp>`--directory=<var>dir</var>'</samp></dt>
<dd>
<a id="IDX636" name="IDX636"></a>Change to directory <var>dir</var> before reading the makefiles. If multiple <samp>`-C'</samp> options are specified, each is interpreted relative to the previous one: <samp>`-C / -C etc'</samp> is equivalent to <samp>`-C /etc'</samp>. This is typically used with recursive invocations of <span style="font-family: courier, mono;">make</span> (see section <a href="#SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>).</dd>
<dt><samp>`-d'</samp></dt>
<dd>
<a id="IDX637" name="IDX637"></a>Print debugging information in addition to normal processing. The debugging information says which files are being considered for remaking, which file-times are being compared and with what results, which files actually need to be remade, which implicit rules are considered and which are applied--everything interesting about how <span style="font-family: courier, mono;">make</span> decides what to do. The <span style="font-family: courier, mono;">-d</span> option is equivalent to <samp>`--debug=a'</samp> (see below).</dd>
<dt><samp>`--debug[=<var>options</var>]'</samp></dt>
<dd>
<a id="IDX638" name="IDX638"></a>Print debugging information in addition to normal processing. Various levels and types of output can be chosen. With no arguments, print the "basic" level of debugging. Possible arguments are below; only the first character is considered, and values must be comma- or space-separated.
<dl compact>
<dt><span style="font-family: courier, mono;">a (<i>all</i>)</span></dt>
<dd>All types of debugging output are enabled. This is equivalent to using <samp>`-d'</samp>.</dd>
<dt><span style="font-family: courier, mono;">b (<i>basic</i>)</span></dt>
<dd>Basic debugging prints each target that was found to be out-of-date, and whether the build was successful or not.</dd>
<dt><span style="font-family: courier, mono;">v (<i>verbose</i>)</span></dt>
<dd>A level above <samp>`basic'</samp>; includes messages about which makefiles were parsed, prerequisites that did not need to be rebuilt, etc. This option also enables <samp>`basic'</samp> messages.</dd>
<dt><span style="font-family: courier, mono;">i (<i>implicit</i>)</span></dt>
<dd>Prints messages describing the implicit rule searches for each target. This option also enables <samp>`basic'</samp> messages.</dd>
<dt><span style="font-family: courier, mono;">j (<i>jobs</i>)</span></dt>
<dd>Prints messages giving details on the invocation of specific subcommands.</dd>
<dt><span style="font-family: courier, mono;">m (<i>makefile</i>)</span></dt>
<dd>By default, the above messages are not enabled while trying to remake the makefiles. This option enables messages while rebuilding makefiles, too. Note that the <samp>`all'</samp> option does enable this option. This option also enables <samp>`basic'</samp> messages.</dd>
</dl>
</dd>
<dt><samp>`-e'</samp></dt>
<dd><a id="IDX639" name="IDX639"></a></dd>
<dt><samp>`--environment-overrides'</samp></dt>
<dd>
<a id="IDX640" name="IDX640"></a>Give variables taken from the environment precedence over variables from makefiles. See section <a href="#SEC68">Variables from the Environment</a>.</dd>
<dt><samp>`-f <var>file</var>'</samp></dt>
<dd><a id="IDX641" name="IDX641"></a></dd>
<dt><samp>`--file=<var>file</var>'</samp></dt>
<dd><a id="IDX642" name="IDX642"></a></dd>
<dt><samp>`--makefile=<var>file</var>'</samp></dt>
<dd>
<a id="IDX643" name="IDX643"></a>Read the file named <var>file</var> as a makefile. See section <a href="#SEC12">Writing Makefiles</a>.</dd>
<dt><samp>`-h'</samp></dt>
<dd><a id="IDX644" name="IDX644"></a></dd>
<dt><samp>`--help'</samp></dt>
<dd>
<a id="IDX645" name="IDX645"></a>Remind you of the options that <span style="font-family: courier, mono;">make</span> understands and then exit.</dd>
<dt><samp>`-i'</samp></dt>
<dd><a id="IDX646" name="IDX646"></a></dd>
<dt><samp>`--ignore-errors'</samp></dt>
<dd>
<a id="IDX647" name="IDX647"></a>Ignore all errors in commands executed to remake files. See section <a href="#SEC48">Errors in Commands</a>.</dd>
<dt><samp>`-I <var>dir</var>'</samp></dt>
<dd><a id="IDX648" name="IDX648"></a></dd>
<dt><samp>`--include-dir=<var>dir</var>'</samp></dt>
<dd>
<a id="IDX649" name="IDX649"></a>Specifies a directory <var>dir</var> to search for included makefiles. See section <a href="#SEC15">Including Other Makefiles</a>. If several <samp>`-I'</samp> options are used to specify several directories, the directories are searched in the order specified.</dd>
<dt><samp>`-j [<var>jobs</var>]'</samp></dt>
<dd><a id="IDX650" name="IDX650"></a></dd>
<dt><samp>`--jobs[=<var>jobs</var>]'</samp></dt>
<dd>
<a id="IDX651" name="IDX651"></a>Specifies the number of jobs (commands) to run simultaneously. With no argument, <span style="font-family: courier, mono;">make</span> runs as many jobs simultaneously as possible. If there is more than one <samp>`-j'</samp> option, the last one is effective. See section <a href="#SEC47">Parallel Execution</a>, for more information on how commands are run. Note that this option is ignored on MS-DOS.</dd>
<dt><samp>`-k'</samp></dt>
<dd><a id="IDX652" name="IDX652"></a></dd>
<dt><samp>`--keep-going'</samp></dt>
<dd>
<a id="IDX653" name="IDX653"></a>Continue as much as possible after an error. While the target that failed, and those that depend on it, cannot be remade, the other prerequisites of these targets can be processed all the same. See section <a href="#SEC91">Testing the Compilation of a Program</a>.</dd>
<dt><samp>`-l [<var>load</var>]'</samp></dt>
<dd><a id="IDX654" name="IDX654"></a></dd>
<dt><samp>`--load-average[=<var>load</var>]'</samp></dt>
<dd><a id="IDX655" name="IDX655"></a></dd>
<dt><samp>`--max-load[=<var>load</var>]'</samp></dt>
<dd>
<a id="IDX656" name="IDX656"></a>Specifies that no new jobs (commands) should be started if there are other jobs running and the load average is at least <var>load</var> (a floating-point number). With no argument, removes a previous load limit. See section <a href="#SEC47">Parallel Execution</a>.</dd>
<dt><samp>`-n'</samp></dt>
<dd><a id="IDX657" name="IDX657"></a></dd>
<dt><samp>`--just-print'</samp></dt>
<dd><a id="IDX658" name="IDX658"></a></dd>
<dt><samp>`--dry-run'</samp></dt>
<dd><a id="IDX659" name="IDX659"></a></dd>
<dt><samp>`--recon'</samp></dt>
<dd>
<a id="IDX660" name="IDX660"></a>Print the commands that would be executed, but do not execute them. See section <a href="#SEC88">Instead of Executing the Commands</a>.</dd>
<dt><samp>`-o <var>file</var>'</samp></dt>
<dd><a id="IDX661" name="IDX661"></a></dd>
<dt><samp>`--old-file=<var>file</var>'</samp></dt>
<dd><a id="IDX662" name="IDX662"></a></dd>
<dt><samp>`--assume-old=<var>file</var>'</samp></dt>
<dd>
<a id="IDX663" name="IDX663"></a>Do not remake the file <var>file</var> even if it is older than its prerequisites, and do not remake anything on account of changes in <var>file</var>. Essentially the file is treated as very old and its rules are ignored. See section <a href="#SEC89">Avoiding Recompilation of Some Files</a>.</dd>
<dt><samp>`-p'</samp></dt>
<dd><a id="IDX664" name="IDX664"></a></dd>
<dt><samp>`--print-data-base'</samp></dt>
<dd>
<a id="IDX665" name="IDX665"></a><a id="IDX666" name="IDX666"></a><a id="IDX667" name="IDX667"></a>Print the data base (rules and variable values) that results from reading the makefiles; then execute as usual or as otherwise specified. This also prints the version information given by the <samp>`-v'</samp> switch (see below). To print the data base without trying to remake any files, use <samp>`make -qp'</samp>. To print the data base of predefined rules and variables, use <samp>`make -p -f /dev/null'</samp>. The data base output contains filename and linenumber information for command and variable definitions, so it can be a useful debugging tool in complex environments.</dd>
<dt><samp>`-q'</samp></dt>
<dd><a id="IDX668" name="IDX668"></a></dd>
<dt><samp>`--question'</samp></dt>
<dd>
<a id="IDX669" name="IDX669"></a>"Question mode". Do not run any commands, or print anything; just return an exit status that is zero if the specified targets are already up to date, one if any remaking is required, or two if an error is encountered. See section <a href="#SEC88">Instead of Executing the Commands</a>.</dd>
<dt><samp>`-r'</samp></dt>
<dd><a id="IDX670" name="IDX670"></a></dd>
<dt><samp>`--no-builtin-rules'</samp></dt>
<dd>
<a id="IDX671" name="IDX671"></a>Eliminate use of the built-in implicit rules (see section <a href="#SEC93">Using Implicit Rules</a>). You can still define your own by writing pattern rules (see section <a href="#SEC98">Defining and Redefining Pattern Rules</a>). The <samp>`-r'</samp> option also clears out the default list of suffixes for suffix rules (see section <a href="#SEC106">Old-Fashioned Suffix Rules</a>). But you can still define your own suffixes with a rule for <span style="font-family: courier, mono;">.SUFFIXES</span>, and then define your own suffix rules. Note that only <em>rules</em> are affected by the <span style="font-family: courier, mono;">-r</span> option; default variables remain in effect (see section <a href="#SEC96">Variables Used by Implicit Rules</a>); see the <samp>`-R'</samp> option below.</dd>
<dt><samp>`-R'</samp></dt>
<dd><a id="IDX672" name="IDX672"></a></dd>
<dt><samp>`--no-builtin-variables'</samp></dt>
<dd>
<a id="IDX673" name="IDX673"></a>Eliminate use of the built-in rule-specific variables (see section <a href="#SEC96">Variables Used by Implicit Rules</a>). You can still define your own, of course. The <samp>`-R'</samp> option also automatically enables the <samp>`-r'</samp> option (see above), since it doesn't make sense to have implicit rules without any definitions for the variables that they use.</dd>
<dt><samp>`-s'</samp></dt>
<dd><a id="IDX674" name="IDX674"></a></dd>
<dt><samp>`--silent'</samp></dt>
<dd><a id="IDX675" name="IDX675"></a></dd>
<dt><samp>`--quiet'</samp></dt>
<dd>
<a id="IDX676" name="IDX676"></a>Silent operation; do not print the commands as they are executed. See section <a href="#SEC45">Command Echoing</a>.</dd>
<dt><samp>`-S'</samp></dt>
<dd><a id="IDX677" name="IDX677"></a></dd>
<dt><samp>`--no-keep-going'</samp></dt>
<dd><a id="IDX678" name="IDX678"></a></dd>
<dt><samp>`--stop'</samp></dt>
<dd>
<a id="IDX679" name="IDX679"></a>Cancel the effect of the <samp>`-k'</samp> option. This is never necessary except in a recursive <span style="font-family: courier, mono;">make</span> where <samp>`-k'</samp> might be inherited from the top-level <span style="font-family: courier, mono;">make</span> via <span style="font-family: courier, mono;">MAKEFLAGS</span> (see section <a href="#SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>) or if you set <samp>`-k'</samp> in <span style="font-family: courier, mono;">MAKEFLAGS</span> in your environment.</dd>
<dt><samp>`-t'</samp></dt>
<dd><a id="IDX680" name="IDX680"></a></dd>
<dt><samp>`--touch'</samp></dt>
<dd>
<a id="IDX681" name="IDX681"></a>Touch files (mark them up to date without really changing them) instead of running their commands. This is used to pretend that the commands were done, in order to fool future invocations of <span style="font-family: courier, mono;">make</span>. See section <a href="#SEC88">Instead of Executing the Commands</a>.</dd>
<dt><samp>`-v'</samp></dt>
<dd><a id="IDX682" name="IDX682"></a></dd>
<dt><samp>`--version'</samp></dt>
<dd>
<a id="IDX683" name="IDX683"></a>Print the version of the <span style="font-family: courier, mono;">make</span> program plus a copyright, a list of authors, and a notice that there is no warranty; then exit.</dd>
<dt><samp>`-w'</samp></dt>
<dd><a id="IDX684" name="IDX684"></a></dd>
<dt><samp>`--print-directory'</samp></dt>
<dd>
<a id="IDX685" name="IDX685"></a>Print a message containing the working directory both before and after executing the makefile. This may be useful for tracking down errors from complicated nests of recursive <span style="font-family: courier, mono;">make</span> commands. See section <a href="#SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>. (In practice, you rarely need to specify this option since <samp>`make'</samp> does it for you; see section <a href="#SEC54">The <samp>`--print-directory'</samp> Option</a>.)</dd>
<dt><samp>`--no-print-directory'</samp></dt>
<dd>
<a id="IDX686" name="IDX686"></a>Disable printing of the working directory under <span style="font-family: courier, mono;">-w</span>. This option is useful when <span style="font-family: courier, mono;">-w</span> is turned on automatically, but you do not want to see the extra messages. See section <a href="#SEC54">The <samp>`--print-directory'</samp> Option</a>.</dd>
<dt><samp>`-W <var>file</var>'</samp></dt>
<dd><a id="IDX687" name="IDX687"></a></dd>
<dt><samp>`--what-if=<var>file</var>'</samp></dt>
<dd><a id="IDX688" name="IDX688"></a></dd>
<dt><samp>`--new-file=<var>file</var>'</samp></dt>
<dd><a id="IDX689" name="IDX689"></a></dd>
<dt><samp>`--assume-new=<var>file</var>'</samp></dt>
<dd>
<a id="IDX690" name="IDX690"></a>Pretend that the target <var>file</var> has just been modified. When used with the <samp>`-n'</samp> flag, this shows you what would happen if you were to modify that file. Without <samp>`-n'</samp>, it is almost the same as running a <span style="font-family: courier, mono;">touch</span> command on the given file before running <span style="font-family: courier, mono;">make</span>, except that the modification time is changed only in the imagination of <span style="font-family: courier, mono;">make</span>. See section <a href="#SEC88">Instead of Executing the Commands</a>.</dd>
<dt><samp>`--warn-undefined-variables'</samp></dt>
<dd>
<a id="IDX691" name="IDX691"></a><a id="IDX692" name="IDX692"></a><a id="IDX693" name="IDX693"></a>Issue a warning message whenever <span style="font-family: courier, mono;">make</span> sees a reference to an undefined variable. This can be helpful when you are trying to debug makefiles which use variables in complex ways.</dd>
</dl>
<h2 class="subhead"><a id="SEC93" href="#TOC93" name="SEC93">Using Implicit Rules</a></h2>
<p><a id="IDX694" name="IDX694"></a><a id="IDX695" name="IDX695"></a> </p>
<p>Certain standard ways of remaking target files are used very often. For example, one customary way to make an object file is from a C source file using the C compiler, <span style="font-family: courier, mono;">cc</span>.</p>
<p><strong>Implicit rules</strong> tell <span style="font-family: courier, mono;">make</span> how to use customary techniques so that you do not have to specify them in detail when you want to use them. For example, there is an implicit rule for C compilation. File names determine which implicit rules are run. For example, C compilation typically takes a <tt>`.c'</tt> file and makes a <tt>`.o'</tt> file. So <span style="font-family: courier, mono;">make</span> applies the implicit rule for C compilation when it sees this combination of file name endings.</p>
<p>A chain of implicit rules can apply in sequence; for example, <span style="font-family: courier, mono;">make</span> will remake a <tt>`.o'</tt> file from a <tt>`.y'</tt> file by way of a <tt>`.c'</tt> file. See section <a href="#SEC97">Chains of Implicit Rules</a>.</p>
<p>The built-in implicit rules use several variables in their commands so that, by changing the values of the variables, you can change the way the implicit rule works. For example, the variable <span style="font-family: courier, mono;">CFLAGS</span> controls the flags given to the C compiler by the implicit rule for C compilation. See section <a href="#SEC96">Variables Used by Implicit Rules</a>.</p>
<p>You can define your own implicit rules by writing <strong>pattern rules</strong>. See section <a href="#SEC98">Defining and Redefining Pattern Rules</a>.</p>
<p><strong>Suffix rules</strong> are a more limited way to define implicit rules. Pattern rules are more general and clearer, but suffix rules are retained for compatibility. See section <a href="#SEC106">Old-Fashioned Suffix Rules</a>.</p>
<h2 class="subhead"><a id="SEC94" href="#TOC94" name="SEC94">Using Implicit Rules</a></h2>
<p><a id="IDX696" name="IDX696"></a><a id="IDX697" name="IDX697"></a> </p>
<p>To allow <span style="font-family: courier, mono;">make</span> to find a customary method for updating a target file, all you have to do is refrain from specifying commands yourself. Either write a rule with no command lines, or don't write a rule at all. Then <span style="font-family: courier, mono;">make</span> will figure out which implicit rule to use based on which kind of source file exists or can be made.</p>
<p>For example, suppose the makefile looks like this:</p>
<p>foo : foo.o bar.o cc -o foo foo.o bar.o $(CFLAGS) $(LDFLAGS)</p>
<p>Because you mention <tt>`foo.o'</tt> but do not give a rule for it, <span style="font-family: courier, mono;">make</span> will automatically look for an implicit rule that tells how to update it. This happens whether or not the file <tt>`foo.o'</tt> currently exists.</p>
<p>If an implicit rule is found, it can supply both commands and one or more prerequisites (the source files). You would want to write a rule for <tt>`foo.o'</tt> with no command lines if you need to specify additional prerequisites, such as header files, that the implicit rule cannot supply.</p>
<p>Each implicit rule has a target pattern and prerequisite patterns. There may be many implicit rules with the same target pattern. For example, numerous rules make <samp>`.o'</samp> files: one, from a <samp>`.c'</samp> file with the C compiler; another, from a <samp>`.p'</samp> file with the Pascal compiler; and so on. The rule that actually applies is the one whose prerequisites exist or can be made. So, if you have a file <tt>`foo.c'</tt>, <span style="font-family: courier, mono;">make</span> will run the C compiler; otherwise, if you have a file <tt>`foo.p'</tt>, <span style="font-family: courier, mono;">make</span> will run the Pascal compiler; and so on.</p>
<p>Of course, when you write the makefile, you know which implicit rule you want <span style="font-family: courier, mono;">make</span> to use, and you know it will choose that one because you know which possible prerequisite files are supposed to exist. See section <a href="#SEC95">Catalogue of Implicit Rules</a>, for a catalogue of all the predefined implicit rules.</p>
<p>Above, we said an implicit rule applies if the required prerequisites "exist or can be made". A file "can be made" if it is mentioned explicitly in the makefile as a target or a prerequisite, or if an implicit rule can be recursively found for how to make it. When an implicit prerequisite is the result of another implicit rule, we say that <strong>chaining</strong> is occurring. See section <a href="#SEC97">Chains of Implicit Rules</a>.</p>
<p>In general, <span style="font-family: courier, mono;">make</span> searches for an implicit rule for each target, and for each double-colon rule, that has no commands. A file that is mentioned only as a prerequisite is considered a target whose rule specifies nothing, so implicit rule search happens for it. See section <a href="#SEC107">Implicit Rule Search Algorithm</a>, for the details of how the search is done.</p>
<p>Note that explicit prerequisites do not influence implicit rule search. For example, consider this explicit rule:</p>
<p>foo.o: foo.p</p>
<p>The prerequisite on <tt>`foo.p'</tt> does not necessarily mean that <span style="font-family: courier, mono;">make</span> will remake <tt>`foo.o'</tt> according to the implicit rule to make an object file, a <tt>`.o'</tt> file, from a Pascal source file, a <tt>`.p'</tt> file. For example, if <tt>`foo.c'</tt> also exists, the implicit rule to make an object file from a C source file is used instead, because it appears before the Pascal rule in the list of predefined implicit rules (see section <a href="#SEC95">Catalogue of Implicit Rules</a>).</p>
<p>If you do not want an implicit rule to be used for a target that has no commands, you can give that target empty commands by writing a semicolon (see section <a href="#SEC56">Using Empty Commands</a>).</p>
<h2 class="subhead"><a id="SEC95" href="#TOC95" name="SEC95">Catalogue of Implicit Rules</a></h2>
<p><a id="IDX698" name="IDX698"></a><a id="IDX699" name="IDX699"></a> </p>
<p>Here is a catalogue of predefined implicit rules which are always available unless the makefile explicitly overrides or cancels them. See section <a href="#SEC104">Canceling Implicit Rules</a>, for information on canceling or overriding an implicit rule. The <samp>`-r'</samp> or <samp>`--no-builtin-rules'</samp> option cancels all predefined rules.</p>
<p>Not all of these rules will always be defined, even when the <samp>`-r'</samp> option is not given. Many of the predefined implicit rules are implemented in <span style="font-family: courier, mono;">make</span> as suffix rules, so which ones will be defined depends on the <strong>suffix list</strong> (the list of prerequisites of the special target <span style="font-family: courier, mono;">.SUFFIXES</span>). The default suffix list is: <span style="font-family: courier, mono;">.out</span>, <span style="font-family: courier, mono;">.a</span>, <span style="font-family: courier, mono;">.ln</span>, <span style="font-family: courier, mono;">.o</span>, <span style="font-family: courier, mono;">.c</span>, <span style="font-family: courier, mono;">.cc</span>, <span style="font-family: courier, mono;">.C</span>, <span style="font-family: courier, mono;">.p</span>, <span style="font-family: courier, mono;">.f</span>, <span style="font-family: courier, mono;">.F</span>, <span style="font-family: courier, mono;">.r</span>, <span style="font-family: courier, mono;">.y</span>, <span style="font-family: courier, mono;">.l</span>, <span style="font-family: courier, mono;">.s</span>, <span style="font-family: courier, mono;">.S</span>, <span style="font-family: courier, mono;">.mod</span>, <span style="font-family: courier, mono;">.sym</span>, <span style="font-family: courier, mono;">.def</span>, <span style="font-family: courier, mono;">.h</span>, <span style="font-family: courier, mono;">.info</span>, <span style="font-family: courier, mono;">.dvi</span>, <span style="font-family: courier, mono;">.tex</span>, <span style="font-family: courier, mono;">.texinfo</span>, <span style="font-family: courier, mono;">.texi</span>, <span style="font-family: courier, mono;">.txinfo</span>, <span style="font-family: courier, mono;">.w</span>, <span style="font-family: courier, mono;">.ch</span> <span style="font-family: courier, mono;">.web</span>, <span style="font-family: courier, mono;">.sh</span>, <span style="font-family: courier, mono;">.elc</span>, <span style="font-family: courier, mono;">.el</span>. All of the implicit rules described below whose prerequisites have one of these suffixes are actually suffix rules. If you modify the suffix list, the only predefined suffix rules in effect will be those named by one or two of the suffixes that are on the list you specify; rules whose suffixes fail to be on the list are disabled. See section <a href="#SEC106">Old-Fashioned Suffix Rules</a>, for full details on suffix rules.</p>
<dl compact>
<dt>Compiling C programs</dt>
<dd>
<a id="IDX700" name="IDX700"></a><a id="IDX701" name="IDX701"></a><a id="IDX702" name="IDX702"></a><a id="IDX703" name="IDX703"></a><a id="IDX704" name="IDX704"></a><tt>`<var>n</var>.o'</tt> is made automatically from <tt>`<var>n</var>.c'</tt> with a command of the form <samp>`$(CC) -c $(CPPFLAGS) $(CFLAGS)'</samp>.</dd>
<dt>Compiling C++ programs</dt>
<dd>
<a id="IDX705" name="IDX705"></a><a id="IDX706" name="IDX706"></a><a id="IDX707" name="IDX707"></a><a id="IDX708" name="IDX708"></a><tt>`<var>n</var>.o'</tt> is made automatically from <tt>`<var>n</var>.cc'</tt> or <tt>`<var>n</var>.C'</tt> with a command of the form <samp>`$(CXX) -c $(CPPFLAGS) $(CXXFLAGS)'</samp>. We encourage you to use the suffix <samp>`.cc'</samp> for C++ source files instead of <samp>`.C'</samp>.</dd>
<dt>Compiling Pascal programs</dt>
<dd>
<a id="IDX709" name="IDX709"></a><a id="IDX710" name="IDX710"></a><a id="IDX711" name="IDX711"></a><tt>`<var>n</var>.o'</tt> is made automatically from <tt>`<var>n</var>.p'</tt> with the command <samp>`$(PC) -c $(PFLAGS)'</samp>.</dd>
<dt>Compiling Fortran and Ratfor programs</dt>
<dd>
<a id="IDX712" name="IDX712"></a><a id="IDX713" name="IDX713"></a><a id="IDX714" name="IDX714"></a><a id="IDX715" name="IDX715"></a><a id="IDX716" name="IDX716"></a><a id="IDX717" name="IDX717"></a><tt>`<var>n</var>.o'</tt> is made automatically from <tt>`<var>n</var>.r'</tt>, <tt>`<var>n</var>.F'</tt> or <tt>`<var>n</var>.f'</tt> by running the Fortran compiler. The precise command used is as follows:
<dl compact>
<dt><samp>`.f'</samp></dt>
<dd>
<samp>`$(FC) -c $(FFLAGS)'</samp>.</dd>
<dt><samp>`.F'</samp></dt>
<dd>
<samp>`$(FC) -c $(FFLAGS) $(CPPFLAGS)'</samp>.</dd>
<dt><samp>`.r'</samp></dt>
<dd>
<samp>`$(FC) -c $(FFLAGS) $(RFLAGS)'</samp>.</dd>
</dl>
</dd>
<dt>Preprocessing Fortran and Ratfor programs</dt>
<dd>
<tt>`<var>n</var>.f'</tt> is made automatically from <tt>`<var>n</var>.r'</tt> or <tt>`<var>n</var>.F'</tt>. This rule runs just the preprocessor to convert a Ratfor or preprocessable Fortran program into a strict Fortran program. The precise command used is as follows:
<dl compact>
<dt><samp>`.F'</samp></dt>
<dd>
<samp>`$(FC) -F $(CPPFLAGS) $(FFLAGS)'</samp>.</dd>
<dt><samp>`.r'</samp></dt>
<dd>
<samp>`$(FC) -F $(FFLAGS) $(RFLAGS)'</samp>.</dd>
</dl>
</dd>
<dt>Compiling Modula-2 programs</dt>
<dd>
<a id="IDX718" name="IDX718"></a><a id="IDX719" name="IDX719"></a><a id="IDX720" name="IDX720"></a><a id="IDX721" name="IDX721"></a><a id="IDX722" name="IDX722"></a><tt>`<var>n</var>.sym'</tt> is made from <tt>`<var>n</var>.def'</tt> with a command of the form <samp>`$(M2C) $(M2FLAGS) $(DEFFLAGS)'</samp>. <tt>`<var>n</var>.o'</tt> is made from <tt>`<var>n</var>.mod'</tt>; the form is: <samp>`$(M2C) $(M2FLAGS) $(MODFLAGS)'</samp>.</dd>
<dt>Assembling and preprocessing assembler programs</dt>
<dd>
<a id="IDX723" name="IDX723"></a><a id="IDX724" name="IDX724"></a><a id="IDX725" name="IDX725"></a><tt>`<var>n</var>.o'</tt> is made automatically from <tt>`<var>n</var>.s'</tt> by running the assembler, <span style="font-family: courier, mono;">as</span>. The precise command is <samp>`$(AS) $(ASFLAGS)'</samp>. <a id="IDX726" name="IDX726"></a><tt>`<var>n</var>.s'</tt> is made automatically from <tt>`<var>n</var>.S'</tt> by running the C preprocessor, <span style="font-family: courier, mono;">cpp</span>. The precise command is <samp>`$(CPP) $(CPPFLAGS)'</samp>.</dd>
<dt>Linking a single object file</dt>
<dd>
<a id="IDX727" name="IDX727"></a><a id="IDX728" name="IDX728"></a><a id="IDX729" name="IDX729"></a><tt>`<var>n</var>'</tt> is made automatically from <tt>`<var>n</var>.o'</tt> by running the linker (usually called <span style="font-family: courier, mono;">ld</span>) via the C compiler. The precise command used is <samp>`$(CC) $(LDFLAGS) <var>n</var>.o $(LOADLIBES) $(LDLIBS)'</samp>. This rule does the right thing for a simple program with only one source file. It will also do the right thing if there are multiple object files (presumably coming from various other source files), one of which has a name matching that of the executable file. Thus,
<p>x: y.o z.o</p>
when <tt>`x.c'</tt>, <tt>`y.c'</tt> and <tt>`z.c'</tt> all exist will execute:
<p>cc -c x.c -o x.occ -c y.c -o y.occ -c z.c -o z.occ x.o y.o z.o -o xrm -f x.o rm -f y.orm -f z.o</p>
In more complicated cases, such as when there is no object file whose name derives from the executable file name, you must write an explicit command for linking. Each kind of file automatically made into <samp>`.o'</samp> object files will be automatically linked by using the compiler (<samp>`$(CC)'</samp>, <samp>`$(FC)'</samp> or <samp>`$(PC)'</samp>; the C compiler <samp>`$(CC)'</samp> is used to assemble <samp>`.s'</samp> files) without the <samp>`-c'</samp> option. This could be done by using the <samp>`.o'</samp> object files as intermediates, but it is faster to do the compiling and linking in one step, so that's how it's done.</dd>
<dt>Yacc for C programs</dt>
<dd>
<a id="IDX730" name="IDX730"></a><a id="IDX731" name="IDX731"></a><a id="IDX732" name="IDX732"></a><tt>`<var>n</var>.c'</tt> is made automatically from <tt>`<var>n</var>.y'</tt> by running Yacc with the command <samp>`$(YACC) $(YFLAGS)'</samp>.</dd>
<dt>Lex for C programs</dt>
<dd>
<a id="IDX733" name="IDX733"></a><a id="IDX734" name="IDX734"></a><a id="IDX735" name="IDX735"></a><tt>`<var>n</var>.c'</tt> is made automatically from <tt>`<var>n</var>.l'</tt> by by running Lex. The actual command is <samp>`$(LEX) $(LFLAGS)'</samp>.</dd>
<dt>Lex for Ratfor programs</dt>
<dd>
<tt>`<var>n</var>.r'</tt> is made automatically from <tt>`<var>n</var>.l'</tt> by by running Lex. The actual command is <samp>`$(LEX) $(LFLAGS)'</samp>. The convention of using the same suffix <samp>`.l'</samp> for all Lex files regardless of whether they produce C code or Ratfor code makes it impossible for <span style="font-family: courier, mono;">make</span> to determine automatically which of the two languages you are using in any particular case. If <span style="font-family: courier, mono;">make</span> is called upon to remake an object file from a <samp>`.l'</samp> file, it must guess which compiler to use. It will guess the C compiler, because that is more common. If you are using Ratfor, make sure <span style="font-family: courier, mono;">make</span> knows this by mentioning <tt>`<var>n</var>.r'</tt> in the makefile. Or, if you are using Ratfor exclusively, with no C files, remove <samp>`.c'</samp> from the list of implicit rule suffixes with:
<p>.SUFFIXES:.SUFFIXES: .o .r .f .l ...</p>
</dd>
<dt>Making Lint Libraries from C, Yacc, or Lex programs</dt>
<dd>
<a id="IDX736" name="IDX736"></a><a id="IDX737" name="IDX737"></a><a id="IDX738" name="IDX738"></a><tt>`<var>n</var>.ln'</tt> is made from <tt>`<var>n</var>.c'</tt> by running <span style="font-family: courier, mono;">lint</span>. The precise command is <samp>`$(LINT) $(LINTFLAGS) $(CPPFLAGS) -i'</samp>. The same command is used on the C code produced from <tt>`<var>n</var>.y'</tt> or <tt>`<var>n</var>.l'</tt>.</dd>
<dt>TeX and Web</dt>
<dd>
<a id="IDX739" name="IDX739"></a><a id="IDX740" name="IDX740"></a><a id="IDX741" name="IDX741"></a><a id="IDX742" name="IDX742"></a><a id="IDX743" name="IDX743"></a><a id="IDX744" name="IDX744"></a><a id="IDX745" name="IDX745"></a><a id="IDX746" name="IDX746"></a><a id="IDX747" name="IDX747"></a><a id="IDX748" name="IDX748"></a><a id="IDX749" name="IDX749"></a><a id="IDX750" name="IDX750"></a><tt>`<var>n</var>.dvi'</tt> is made from <tt>`<var>n</var>.tex'</tt> with the command <samp>`$(TEX)'</samp>. <tt>`<var>n</var>.tex'</tt> is made from <tt>`<var>n</var>.web'</tt> with <samp>`$(WEAVE)'</samp>, or from <tt>`<var>n</var>.w'</tt> (and from <tt>`<var>n</var>.ch'</tt> if it exists or can be made) with <samp>`$(CWEAVE)'</samp>. <tt>`<var>n</var>.p'</tt> is made from <tt>`<var>n</var>.web'</tt> with <samp>`$(TANGLE)'</samp> and <tt>`<var>n</var>.c'</tt> is made from <tt>`<var>n</var>.w'</tt> (and from <tt>`<var>n</var>.ch'</tt> if it exists or can be made) with <samp>`$(CTANGLE)'</samp>.</dd>
<dt>Texinfo and Info</dt>
<dd>
<a id="IDX751" name="IDX751"></a><a id="IDX752" name="IDX752"></a><a id="IDX753" name="IDX753"></a><a id="IDX754" name="IDX754"></a><a id="IDX755" name="IDX755"></a><a id="IDX756" name="IDX756"></a><a id="IDX757" name="IDX757"></a><a id="IDX758" name="IDX758"></a><tt>`<var>n</var>.dvi'</tt> is made from <tt>`<var>n</var>.texinfo'</tt>, <tt>`<var>n</var>.texi'</tt>, or <tt>`<var>n</var>.txinfo'</tt>, with the command <samp>`$(TEXI2DVI) $(TEXI2DVI_FLAGS)'</samp>. <tt>`<var>n</var>.info'</tt> is made from <tt>`<var>n</var>.texinfo'</tt>, <tt>`<var>n</var>.texi'</tt>, or <tt>`<var>n</var>.txinfo'</tt>, with the command <samp>`$(MAKEINFO) $(MAKEINFO_FLAGS)'</samp>.</dd>
<dt>RCS</dt>
<dd>
<a id="IDX759" name="IDX759"></a><a id="IDX760" name="IDX760"></a><a id="IDX761" name="IDX761"></a>Any file <tt>`<var>n</var>'</tt> is extracted if necessary from an RCS file named either <tt>`<var>n</var>,v'</tt> or <tt>`RCS/<var>n</var>,v'</tt>. The precise command used is <samp>`$(CO) $(COFLAGS)'</samp>. <tt>`<var>n</var>'</tt> will not be extracted from RCS if it already exists, even if the RCS file is newer. The rules for RCS are terminal (see section <a href="#SEC103">Match-Anything Pattern Rules</a>), so RCS files cannot be generated from another source; they must actually exist.</dd>
<dt>SCCS</dt>
<dd>
<a id="IDX762" name="IDX762"></a><a id="IDX763" name="IDX763"></a><a id="IDX764" name="IDX764"></a>Any file <tt>`<var>n</var>'</tt> is extracted if necessary from an SCCS file named either <tt>`s.<var>n</var>'</tt> or <tt>`SCCS/s.<var>n</var>'</tt>. The precise command used is <samp>`$(GET) $(GFLAGS)'</samp>. The rules for SCCS are terminal (see section <a href="#SEC103">Match-Anything Pattern Rules</a>), so SCCS files cannot be generated from another source; they must actually exist. <a id="IDX765" name="IDX765"></a>For the benefit of SCCS, a file <tt>`<var>n</var>'</tt> is copied from <tt>`<var>n</var>.sh'</tt> and made executable (by everyone). This is for shell scripts that are checked into SCCS. Since RCS preserves the execution permission of a file, you do not need to use this feature with RCS. We recommend that you avoid using of SCCS. RCS is widely held to be superior, and is also free. By choosing free software in place of comparable (or inferior) proprietary software, you support the free software movement.</dd>
</dl>
<p>Usually, you want to change only the variables listed in the table above, which are documented in the following section.</p>
<p>However, the commands in built-in implicit rules actually use variables such as <span style="font-family: courier, mono;">COMPILE.c</span>, <span style="font-family: courier, mono;">LINK.p</span>, and <span style="font-family: courier, mono;">PREPROCESS.S</span>, whose values contain the commands listed above.</p>
<p><span style="font-family: courier, mono;">make</span> follows the convention that the rule to compile a <tt>`.<var>x</var>'</tt> source file uses the variable <span style="font-family: courier, mono;">COMPILE.<var>x</var></span>. Similarly, the rule to produce an executable from a <tt>`.<var>x</var>'</tt> file uses <span style="font-family: courier, mono;">LINK.<var>x</var></span>; and the rule to preprocess a <tt>`.<var>x</var>'</tt> file uses <span style="font-family: courier, mono;">PREPROCESS.<var>x</var></span>.</p>
<p><a id="IDX766" name="IDX766"></a>Every rule that produces an object file uses the variable <span style="font-family: courier, mono;">OUTPUT_OPTION</span>. <span style="font-family: courier, mono;">make</span> defines this variable either to contain <samp>`-o $@'</samp>, or to be empty, depending on a compile-time option. You need the <samp>`-o'</samp> option to ensure that the output goes into the right file when the source file is in a different directory, as when using <span style="font-family: courier, mono;">VPATH</span> (see section <a href="#SEC26">Searching Directories for Prerequisites</a>). However, compilers on some systems do not accept a <samp>`-o'</samp> switch for object files. If you use such a system, and use <span style="font-family: courier, mono;">VPATH</span>, some compilations will put their output in the wrong place. A possible workaround for this problem is to give <span style="font-family: courier, mono;">OUTPUT_OPTION</span> the value <samp>`; mv $*.o $@'</samp>.</p>
<h2 class="subhead"><a id="SEC96" href="#TOC96" name="SEC96">Variables Used by Implicit Rules</a></h2>
<p><a id="IDX767" name="IDX767"></a> </p>
<p>The commands in built-in implicit rules make liberal use of certain predefined variables. You can alter these variables in the makefile, with arguments to <span style="font-family: courier, mono;">make</span>, or in the environment to alter how the implicit rules work without redefining the rules themselves. You can cancel all variables used by implicit rules with the <samp>`-R'</samp> or <samp>`--no-builtin-variables'</samp> option.</p>
<p>For example, the command used to compile a C source file actually says <samp>`$(CC) -c $(CFLAGS) $(CPPFLAGS)'</samp>. The default values of the variables used are <samp>`cc'</samp> and nothing, resulting in the command <samp>`cc -c'</samp>. By redefining <samp>`CC'</samp> to <samp>`ncc'</samp>, you could cause <samp>`ncc'</samp> to be used for all C compilations performed by the implicit rule. By redefining <samp>`CFLAGS'</samp> to be <samp>`-g'</samp>, you could pass the <samp>`-g'</samp> option to each compilation. <em>All</em> implicit rules that do C compilation use <samp>`$(CC)'</samp> to get the program name for the compiler and <em>all</em> include <samp>`$(CFLAGS)'</samp> among the arguments given to the compiler.</p>
<p>The variables used in implicit rules fall into two classes: those that are names of programs (like <span style="font-family: courier, mono;">CC</span>) and those that contain arguments for the programs (like <span style="font-family: courier, mono;">CFLAGS</span>). (The "name of a program" may also contain some command arguments, but it must start with an actual executable program name.) If a variable value contains more than one argument, separate them with spaces.</p>
<p>Here is a table of variables used as names of programs in built-in rules:</p>
<dl compact>
<dt><span style="font-family: courier, mono;">AR</span></dt>
<dd>
<a id="IDX768" name="IDX768"></a>Archive-maintaining program; default <samp>`ar'</samp>. <a id="IDX769" name="IDX769"></a>
</dd>
<dt><span style="font-family: courier, mono;">AS</span></dt>
<dd>
<a id="IDX770" name="IDX770"></a>Program for doing assembly; default <samp>`as'</samp>. <a id="IDX771" name="IDX771"></a>
</dd>
<dt><span style="font-family: courier, mono;">CC</span></dt>
<dd>
<a id="IDX772" name="IDX772"></a>Program for compiling C programs; default <samp>`cc'</samp>. <a id="IDX773" name="IDX773"></a>
</dd>
<dt><span style="font-family: courier, mono;">CXX</span></dt>
<dd>
<a id="IDX774" name="IDX774"></a>Program for compiling C++ programs; default <samp>`g++'</samp>. <a id="IDX775" name="IDX775"></a>
</dd>
<dt><span style="font-family: courier, mono;">CO</span></dt>
<dd>
<a id="IDX776" name="IDX776"></a>Program for extracting a file from RCS; default <samp>`co'</samp>. <a id="IDX777" name="IDX777"></a>
</dd>
<dt><span style="font-family: courier, mono;">CPP</span></dt>
<dd>
<a id="IDX778" name="IDX778"></a>Program for running the C preprocessor, with results to standard output; default <samp>`$(CC) -E'</samp>.</dd>
<dt><span style="font-family: courier, mono;">FC</span></dt>
<dd>
<a id="IDX779" name="IDX779"></a>Program for compiling or preprocessing Fortran and Ratfor programs; default <samp>`f77'</samp>. <a id="IDX780" name="IDX780"></a>
</dd>
<dt><span style="font-family: courier, mono;">GET</span></dt>
<dd>
<a id="IDX781" name="IDX781"></a>Program for extracting a file from SCCS; default <samp>`get'</samp>. <a id="IDX782" name="IDX782"></a>
</dd>
<dt><span style="font-family: courier, mono;">LEX</span></dt>
<dd>
<a id="IDX783" name="IDX783"></a>Program to use to turn Lex grammars into C programs or Ratfor programs; default <samp>`lex'</samp>. <a id="IDX784" name="IDX784"></a>
</dd>
<dt><span style="font-family: courier, mono;">PC</span></dt>
<dd>
<a id="IDX785" name="IDX785"></a>Program for compiling Pascal programs; default <samp>`pc'</samp>. <a id="IDX786" name="IDX786"></a>
</dd>
<dt><span style="font-family: courier, mono;">YACC</span></dt>
<dd>
<a id="IDX787" name="IDX787"></a>Program to use to turn Yacc grammars into C programs; default <samp>`yacc'</samp>. <a id="IDX788" name="IDX788"></a>
</dd>
<dt><span style="font-family: courier, mono;">YACCR</span></dt>
<dd>
<a id="IDX789" name="IDX789"></a>Program to use to turn Yacc grammars into Ratfor programs; default <samp>`yacc -r'</samp>.</dd>
<dt><span style="font-family: courier, mono;">MAKEINFO</span></dt>
<dd>
<a id="IDX790" name="IDX790"></a>Program to convert a Texinfo source file into an Info file; default <samp>`makeinfo'</samp>. <a id="IDX791" name="IDX791"></a>
</dd>
<dt><span style="font-family: courier, mono;">TEX</span></dt>
<dd>
<a id="IDX792" name="IDX792"></a>Program to make TeX DVI files from TeX source; default <samp>`tex'</samp>. <a id="IDX793" name="IDX793"></a>
</dd>
<dt><span style="font-family: courier, mono;">TEXI2DVI</span></dt>
<dd>
<a id="IDX794" name="IDX794"></a>Program to make TeX DVI files from Texinfo source; default <samp>`texi2dvi'</samp>. <a id="IDX795" name="IDX795"></a>
</dd>
<dt><span style="font-family: courier, mono;">WEAVE</span></dt>
<dd>
<a id="IDX796" name="IDX796"></a>Program to translate Web into TeX; default <samp>`weave'</samp>. <a id="IDX797" name="IDX797"></a>
</dd>
<dt><span style="font-family: courier, mono;">CWEAVE</span></dt>
<dd>
<a id="IDX798" name="IDX798"></a>Program to translate C Web into TeX; default <samp>`cweave'</samp>. <a id="IDX799" name="IDX799"></a>
</dd>
<dt><span style="font-family: courier, mono;">TANGLE</span></dt>
<dd>
<a id="IDX800" name="IDX800"></a>Program to translate Web into Pascal; default <samp>`tangle'</samp>. <a id="IDX801" name="IDX801"></a>
</dd>
<dt><span style="font-family: courier, mono;">CTANGLE</span></dt>
<dd>
<a id="IDX802" name="IDX802"></a>Program to translate C Web into C; default <samp>`ctangle'</samp>. <a id="IDX803" name="IDX803"></a>
</dd>
<dt><span style="font-family: courier, mono;">RM</span></dt>
<dd>
<a id="IDX804" name="IDX804"></a>Command to remove a file; default <samp>`rm -f'</samp>. <a id="IDX805" name="IDX805"></a>
</dd>
</dl>
<p>Here is a table of variables whose values are additional arguments for the programs above. The default values for all of these is the empty string, unless otherwise noted.</p>
<dl compact>
<dt><span style="font-family: courier, mono;">ARFLAGS</span></dt>
<dd>
<a id="IDX806" name="IDX806"></a>Flags to give the archive-maintaining program; default <samp>`rv'</samp>.</dd>
<dt><span style="font-family: courier, mono;">ASFLAGS</span></dt>
<dd>
<a id="IDX807" name="IDX807"></a>Extra flags to give to the assembler (when explicitly invoked on a <samp>`.s'</samp> or <samp>`.S'</samp> file).</dd>
<dt><span style="font-family: courier, mono;">CFLAGS</span></dt>
<dd>
<a id="IDX808" name="IDX808"></a>Extra flags to give to the C compiler.</dd>
<dt><span style="font-family: courier, mono;">CXXFLAGS</span></dt>
<dd>
<a id="IDX809" name="IDX809"></a>Extra flags to give to the C++ compiler.</dd>
<dt><span style="font-family: courier, mono;">COFLAGS</span></dt>
<dd>
<a id="IDX810" name="IDX810"></a>Extra flags to give to the RCS <span style="font-family: courier, mono;">co</span> program.</dd>
<dt><span style="font-family: courier, mono;">CPPFLAGS</span></dt>
<dd>
<a id="IDX811" name="IDX811"></a>Extra flags to give to the C preprocessor and programs that use it (the C and Fortran compilers).</dd>
<dt><span style="font-family: courier, mono;">FFLAGS</span></dt>
<dd>
<a id="IDX812" name="IDX812"></a>Extra flags to give to the Fortran compiler.</dd>
<dt><span style="font-family: courier, mono;">GFLAGS</span></dt>
<dd>
<a id="IDX813" name="IDX813"></a>Extra flags to give to the SCCS <span style="font-family: courier, mono;">get</span> program.</dd>
<dt><span style="font-family: courier, mono;">LDFLAGS</span></dt>
<dd>
<a id="IDX814" name="IDX814"></a>Extra flags to give to compilers when they are supposed to invoke the linker, <samp>`ld'</samp>.</dd>
<dt><span style="font-family: courier, mono;">LFLAGS</span></dt>
<dd>
<a id="IDX815" name="IDX815"></a>Extra flags to give to Lex.</dd>
<dt><span style="font-family: courier, mono;">PFLAGS</span></dt>
<dd>
<a id="IDX816" name="IDX816"></a>Extra flags to give to the Pascal compiler.</dd>
<dt><span style="font-family: courier, mono;">RFLAGS</span></dt>
<dd>
<a id="IDX817" name="IDX817"></a>Extra flags to give to the Fortran compiler for Ratfor programs.</dd>
<dt><span style="font-family: courier, mono;">YFLAGS</span></dt>
<dd>
<a id="IDX818" name="IDX818"></a>Extra flags to give to Yacc.</dd>
</dl>
<h2 class="subhead"><a id="SEC97" href="#TOC97" name="SEC97">Chains of Implicit Rules</a></h2>
<p><a id="IDX819" name="IDX819"></a><a id="IDX820" name="IDX820"></a>Sometimes a file can be made by a sequence of implicit rules. For example, a file <tt>`<var>n</var>.o'</tt> could be made from <tt>`<var>n</var>.y'</tt> by running first Yacc and then <span style="font-family: courier, mono;">cc</span>. Such a sequence is called a <strong>chain</strong>.</p>
<p>If the file <tt>`<var>n</var>.c'</tt> exists, or is mentioned in the makefile, no special searching is required: <span style="font-family: courier, mono;">make</span> finds that the object file can be made by C compilation from <tt>`<var>n</var>.c'</tt>; later on, when considering how to make <tt>`<var>n</var>.c'</tt>, the rule for running Yacc is used. Ultimately both <tt>`<var>n</var>.c'</tt> and <tt>`<var>n</var>.o'</tt> are updated.</p>
<p><a id="IDX821" name="IDX821"></a><a id="IDX822" name="IDX822"></a>However, even if <tt>`<var>n</var>.c'</tt> does not exist and is not mentioned, <span style="font-family: courier, mono;">make</span> knows how to envision it as the missing link between <tt>`<var>n</var>.o'</tt> and <tt>`<var>n</var>.y'</tt>! In this case, <tt>`<var>n</var>.c'</tt> is called an <strong>intermediate file</strong>. Once <span style="font-family: courier, mono;">make</span> has decided to use the intermediate file, it is entered in the data base as if it had been mentioned in the makefile, along with the implicit rule that says how to create it.</p>
<p>Intermediate files are remade using their rules just like all other files. But intermediate files are treated differently in two ways.</p>
<p>The first difference is what happens if the intermediate file does not exist. If an ordinary file <var>b</var> does not exist, and <span style="font-family: courier, mono;">make</span> considers a target that depends on <var>b</var>, it invariably creates <var>b</var> and then updates the target from <var>b</var>. But if <var>b</var> is an intermediate file, then <span style="font-family: courier, mono;">make</span> can leave well enough alone. It won't bother updating <var>b</var>, or the ultimate target, unless some prerequisite of <var>b</var> is newer than that target or there is some other reason to update that target.</p>
<p>The second difference is that if <span style="font-family: courier, mono;">make</span> <em>does</em> create <var>b</var> in order to update something else, it deletes <var>b</var> later on after it is no longer needed. Therefore, an intermediate file which did not exist before <span style="font-family: courier, mono;">make</span> also does not exist after <span style="font-family: courier, mono;">make</span>. <span style="font-family: courier, mono;">make</span> reports the deletion to you by printing a <samp>`rm -f'</samp> command showing which file it is deleting.</p>
<p>Ordinarily, a file cannot be intermediate if it is mentioned in the makefile as a target or prerequisite. However, you can explicitly mark a file as intermediate by listing it as a prerequisite of the special target <span style="font-family: courier, mono;">.INTERMEDIATE</span>. This takes effect even if the file is mentioned explicitly in some other way.</p>
<p><a id="IDX823" name="IDX823"></a><a id="IDX824" name="IDX824"></a><a id="IDX825" name="IDX825"></a>You can prevent automatic deletion of an intermediate file by marking it as a <strong>secondary</strong> file. To do this, list it as a prerequisite of the special target <span style="font-family: courier, mono;">.SECONDARY</span>. When a file is secondary, <span style="font-family: courier, mono;">make</span> will not create the file merely because it does not already exist, but <span style="font-family: courier, mono;">make</span> does not automatically delete the file. Marking a file as secondary also marks it as intermediate.</p>
<p>You can list the target pattern of an implicit rule (such as <samp>`%.o'</samp>) as a prerequisite of the special target <span style="font-family: courier, mono;">.PRECIOUS</span> to preserve intermediate files made by implicit rules whose target patterns match that file's name; see section <a href="#SEC49">Interrupting or Killing <span style="font-family: courier, mono;">make</span></a>.<a id="IDX826" name="IDX826"></a><a id="IDX827" name="IDX827"></a></p>
<p>A chain can involve more than two implicit rules. For example, it is possible to make a file <tt>`foo'</tt> from <tt>`RCS/foo.y,v'</tt> by running RCS, Yacc and <span style="font-family: courier, mono;">cc</span>. Then both <tt>`foo.y'</tt> and <tt>`foo.c'</tt> are intermediate files that are deleted at the end.</p>
<p>No single implicit rule can appear more than once in a chain. This means that <span style="font-family: courier, mono;">make</span> will not even consider such a ridiculous thing as making <tt>`foo'</tt> from <tt>`foo.o.o'</tt> by running the linker twice. This constraint has the added benefit of preventing any infinite loop in the search for an implicit rule chain.</p>
<p>There are some special implicit rules to optimize certain cases that would otherwise be handled by rule chains. For example, making <tt>`foo'</tt> from <tt>`foo.c'</tt> could be handled by compiling and linking with separate chained rules, using <tt>`foo.o'</tt> as an intermediate file. But what actually happens is that a special rule for this case does the compilation and linking with a single <span style="font-family: courier, mono;">cc</span> command. The optimized rule is used in preference to the step-by-step chain because it comes earlier in the ordering of rules.</p>
<h2 class="subhead"><a id="SEC98" href="#TOC98" name="SEC98">Defining and Redefining Pattern Rules</a></h2>
<p>You define an implicit rule by writing a <strong>pattern rule</strong>. A pattern rule looks like an ordinary rule, except that its target contains the character <samp>`%'</samp> (exactly one of them). The target is considered a pattern for matching file names; the <samp>`%'</samp> can match any nonempty substring, while other characters match only themselves. The prerequisites likewise use <samp>`%'</samp> to show how their names relate to the target name.</p>
<p>Thus, a pattern rule <samp>`%.o : %.c'</samp> says how to make any file <tt>`<var>stem</var>.o'</tt> from another file <tt>`<var>stem</var>.c'</tt>.</p>
<p>Note that expansion using <samp>`%'</samp> in pattern rules occurs <strong>after</strong> any variable or function expansions, which take place when the makefile is read. See section <a href="#SEC57">How to Use Variables</a>, and section <a href="#SEC75">Functions for Transforming Text</a>.</p>
<h3 class="subsubhead"><a id="SEC99" href="#TOC99" name="SEC99">Introduction to Pattern Rules</a></h3>
<p><a id="IDX828" name="IDX828"></a><a id="IDX829" name="IDX829"></a> </p>
<p>A pattern rule contains the character <samp>`%'</samp> (exactly one of them) in the target; otherwise, it looks exactly like an ordinary rule. The target is a pattern for matching file names; the <samp>`%'</samp> matches any nonempty substring, while other characters match only themselves. <a id="IDX830" name="IDX830"></a><a id="IDX831" name="IDX831"></a></p>
<p>For example, <samp>`%.c'</samp> as a pattern matches any file name that ends in <samp>`.c'</samp>. <samp>`s.%.c'</samp> as a pattern matches any file name that starts with <samp>`s.'</samp>, ends in <samp>`.c'</samp> and is at least five characters long. (There must be at least one character to match the <samp>`%'</samp>.) The substring that the <samp>`%'</samp> matches is called the <strong>stem</strong>.</p>
<p><samp>`%'</samp> in a prerequisite of a pattern rule stands for the same stem that was matched by the <samp>`%'</samp> in the target. In order for the pattern rule to apply, its target pattern must match the file name under consideration, and its prerequisite patterns must name files that exist or can be made. These files become prerequisites of the target. <a id="IDX832" name="IDX832"></a></p>
<p>Thus, a rule of the form</p>
<p>%.o : %.c ; <var>command</var>...</p>
<p>specifies how to make a file <tt>`<var>n</var>.o'</tt>, with another file <tt>`<var>n</var>.c'</tt> as its prerequisite, provided that <tt>`<var>n</var>.c'</tt> exists or can be made.</p>
<p>There may also be prerequisites that do not use <samp>`%'</samp>; such a prerequisite attaches to every file made by this pattern rule. These unvarying prerequisites are useful occasionally.</p>
<p>A pattern rule need not have any prerequisites that contain <samp>`%'</samp>, or in fact any prerequisites at all. Such a rule is effectively a general wildcard. It provides a way to make any file that matches the target pattern. See section <a href="#SEC105">Defining Last-Resort Default Rules</a>.</p>
<p>Pattern rules may have more than one target. Unlike normal rules, this does not act as many different rules with the same prerequisites and commands. If a pattern rule has multiple targets, <span style="font-family: courier, mono;">make</span> knows that the rule's commands are responsible for making all of the targets. The commands are executed only once to make all the targets. When searching for a pattern rule to match a target, the target patterns of a rule other than the one that matches the target in need of a rule are incidental: <span style="font-family: courier, mono;">make</span> worries only about giving commands and prerequisites to the file presently in question. However, when this file's commands are run, the other targets are marked as having been updated themselves. <a id="IDX833" name="IDX833"></a><a id="IDX834" name="IDX834"></a></p>
<p>The order in which pattern rules appear in the makefile is important since this is the order in which they are considered. Of equally applicable rules, only the first one found is used. The rules you write take precedence over those that are built in. Note however, that a rule whose prerequisites actually exist or are mentioned always takes priority over a rule with prerequisites that must be made by chaining other implicit rules. <a id="IDX835" name="IDX835"></a><a id="IDX836" name="IDX836"></a></p>
<h3 class="subsubhead"><a id="SEC100" href="#TOC100" name="SEC100">Pattern Rule Examples</a></h3>
<p>Here are some examples of pattern rules actually predefined in <span style="font-family: courier, mono;">make</span>. First, the rule that compiles <samp>`.c'</samp> files into <samp>`.o'</samp> files:</p>
<p>%.o : %.c $(CC) -c $(CFLAGS) $(CPPFLAGS) $&lt; -o $@</p>
<p>defines a rule that can make any file <tt>`<var>x</var>.o'</tt> from <tt>`<var>x</var>.c'</tt>. The command uses the automatic variables <samp>`$@'</samp> and <samp>`$&lt;'</samp> to substitute the names of the target file and the source file in each case where the rule applies (see section <a href="#SEC101">Automatic Variables</a>).</p>
<p>Here is a second built-in rule:</p>
<p>% :: RCS/%,v $(CO) $(COFLAGS) $&lt;</p>
<p>defines a rule that can make any file <tt>`<var>x</var>'</tt> whatsoever from a corresponding file <tt>`<var>x</var>,v'</tt> in the subdirectory <tt>`RCS'</tt>. Since the target is <samp>`%'</samp>, this rule will apply to any file whatever, provided the appropriate prerequisite file exists. The double colon makes the rule <strong>terminal</strong>, which means that its prerequisite may not be an intermediate file (see section <a href="#SEC103">Match-Anything Pattern Rules</a>).</p>
<p>This pattern rule has two targets:</p>
<p>%.tab.c %.tab.h: %.y bison -d $&lt;</p>
<p>This tells <span style="font-family: courier, mono;">make</span> that the command <samp>`bison -d <var>x</var>.y'</samp> will make both <tt>`<var>x</var>.tab.c'</tt> and <tt>`<var>x</var>.tab.h'</tt>. If the file <tt>`foo'</tt> depends on the files <tt>`parse.tab.o'</tt> and <tt>`scan.o'</tt> and the file <tt>`scan.o'</tt> depends on the file <tt>`parse.tab.h'</tt>, when <tt>`parse.y'</tt> is changed, the command <samp>`bison -d parse.y'</samp> will be executed only once, and the prerequisites of both <tt>`parse.tab.o'</tt> and <tt>`scan.o'</tt> will be satisfied. (Presumably the file <tt>`parse.tab.o'</tt> will be recompiled from <tt>`parse.tab.c'</tt> and the file <tt>`scan.o'</tt> from <tt>`scan.c'</tt>, while <tt>`foo'</tt> is linked from <tt>`parse.tab.o'</tt>, <tt>`scan.o'</tt>, and its other prerequisites, and it will execute happily ever after.)</p>
<h3 class="subsubhead"><a id="SEC101" href="#TOC101" name="SEC101">Automatic Variables</a></h3>
<p><a id="IDX837" name="IDX837"></a><a id="IDX838" name="IDX838"></a><a id="IDX839" name="IDX839"></a> </p>
<p>Suppose you are writing a pattern rule to compile a <samp>`.c'</samp> file into a <samp>`.o'</samp> file: how do you write the <samp>`cc'</samp> command so that it operates on the right source file name? You cannot write the name in the command, because the name is different each time the implicit rule is applied.</p>
<p>What you do is use a special feature of <span style="font-family: courier, mono;">make</span>, the <strong>automatic variables</strong>. These variables have values computed afresh for each rule that is executed, based on the target and prerequisites of the rule. In this example, you would use <samp>`$@'</samp> for the object file name and <samp>`$&lt;'</samp> for the source file name.</p>
<p>Here is a table of automatic variables:</p>
<dl compact>
<dt><span style="font-family: courier, mono;">$@</span></dt>
<dd>
<a id="IDX840" name="IDX840"></a><a id="IDX841" name="IDX841"></a>The file name of the target of the rule. If the target is an archive member, then <samp>`$@'</samp> is the name of the archive file. In a pattern rule that has multiple targets (see section <a href="#SEC99">Introduction to Pattern Rules</a>), <samp>`$@'</samp> is the name of whichever target caused the rule's commands to be run. <a id="IDX842" name="IDX842"></a><a id="IDX843" name="IDX843"></a>
</dd>
<dt><span style="font-family: courier, mono;">$%</span></dt>
<dd>The target member name, when the target is an archive member. See section <a href="#SEC108">Using <span style="font-family: courier, mono;">make</span> to Update Archive Files</a>. For example, if the target is <tt>`foo.a(bar.o)'</tt> then <samp>`$%'</samp> is <tt>`bar.o'</tt> and <samp>`$@'</samp> is <tt>`foo.a'</tt>. <samp>`$%'</samp> is empty when the target is not an archive member. <a id="IDX844" name="IDX844"></a><a id="IDX845" name="IDX845"></a>
</dd>
<dt><span style="font-family: courier, mono;">$&lt;</span></dt>
<dd>The name of the first prerequisite. If the target got its commands from an implicit rule, this will be the first prerequisite added by the implicit rule (see section <a href="#SEC93">Using Implicit Rules</a>). <a id="IDX846" name="IDX846"></a><a id="IDX847" name="IDX847"></a>
</dd>
<dt><span style="font-family: courier, mono;">$?</span></dt>
<dd>The names of all the prerequisites that are newer than the target, with spaces between them. For prerequisites which are archive members, only the member named is used (see section <a href="#SEC108">Using <span style="font-family: courier, mono;">make</span> to Update Archive Files</a>). <a id="IDX848" name="IDX848"></a><a id="IDX849" name="IDX849"></a><a id="IDX850" name="IDX850"></a><a id="IDX851" name="IDX851"></a>
</dd>
<dt><span style="font-family: courier, mono;">$^</span></dt>
<dd>The names of all the prerequisites, with spaces between them. For prerequisites which are archive members, only the member named is used (see section <a href="#SEC108">Using <span style="font-family: courier, mono;">make</span> to Update Archive Files</a>). A target has only one prerequisite on each other file it depends on, no matter how many times each file is listed as a prerequisite. So if you list a prerequisite more than once for a target, the value of <span style="font-family: courier, mono;">$^</span> contains just one copy of the name. <a id="IDX852" name="IDX852"></a><a id="IDX853" name="IDX853"></a><a id="IDX854" name="IDX854"></a><a id="IDX855" name="IDX855"></a>
</dd>
<dt><span style="font-family: courier, mono;">$+</span></dt>
<dd>This is like <samp>`$^'</samp>, but prerequisites listed more than once are duplicated in the order they were listed in the makefile. This is primarily useful for use in linking commands where it is meaningful to repeat library file names in a particular order. <a id="IDX856" name="IDX856"></a><a id="IDX857" name="IDX857"></a>
</dd>
<dt><span style="font-family: courier, mono;">$*</span></dt>
<dd>The stem with which an implicit rule matches (see section <a href="#SEC102">How Patterns Match</a>). If the target is <tt>`dir/a.foo.b'</tt> and the target pattern is <tt>`a.%.b'</tt> then the stem is <tt>`dir/foo'</tt>. The stem is useful for constructing names of related files.<a id="IDX858" name="IDX858"></a>In a static pattern rule, the stem is part of the file name that matched the <samp>`%'</samp> in the target pattern. In an explicit rule, there is no stem; so <samp>`$*'</samp> cannot be determined in that way. Instead, if the target name ends with a recognized suffix (see section <a href="#SEC106">Old-Fashioned Suffix Rules</a>), <samp>`$*'</samp> is set to the target name minus the suffix. For example, if the target name is <samp>`foo.c'</samp>, then <samp>`$*'</samp> is set to <samp>`foo'</samp>, since <samp>`.c'</samp> is a suffix. GNU <span style="font-family: courier, mono;">make</span> does this bizarre thing only for compatibility with other implementations of <span style="font-family: courier, mono;">make</span>. You should generally avoid using <samp>`$*'</samp> except in implicit rules or static pattern rules. If the target name in an explicit rule does not end with a recognized suffix, <samp>`$*'</samp> is set to the empty string for that rule.</dd>
</dl>
<p><samp>`$?'</samp> is useful even in explicit rules when you wish to operate on only the prerequisites that have changed. For example, suppose that an archive named <tt>`lib'</tt> is supposed to contain copies of several object files. This rule copies just the changed object files into the archive:</p>
<p>lib: foo.o bar.o lose.o win.o ar r lib $?</p>
<p>Of the variables listed above, four have values that are single file names, and three have values that are lists of file names. These seven have variants that get just the file's directory name or just the file name within the directory. The variant variables' names are formed by appending <samp>`D'</samp> or <samp>`F'</samp>, respectively. These variants are semi-obsolete in GNU <span style="font-family: courier, mono;">make</span> since the functions <span style="font-family: courier, mono;">dir</span> and <span style="font-family: courier, mono;">notdir</span> can be used to get a similar effect (see section <a href="#SEC78">Functions for File Names</a>). Note, however, that the <samp>`F'</samp> variants all omit the trailing slash which always appears in the output of the <span style="font-family: courier, mono;">dir</span> function. Here is a table of the variants:</p>
<dl compact>
<dt><samp>`$(@D)'</samp></dt>
<dd>
<a id="IDX859" name="IDX859"></a><a id="IDX860" name="IDX860"></a>The directory part of the file name of the target, with the trailing slash removed. If the value of <samp>`$@'</samp> is <tt>`dir/foo.o'</tt> then <samp>`$(@D)'</samp> is <tt>`dir'</tt>. This value is <tt>`.'</tt> if <samp>`$@'</samp> does not contain a slash. <a id="IDX861" name="IDX861"></a><a id="IDX862" name="IDX862"></a>
</dd>
<dt><samp>`$(@F)'</samp></dt>
<dd>The file-within-directory part of the file name of the target. If the value of <samp>`$@'</samp> is <tt>`dir/foo.o'</tt> then <samp>`$(@F)'</samp> is <tt>`foo.o'</tt>. <samp>`$(@F)'</samp> is equivalent to <samp>`$(notdir $@)'</samp>. <a id="IDX863" name="IDX863"></a><a id="IDX864" name="IDX864"></a>
</dd>
<dt><samp>`$(*D)'</samp></dt>
<dd>
<a id="IDX865" name="IDX865"></a><a id="IDX866" name="IDX866"></a>
</dd>
<dt><samp>`$(*F)'</samp></dt>
<dd>The directory part and the file-within-directory part of the stem; <tt>`dir'</tt> and <tt>`foo'</tt> in this example. <a id="IDX867" name="IDX867"></a><a id="IDX868" name="IDX868"></a>
</dd>
<dt><samp>`$(%D)'</samp></dt>
<dd>
<a id="IDX869" name="IDX869"></a><a id="IDX870" name="IDX870"></a>
</dd>
<dt><samp>`$(%F)'</samp></dt>
<dd>The directory part and the file-within-directory part of the target archive member name. This makes sense only for archive member targets of the form <tt>`<var>archive</var>(<var>member</var>)'</tt> and is useful only when <var>member</var> may contain a directory name. (See section <a href="#SEC109">Archive Members as Targets</a>.) <a id="IDX871" name="IDX871"></a><a id="IDX872" name="IDX872"></a>
</dd>
<dt><samp>`$(&lt;D)'</samp></dt>
<dd>
<a id="IDX873" name="IDX873"></a><a id="IDX874" name="IDX874"></a>
</dd>
<dt><samp>`$(&lt;F)'</samp></dt>
<dd>The directory part and the file-within-directory part of the first prerequisite. <a id="IDX875" name="IDX875"></a><a id="IDX876" name="IDX876"></a>
</dd>
<dt><samp>`$(^D)'</samp></dt>
<dd>
<a id="IDX877" name="IDX877"></a><a id="IDX878" name="IDX878"></a>
</dd>
<dt><samp>`$(^F)'</samp></dt>
<dd>Lists of the directory parts and the file-within-directory parts of all prerequisites. <a id="IDX879" name="IDX879"></a><a id="IDX880" name="IDX880"></a>
</dd>
<dt><samp>`$(?D)'</samp></dt>
<dd>
<a id="IDX881" name="IDX881"></a><a id="IDX882" name="IDX882"></a>
</dd>
<dt><samp>`$(?F)'</samp></dt>
<dd>Lists of the directory parts and the file-within-directory parts of all prerequisites that are newer than the target.</dd>
</dl>
<p>Note that we use a special stylistic convention when we talk about these automatic variables; we write "the value of <samp>`$&lt;'</samp>", rather than "the variable <span style="font-family: courier, mono;">&lt;</span>" as we would write for ordinary variables such as <span style="font-family: courier, mono;">objects</span> and <span style="font-family: courier, mono;">CFLAGS</span>. We think this convention looks more natural in this special case. Please do not assume it has a deep significance; <samp>`$&lt;'</samp> refers to the variable named <span style="font-family: courier, mono;">&lt;</span> just as <samp>`$(CFLAGS)'</samp> refers to the variable named <span style="font-family: courier, mono;">CFLAGS</span>. You could just as well use <samp>`$(&lt;)'</samp> in place of <samp>`$&lt;'</samp>.</p>
<h3 class="subsubhead"><a id="SEC102" href="#TOC102" name="SEC102">How Patterns Match</a></h3>
<p><a id="IDX883" name="IDX883"></a>A target pattern is composed of a <samp>`%'</samp> between a prefix and a suffix, either or both of which may be empty. The pattern matches a file name only if the file name starts with the prefix and ends with the suffix, without overlap. The text between the prefix and the suffix is called the <strong>stem</strong>. Thus, when the pattern <samp>`%.o'</samp> matches the file name <tt>`test.o'</tt>, the stem is <samp>`test'</samp>. The pattern rule prerequisites are turned into actual file names by substituting the stem for the character <samp>`%'</samp>. Thus, if in the same example one of the prerequisites is written as <samp>`%.c'</samp>, it expands to <samp>`test.c'</samp>.</p>
<p>When the target pattern does not contain a slash (and it usually does not), directory names in the file names are removed from the file name before it is compared with the target prefix and suffix. After the comparison of the file name to the target pattern, the directory names, along with the slash that ends them, are added on to the prerequisite file names generated from the pattern rule's prerequisite patterns and the file name. The directories are ignored only for the purpose of finding an implicit rule to use, not in the application of that rule. Thus, <samp>`e%t'</samp> matches the file name <tt>`src/eat'</tt>, with <samp>`src/a'</samp> as the stem. When prerequisites are turned into file names, the directories from the stem are added at the front, while the rest of the stem is substituted for the <samp>`%'</samp>. The stem <samp>`src/a'</samp> with a prerequisite pattern <samp>`c%r'</samp> gives the file name <tt>`src/car'</tt>.</p>
<h3 class="subsubhead"><a id="SEC103" href="#TOC103" name="SEC103">Match-Anything Pattern Rules</a></h3>
<p><a id="IDX884" name="IDX884"></a><a id="IDX885" name="IDX885"></a>When a pattern rule's target is just <samp>`%'</samp>, it matches any file name whatever. We call these rules <strong>match-anything</strong> rules. They are very useful, but it can take a lot of time for <span style="font-family: courier, mono;">make</span> to think about them, because it must consider every such rule for each file name listed either as a target or as a prerequisite.</p>
<p>Suppose the makefile mentions <tt>`foo.c'</tt>. For this target, <span style="font-family: courier, mono;">make</span> would have to consider making it by linking an object file <tt>`foo.c.o'</tt>, or by C compilation-and-linking in one step from <tt>`foo.c.c'</tt>, or by Pascal compilation-and-linking from <tt>`foo.c.p'</tt>, and many other possibilities.</p>
<p>We know these possibilities are ridiculous since <tt>`foo.c'</tt> is a C source file, not an executable. If <span style="font-family: courier, mono;">make</span> did consider these possibilities, it would ultimately reject them, because files such as <tt>`foo.c.o'</tt> and <tt>`foo.c.p'</tt> would not exist. But these possibilities are so numerous that <span style="font-family: courier, mono;">make</span> would run very slowly if it had to consider them.</p>
<p>To gain speed, we have put various constraints on the way <span style="font-family: courier, mono;">make</span> considers match-anything rules. There are two different constraints that can be applied, and each time you define a match-anything rule you must choose one or the other for that rule.</p>
<p>One choice is to mark the match-anything rule as <strong>terminal</strong> by defining it with a double colon. When a rule is terminal, it does not apply unless its prerequisites actually exist. Prerequisites that could be made with other implicit rules are not good enough. In other words, no further chaining is allowed beyond a terminal rule.</p>
<p>For example, the built-in implicit rules for extracting sources from RCS and SCCS files are terminal; as a result, if the file <tt>`foo.c,v'</tt> does not exist, <span style="font-family: courier, mono;">make</span> will not even consider trying to make it as an intermediate file from <tt>`foo.c,v.o'</tt> or from <tt>`RCS/SCCS/s.foo.c,v'</tt>. RCS and SCCS files are generally ultimate source files, which should not be remade from any other files; therefore, <span style="font-family: courier, mono;">make</span> can save time by not looking for ways to remake them.</p>
<p>If you do not mark the match-anything rule as terminal, then it is nonterminal. A nonterminal match-anything rule cannot apply to a file name that indicates a specific type of data. A file name indicates a specific type of data if some non-match-anything implicit rule target matches it.</p>
<p>For example, the file name <tt>`foo.c'</tt> matches the target for the pattern rule <samp>`%.c : %.y'</samp> (the rule to run Yacc). Regardless of whether this rule is actually applicable (which happens only if there is a file <tt>`foo.y'</tt>), the fact that its target matches is enough to prevent consideration of any nonterminal match-anything rules for the file <tt>`foo.c'</tt>. Thus, <span style="font-family: courier, mono;">make</span> will not even consider trying to make <tt>`foo.c'</tt> as an executable file from <tt>`foo.c.o'</tt>, <tt>`foo.c.c'</tt>, <tt>`foo.c.p'</tt>, etc.</p>
<p>The motivation for this constraint is that nonterminal match-anything rules are used for making files containing specific types of data (such as executable files) and a file name with a recognized suffix indicates some other specific type of data (such as a C source file).</p>
<p>Special built-in dummy pattern rules are provided solely to recognize certain file names so that nonterminal match-anything rules will not be considered. These dummy rules have no prerequisites and no commands, and they are ignored for all other purposes. For example, the built-in implicit rule</p>
<p>%.p :</p>
<p>exists to make sure that Pascal source files such as <tt>`foo.p'</tt> match a specific target pattern and thereby prevent time from being wasted looking for <tt>`foo.p.o'</tt> or <tt>`foo.p.c'</tt>.</p>
<p>Dummy pattern rules such as the one for <samp>`%.p'</samp> are made for every suffix listed as valid for use in suffix rules (see section <a href="#SEC106">Old-Fashioned Suffix Rules</a>).</p>
<h3 class="subsubhead"><a id="SEC104" href="#TOC104" name="SEC104">Canceling Implicit Rules</a></h3>
<p>You can override a built-in implicit rule (or one you have defined yourself) by defining a new pattern rule with the same target and prerequisites, but different commands. When the new rule is defined, the built-in one is replaced. The new rule's position in the sequence of implicit rules is determined by where you write the new rule.</p>
<p>You can cancel a built-in implicit rule by defining a pattern rule with the same target and prerequisites, but no commands. For example, the following would cancel the rule that runs the assembler:</p>
<p>%.o : %.s</p>
<h2 class="subhead"><a id="SEC105" href="#TOC105" name="SEC105">Defining Last-Resort Default Rules</a></h2>
<p><a id="IDX886" name="IDX886"></a><a id="IDX887" name="IDX887"></a></p>
<p>You can define a last-resort implicit rule by writing a terminal match-anything pattern rule with no prerequisites (see section <a href="#SEC103">Match-Anything Pattern Rules</a>). This is just like any other pattern rule; the only thing special about it is that it will match any target. So such a rule's commands are used for all targets and prerequisites that have no commands of their own and for which no other implicit rule applies.</p>
<p>For example, when testing a makefile, you might not care if the source files contain real data, only that they exist. Then you might do this:</p>
<p>%:: touch $@</p>
<p>to cause all the source files needed (as prerequisites) to be created automatically.</p>
<p><a id="IDX888" name="IDX888"></a>You can instead define commands to be used for targets for which there are no rules at all, even ones which don't specify commands. You do this by writing a rule for the target <span style="font-family: courier, mono;">.DEFAULT</span>. Such a rule's commands are used for all prerequisites which do not appear as targets in any explicit rule, and for which no implicit rule applies. Naturally, there is no <span style="font-family: courier, mono;">.DEFAULT</span> rule unless you write one.</p>
<p>If you use <span style="font-family: courier, mono;">.DEFAULT</span> with no commands or prerequisites:</p>
<p>.DEFAULT:</p>
<p>the commands previously stored for <span style="font-family: courier, mono;">.DEFAULT</span> are cleared. Then <span style="font-family: courier, mono;">make</span> acts as if you had never defined <span style="font-family: courier, mono;">.DEFAULT</span> at all.</p>
<p>If you do not want a target to get the commands from a match-anything pattern rule or <span style="font-family: courier, mono;">.DEFAULT</span>, but you also do not want any commands to be run for the target, you can give it empty commands (see section <a href="#SEC56">Using Empty Commands</a>).</p>
<p>You can use a last-resort rule to override part of another makefile. See section <a href="#SEC18">Overriding Part of Another Makefile</a>.</p>
<h2 class="subhead"><a id="SEC106" href="#TOC106" name="SEC106">Old-Fashioned Suffix Rules</a></h2>
<p><a id="IDX889" name="IDX889"></a><a id="IDX890" name="IDX890"></a></p>
<p><strong>Suffix rules</strong> are the old-fashioned way of defining implicit rules for <span style="font-family: courier, mono;">make</span>. Suffix rules are obsolete because pattern rules are more general and clearer. They are supported in GNU <span style="font-family: courier, mono;">make</span> for compatibility with old makefiles. They come in two kinds: <strong>double-suffix</strong> and <strong>single-suffix</strong>.</p>
<p>A double-suffix rule is defined by a pair of suffixes: the target suffix and the source suffix. It matches any file whose name ends with the target suffix. The corresponding implicit prerequisite is made by replacing the target suffix with the source suffix in the file name. A two-suffix rule whose target and source suffixes are <samp>`.o'</samp> and <samp>`.c'</samp> is equivalent to the pattern rule <samp>`%.o : %.c'</samp>.</p>
<p>A single-suffix rule is defined by a single suffix, which is the source suffix. It matches any file name, and the corresponding implicit prerequisite name is made by appending the source suffix. A single-suffix rule whose source suffix is <samp>`.c'</samp> is equivalent to the pattern rule <samp>`% : %.c'</samp>.</p>
<p>Suffix rule definitions are recognized by comparing each rule's target against a defined list of known suffixes. When <span style="font-family: courier, mono;">make</span> sees a rule whose target is a known suffix, this rule is considered a single-suffix rule. When <span style="font-family: courier, mono;">make</span> sees a rule whose target is two known suffixes concatenated, this rule is taken as a double-suffix rule.</p>
<p>For example, <samp>`.c'</samp> and <samp>`.o'</samp> are both on the default list of known suffixes. Therefore, if you define a rule whose target is <samp>`.c.o'</samp>, <span style="font-family: courier, mono;">make</span> takes it to be a double-suffix rule with source suffix <samp>`.c'</samp> and target suffix <samp>`.o'</samp>. Here is the old-fashioned way to define the rule for compiling a C source file:</p>
<p>.c.o: $(CC) -c $(CFLAGS) $(CPPFLAGS) -o $@ $&lt;</p>
<p>Suffix rules cannot have any prerequisites of their own. If they have any, they are treated as normal files with funny names, not as suffix rules. Thus, the rule:</p>
<p>.c.o: foo.h $(CC) -c $(CFLAGS) $(CPPFLAGS) -o $@ $&lt;</p>
<p>tells how to make the file <tt>`.c.o'</tt> from the prerequisite file <tt>`foo.h'</tt>, and is not at all like the pattern rule:</p>
<p>%.o: %.c foo.h $(CC) -c $(CFLAGS) $(CPPFLAGS) -o $@ $&lt;</p>
<p>which tells how to make <samp>`.o'</samp> files from <samp>`.c'</samp> files, and makes all <samp>`.o'</samp> files using this pattern rule also depend on <tt>`foo.h'</tt>.</p>
<p>Suffix rules with no commands are also meaningless. They do not remove previous rules as do pattern rules with no commands (see section <a href="#SEC104">Canceling Implicit Rules</a>). They simply enter the suffix or pair of suffixes concatenated as a target in the data base.</p>
<p><a id="IDX891" name="IDX891"></a>The known suffixes are simply the names of the prerequisites of the special target <span style="font-family: courier, mono;">.SUFFIXES</span>. You can add your own suffixes by writing a rule for <span style="font-family: courier, mono;">.SUFFIXES</span> that adds more prerequisites, as in:</p>
<p>.SUFFIXES: .hack .win</p>
<p>which adds <samp>`.hack'</samp> and <samp>`.win'</samp> to the end of the list of suffixes.</p>
<p>If you wish to eliminate the default known suffixes instead of just adding to them, write a rule for <span style="font-family: courier, mono;">.SUFFIXES</span> with no prerequisites. By special dispensation, this eliminates all existing prerequisites of <span style="font-family: courier, mono;">.SUFFIXES</span>. You can then write another rule to add the suffixes you want. For example,</p>
<p>.SUFFIXES: # Delete the default suffixes .SUFFIXES: .c .o .h # Define our suffix list</p>
<p>The <samp>`-r'</samp> or <samp>`--no-builtin-rules'</samp> flag causes the default list of suffixes to be empty.</p>
<p><a id="IDX892" name="IDX892"></a>The variable <span style="font-family: courier, mono;">SUFFIXES</span> is defined to the default list of suffixes before <span style="font-family: courier, mono;">make</span> reads any makefiles. You can change the list of suffixes with a rule for the special target <span style="font-family: courier, mono;">.SUFFIXES</span>, but that does not alter this variable.</p>
<h2 class="subhead"><a id="SEC107" href="#TOC107" name="SEC107">Implicit Rule Search Algorithm</a></h2>
<p><a id="IDX893" name="IDX893"></a><a id="IDX894" name="IDX894"></a></p>
<p>Here is the procedure <span style="font-family: courier, mono;">make</span> uses for searching for an implicit rule for a target <var>t</var>. This procedure is followed for each double-colon rule with no commands, for each target of ordinary rules none of which have commands, and for each prerequisite that is not the target of any rule. It is also followed recursively for prerequisites that come from implicit rules, in the search for a chain of rules.</p>
<p>Suffix rules are not mentioned in this algorithm because suffix rules are converted to equivalent pattern rules once the makefiles have been read in.</p>
<p>For an archive member target of the form <samp>`<var>archive</var>(<var>member</var>)'</samp>, the following algorithm is run twice, first using the entire target name <var>t</var>, and second using <samp>`(<var>member</var>)'</samp> as the target <var>t</var> if the first run found no rule.</p>
<ol>
<li>Split <var>t</var> into a directory part, called <var>d</var>, and the rest, called <var>n</var>. For example, if <var>t</var> is <samp>`src/foo.o'</samp>, then <var>d</var> is <samp>`src/'</samp> and <var>n</var> is <samp>`foo.o'</samp>.</li>
<li>Make a list of all the pattern rules one of whose targets matches <var>t</var> or <var>n</var>. If the target pattern contains a slash, it is matched against <var>t</var>; otherwise, against <var>n</var>.</li>
<li>If any rule in that list is <em>not</em> a match-anything rule, then remove all nonterminal match-anything rules from the list.</li>
<li>Remove from the list all rules with no commands.</li>
<li>For each pattern rule in the list:
<ol>
<li>Find the stem <var>s</var>, which is the nonempty part of <var>t</var> or <var>n</var> matched by the <samp>`%'</samp> in the target pattern.</li>
<li>Compute the prerequisite names by substituting <var>s</var> for <samp>`%'</samp>; if the target pattern does not contain a slash, append <var>d</var> to the front of each prerequisite name.</li>
<li>Test whether all the prerequisites exist or ought to exist. (If a file name is mentioned in the makefile as a target or as an explicit prerequisite, then we say it ought to exist.) If all prerequisites exist or ought to exist, or there are no prerequisites, then this rule applies.</li>
</ol>
</li>
<li>If no pattern rule has been found so far, try harder. For each pattern rule in the list:
<ol>
<li>If the rule is terminal, ignore it and go on to the next rule.</li>
<li>Compute the prerequisite names as before.</li>
<li>Test whether all the prerequisites exist or ought to exist.</li>
<li>For each prerequisite that does not exist, follow this algorithm recursively to see if the prerequisite can be made by an implicit rule.</li>
<li>If all prerequisites exist, ought to exist, or can be made by implicit rules, then this rule applies.</li>
</ol>
</li>
<li>If no implicit rule applies, the rule for <span style="font-family: courier, mono;">.DEFAULT</span>, if any, applies. In that case, give <var>t</var> the same commands that <span style="font-family: courier, mono;">.DEFAULT</span> has. Otherwise, there are no commands for <var>t</var>.</li>
</ol>
<p>Once a rule that applies has been found, for each target pattern of the rule other than the one that matched <var>t</var> or <var>n</var>, the <samp>`%'</samp> in the pattern is replaced with <var>s</var> and the resultant file name is stored until the commands to remake the target file <var>t</var> are executed. After these commands are executed, each of these stored file names are entered into the data base and marked as having been updated and having the same update status as the file <var>t</var>.</p>
<p>When the commands of a pattern rule are executed for <var>t</var>, the automatic variables are set corresponding to the target and prerequisites. See section <a href="#SEC101">Automatic Variables</a>.</p>
<h2 class="subhead"><a id="SEC108" href="#TOC108" name="SEC108">Using <span style="font-family: courier, mono;">make</span> to Update Archive Files</a></h2>
<p><a id="IDX895" name="IDX895"></a></p>
<p><strong>Archive files</strong> are files containing named subfiles called <strong>members</strong>; they are maintained with the program <span style="font-family: courier, mono;">ar</span> and their main use is as subroutine libraries for linking.</p>
<h2 class="subhead"><a id="SEC109" href="#TOC109" name="SEC109">Archive Members as Targets</a></h2>
<p><a id="IDX896" name="IDX896"></a></p>
<p>An individual member of an archive file can be used as a target or prerequisite in <span style="font-family: courier, mono;">make</span>. You specify the member named <var>member</var> in archive file <var>archive</var> as follows:</p>
<p><var>archive</var>(<var>member</var>)</p>
<p>This construct is available only in targets and prerequisites, not in commands! Most programs that you might use in commands do not support this syntax and cannot act directly on archive members. Only <span style="font-family: courier, mono;">ar</span> and other programs specifically designed to operate on archives can do so. Therefore, valid commands to update an archive member target probably must use <span style="font-family: courier, mono;">ar</span>. For example, this rule says to create a member <tt>`hack.o'</tt> in archive <tt>`foolib'</tt> by copying the file <tt>`hack.o'</tt>:</p>
<p>foolib(hack.o) : hack.o ar cr foolib hack.o</p>
<p>In fact, nearly all archive member targets are updated in just this way and there is an implicit rule to do it for you. <strong>Note:</strong> The <samp>`c'</samp> flag to <span style="font-family: courier, mono;">ar</span> is required if the archive file does not already exist.</p>
<p>To specify several members in the same archive, you can write all the member names together between the parentheses. For example:</p>
<p>foolib(hack.o kludge.o)</p>
<p>is equivalent to:</p>
<p>foolib(hack.o) foolib(kludge.o)</p>
<p><a id="IDX897" name="IDX897"></a>You can also use shell-style wildcards in an archive member reference. See section <a href="#SEC22">Using Wildcard Characters in File Names</a>. For example, <samp>`foolib(*.o)'</samp> expands to all existing members of the <tt>`foolib'</tt> archive whose names end in <samp>`.o'</samp>; perhaps <samp>`foolib(hack.o) foolib(kludge.o)'</samp>.</p>
<h2 class="subhead"><a id="SEC110" href="#TOC110" name="SEC110">Implicit Rule for Archive Member Targets</a></h2>
<p>Recall that a target that looks like <tt>`<var>a</var>(<var>m</var>)'</tt> stands for the member named <var>m</var> in the archive file <var>a</var>.</p>
<p>When <span style="font-family: courier, mono;">make</span> looks for an implicit rule for such a target, as a special feature it considers implicit rules that match <tt>`(<var>m</var>)'</tt>, as well as those that match the actual target <tt>`<var>a</var>(<var>m</var>)'</tt>.</p>
<p>This causes one special rule whose target is <tt>`(%)'</tt> to match. This rule updates the target <tt>`<var>a</var>(<var>m</var>)'</tt> by copying the file <var>m</var> into the archive. For example, it will update the archive member target <tt>`foo.a(bar.o)'</tt> by copying the <em>file</em> <tt>`bar.o'</tt> into the archive <tt>`foo.a'</tt> as a <em>member</em> named <tt>`bar.o'</tt>.</p>
<p>When this rule is chained with others, the result is very powerful. Thus, <samp>`make "foo.a(bar.o)"'</samp> (the quotes are needed to protect the <samp>`('</samp> and <samp>`)'</samp> from being interpreted specially by the shell) in the presence of a file <tt>`bar.c'</tt> is enough to cause the following commands to be run, even without a makefile:</p>
<p>cc -c bar.c -o bar.oar r foo.a bar.orm -f bar.o</p>
<p>Here <span style="font-family: courier, mono;">make</span> has envisioned the file <tt>`bar.o'</tt> as an intermediate file. See section <a href="#SEC97">Chains of Implicit Rules</a>.</p>
<p>Implicit rules such as this one are written using the automatic variable <samp>`$%'</samp>. See section <a href="#SEC101">Automatic Variables</a>.</p>
<p>An archive member name in an archive cannot contain a directory name, but it may be useful in a makefile to pretend that it does. If you write an archive member target <tt>`foo.a(dir/file.o)'</tt>, <span style="font-family: courier, mono;">make</span> will perform automatic updating with this command:</p>
<p>ar r foo.a dir/file.o</p>
<p>which has the effect of copying the file <tt>`dir/file.o'</tt> into a member named <tt>`file.o'</tt>. In connection with such usage, the automatic variables <span style="font-family: courier, mono;">%D</span> and <span style="font-family: courier, mono;">%F</span> may be useful.</p>
<h3 class="subsubhead"><a id="SEC111" href="#TOC111" name="SEC111">Updating Archive Symbol Directories</a></h3>
<p><a id="IDX898" name="IDX898"></a><a id="IDX899" name="IDX899"></a><a id="IDX900" name="IDX900"></a><a id="IDX901" name="IDX901"></a><a id="IDX902" name="IDX902"></a></p>
<p>An archive file that is used as a library usually contains a special member named <tt>`__.SYMDEF'</tt> that contains a directory of the external symbol names defined by all the other members. After you update any other members, you need to update <tt>`__.SYMDEF'</tt> so that it will summarize the other members properly. This is done by running the <span style="font-family: courier, mono;">ranlib</span> program:</p>
<p>ranlib <var>archivefile</var></p>
<p>Normally you would put this command in the rule for the archive file, and make all the members of the archive file prerequisites of that rule. For example,</p>
<p>libfoo.a: libfoo.a(x.o) libfoo.a(y.o) ... ranlib libfoo.a</p>
<p>The effect of this is to update archive members <tt>`x.o'</tt>, <tt>`y.o'</tt>, etc., and then update the symbol directory member <tt>`__.SYMDEF'</tt> by running <span style="font-family: courier, mono;">ranlib</span>. The rules for updating the members are not shown here; most likely you can omit them and use the implicit rule which copies files into the archive, as described in the preceding section.</p>
<p>This is not necessary when using the GNU <span style="font-family: courier, mono;">ar</span> program, which updates the <tt>`__.SYMDEF'</tt> member automatically.</p>
<h2 class="subhead"><a id="SEC112" href="#TOC112" name="SEC112">Dangers When Using Archives</a></h2>
<p><a id="IDX903" name="IDX903"></a><a id="IDX904" name="IDX904"></a><a id="IDX905" name="IDX905"></a><a id="IDX906" name="IDX906"></a></p>
<p>It is important to be careful when using parallel execution (the <span style="font-family: courier, mono;">-j</span> switch; see section <a href="#SEC47">Parallel Execution</a>) and archives. If multiple <span style="font-family: courier, mono;">ar</span> commands run at the same time on the same archive file, they will not know about each other and can corrupt the file.</p>
<p>Possibly a future version of <span style="font-family: courier, mono;">make</span> will provide a mechanism to circumvent this problem by serializing all commands that operate on the same archive file. But for the time being, you must either write your makefiles to avoid this problem in some other way, or not use <span style="font-family: courier, mono;">-j</span>.</p>
<h2 class="subhead"><a id="SEC113" href="#TOC113" name="SEC113">Suffix Rules for Archive Files</a></h2>
<p><a id="IDX907" name="IDX907"></a><a id="IDX908" name="IDX908"></a><a id="IDX909" name="IDX909"></a><a id="IDX910" name="IDX910"></a></p>
<p>You can write a special kind of suffix rule for dealing with archive files. See section <a href="#SEC106">Old-Fashioned Suffix Rules</a>, for a full explanation of suffix rules. Archive suffix rules are obsolete in GNU <span style="font-family: courier, mono;">make</span>, because pattern rules for archives are a more general mechanism (see section <a href="#SEC110">Implicit Rule for Archive Member Targets</a>). But they are retained for compatibility with other <span style="font-family: courier, mono;">make</span>s.</p>
<p>To write a suffix rule for archives, you simply write a suffix rule using the target suffix <samp>`.a'</samp> (the usual suffix for archive files). For example, here is the old-fashioned suffix rule to update a library archive from C source files:</p>
<p>.c.a: $(CC) $(CFLAGS) $(CPPFLAGS) -c $&lt; -o $*.o $(AR) r $@ $*.o $(RM) $*.o</p>
<p>This works just as if you had written the pattern rule:</p>
<p>(%.o): %.c $(CC) $(CFLAGS) $(CPPFLAGS) -c $&lt; -o $*.o $(AR) r $@ $*.o $(RM) $*.o</p>
<p>In fact, this is just what <span style="font-family: courier, mono;">make</span> does when it sees a suffix rule with <samp>`.a'</samp> as the target suffix. Any double-suffix rule <samp>`.<var>x</var>.a'</samp> is converted to a pattern rule with the target pattern <samp>`(%.o)'</samp> and a prerequisite pattern of <samp>`%.<var>x</var>'</samp>.</p>
<p>Since you might want to use <samp>`.a'</samp> as the suffix for some other kind of file, <span style="font-family: courier, mono;">make</span> also converts archive suffix rules to pattern rules in the normal way (see section <a href="#SEC106">Old-Fashioned Suffix Rules</a>). Thus a double-suffix rule <samp>`.<var>x</var>.a'</samp> produces two pattern rules: <samp>`(%.o): %.<var>x</var>'</samp> and <samp>`%.a: %.<var>x</var>'</samp>.</p>
<h2 class="subhead"><a id="SEC114" href="#TOC114" name="SEC114">Features of GNU <span style="font-family: courier, mono;">make</span></a></h2>
<p><a id="IDX911" name="IDX911"></a><a id="IDX912" name="IDX912"></a><a id="IDX913" name="IDX913"></a></p>
<p>Here is a summary of the features of GNU <span style="font-family: courier, mono;">make</span>, for comparison with and credit to other versions of <span style="font-family: courier, mono;">make</span>. We consider the features of <span style="font-family: courier, mono;">make</span> in 4.2 BSD systems as a baseline. If you are concerned with writing portable makefiles, you should not use the features of <span style="font-family: courier, mono;">make</span> listed here, nor the ones in section <a href="#SEC115">Incompatibilities and Missing Features</a>.</p>
<p>Many features come from the version of <span style="font-family: courier, mono;">make</span> in System V.</p>
<ul>
<li>The <span style="font-family: courier, mono;">VPATH</span> variable and its special meaning. See section <a href="#SEC26">Searching Directories for Prerequisites</a>. This feature exists in System V <span style="font-family: courier, mono;">make</span>, but is undocumented. It is documented in 4.3 BSD <span style="font-family: courier, mono;">make</span> (which says it mimics System V's <span style="font-family: courier, mono;">VPATH</span> feature).</li>
<li>Included makefiles. See section <a href="#SEC15">Including Other Makefiles</a>. Allowing multiple files to be included with a single directive is a GNU extension.</li>
<li>Variables are read from and communicated via the environment. See section <a href="#SEC68">Variables from the Environment</a>.</li>
<li>Options passed through the variable <span style="font-family: courier, mono;">MAKEFLAGS</span> to recursive invocations of <span style="font-family: courier, mono;">make</span>. See section <a href="#SEC53">Communicating Options to a Sub-<span style="font-family: courier, mono;">make</span></a>.</li>
<li>The automatic variable <span style="font-family: courier, mono;">$%</span> is set to the member name in an archive reference. See section <a href="#SEC101">Automatic Variables</a>.</li>
<li>The automatic variables <span style="font-family: courier, mono;">$@</span>, <span style="font-family: courier, mono;">$*</span>, <span style="font-family: courier, mono;">$&lt;</span>, <span style="font-family: courier, mono;">$%</span>, and <span style="font-family: courier, mono;">$?</span> have corresponding forms like <span style="font-family: courier, mono;">$(@F)</span> and <span style="font-family: courier, mono;">$(@D)</span>. We have generalized this to <span style="font-family: courier, mono;">$^</span> as an obvious extension. See section <a href="#SEC101">Automatic Variables</a>.</li>
<li>Substitution variable references. See section <a href="#SEC58">Basics of Variable References</a>.</li>
<li>The command-line options <samp>`-b'</samp> and <samp>`-m'</samp>, accepted and ignored. In System V <span style="font-family: courier, mono;">make</span>, these options actually do something.</li>
<li>Execution of recursive commands to run <span style="font-family: courier, mono;">make</span> via the variable <span style="font-family: courier, mono;">MAKE</span> even if <samp>`-n'</samp>, <samp>`-q'</samp> or <samp>`-t'</samp> is specified. See section <a href="#SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>.</li>
<li>Support for suffix <samp>`.a'</samp> in suffix rules. See section <a href="#SEC113">Suffix Rules for Archive Files</a>. This feature is obsolete in GNU <span style="font-family: courier, mono;">make</span>, because the general feature of rule chaining (see section <a href="#SEC97">Chains of Implicit Rules</a>) allows one pattern rule for installing members in an archive (see section <a href="#SEC110">Implicit Rule for Archive Member Targets</a>) to be sufficient.</li>
<li>The arrangement of lines and backslash-newline combinations in commands is retained when the commands are printed, so they appear as they do in the makefile, except for the stripping of initial whitespace.</li>
</ul>
<p>The following features were inspired by various other versions of <span style="font-family: courier, mono;">make</span>. In some cases it is unclear exactly which versions inspired which others.</p>
<ul>
<li>Pattern rules using <samp>`%'</samp>. This has been implemented in several versions of <span style="font-family: courier, mono;">make</span>. We're not sure who invented it first, but it's been spread around a bit. See section <a href="#SEC98">Defining and Redefining Pattern Rules</a>.</li>
<li>Rule chaining and implicit intermediate files. This was implemented by Stu Feldman in his version of <span style="font-family: courier, mono;">make</span> for AT&amp;T Eighth Edition Research Unix, and later by Andrew Hume of AT&amp;T Bell Labs in his <span style="font-family: courier, mono;">mk</span> program (where he terms it "transitive closure"). We do not really know if we got this from either of them or thought it up ourselves at the same time. See section <a href="#SEC97">Chains of Implicit Rules</a>.</li>
<li>The automatic variable <span style="font-family: courier, mono;">$^</span> containing a list of all prerequisites of the current target. We did not invent this, but we have no idea who did. See section <a href="#SEC101">Automatic Variables</a>. The automatic variable <span style="font-family: courier, mono;">$+</span> is a simple extension of <span style="font-family: courier, mono;">$^</span>.</li>
<li>The "what if" flag (<samp>`-W'</samp> in GNU <span style="font-family: courier, mono;">make</span>) was (as far as we know) invented by Andrew Hume in <span style="font-family: courier, mono;">mk</span>. See section <a href="#SEC88">Instead of Executing the Commands</a>.</li>
<li>The concept of doing several things at once (parallelism) exists in many incarnations of <span style="font-family: courier, mono;">make</span> and similar programs, though not in the System V or BSD implementations. See section <a href="#SEC46">Command Execution</a>.</li>
<li>Modified variable references using pattern substitution come from SunOS 4. See section <a href="#SEC58">Basics of Variable References</a>. This functionality was provided in GNU <span style="font-family: courier, mono;">make</span> by the <span style="font-family: courier, mono;">patsubst</span> function before the alternate syntax was implemented for compatibility with SunOS 4. It is not altogether clear who inspired whom, since GNU <span style="font-family: courier, mono;">make</span> had <span style="font-family: courier, mono;">patsubst</span> before SunOS 4 was released.</li>
<li>The special significance of <samp>`+'</samp> characters preceding command lines (see section <a href="#SEC88">Instead of Executing the Commands</a>) is mandated by <cite>IEEE Standard 1003.2-1992</cite> (POSIX.2).</li>
<li>The <samp>`+='</samp> syntax to append to the value of a variable comes from SunOS 4 <span style="font-family: courier, mono;">make</span>. See section <a href="#SEC65">Appending More Text to Variables</a>.</li>
<li>The syntax <samp>`<var>archive</var>(<var>mem1</var> <var>mem2</var>...)'</samp> to list multiple members in a single archive file comes from SunOS 4 <span style="font-family: courier, mono;">make</span>. See section <a href="#SEC109">Archive Members as Targets</a>.</li>
<li>The <span style="font-family: courier, mono;">-include</span> directive to include makefiles with no error for a nonexistent file comes from SunOS 4 <span style="font-family: courier, mono;">make</span>. (But note that SunOS 4 <span style="font-family: courier, mono;">make</span> does not allow multiple makefiles to be specified in one <span style="font-family: courier, mono;">-include</span> directive.) The same feature appears with the name <span style="font-family: courier, mono;">sinclude</span> in SGI <span style="font-family: courier, mono;">make</span> and perhaps others.</li>
</ul>
<p>The remaining features are inventions new in GNU <span style="font-family: courier, mono;">make</span>:</p>
<ul>
<li>Use the <samp>`-v'</samp> or <samp>`--version'</samp> option to print version and copyright information.</li>
<li>Use the <samp>`-h'</samp> or <samp>`--help'</samp> option to summarize the options to <span style="font-family: courier, mono;">make</span>.</li>
<li>Simply-expanded variables. See section <a href="#SEC59">The Two Flavors of Variables</a>.</li>
<li>Pass command-line variable assignments automatically through the variable <span style="font-family: courier, mono;">MAKE</span> to recursive <span style="font-family: courier, mono;">make</span> invocations. See section <a href="#SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>.</li>
<li>Use the <samp>`-C'</samp> or <samp>`--directory'</samp> command option to change directory. See section <a href="#SEC92">Summary of Options</a>.</li>
<li>Make verbatim variable definitions with <span style="font-family: courier, mono;">define</span>. See section <a href="#SEC67">Defining Variables Verbatim</a>.</li>
<li>Declare phony targets with the special target <span style="font-family: courier, mono;">.PHONY</span>. Andrew Hume of AT&amp;T Bell Labs implemented a similar feature with a different syntax in his <span style="font-family: courier, mono;">mk</span> program. This seems to be a case of parallel discovery. See section <a href="#SEC33">Phony Targets</a>.</li>
<li>Manipulate text by calling functions. See section <a href="#SEC75">Functions for Transforming Text</a>.</li>
<li>Use the <samp>`-o'</samp> or <samp>`--old-file'</samp> option to pretend a file's modification-time is old. See section <a href="#SEC89">Avoiding Recompilation of Some Files</a>.</li>
<li>Conditional execution. This feature has been implemented numerous times in various versions of <span style="font-family: courier, mono;">make</span>; it seems a natural extension derived from the features of the C preprocessor and similar macro languages and is not a revolutionary concept. See section <a href="#SEC71">Conditional Parts of Makefiles</a>.</li>
<li>Specify a search path for included makefiles. See section <a href="#SEC15">Including Other Makefiles</a>.</li>
<li>Specify extra makefiles to read with an environment variable. See section <a href="#SEC16">The Variable <span style="font-family: courier, mono;">MAKEFILES</span></a>.</li>
<li>Strip leading sequences of <samp>`./'</samp> from file names, so that <tt>`./<var>file</var>'</tt> and <tt>`<var>file</var>'</tt> are considered to be the same file.</li>
<li>Use a special search method for library prerequisites written in the form <samp>`-l<var>name</var>'</samp>. See section <a href="#SEC32">Directory Search for Link Libraries</a>.</li>
<li>Allow suffixes for suffix rules (see section <a href="#SEC106">Old-Fashioned Suffix Rules</a>) to contain any characters. In other versions of <span style="font-family: courier, mono;">make</span>, they must begin with <samp>`.'</samp> and not contain any <samp>`/'</samp> characters.</li>
<li>Keep track of the current level of <span style="font-family: courier, mono;">make</span> recursion using the variable <span style="font-family: courier, mono;">MAKELEVEL</span>. See section <a href="#SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>.</li>
<li>Provide any goals given on the command line in the variable <span style="font-family: courier, mono;">MAKECMDGOALS</span>. See section <a href="#SEC87">Arguments to Specify the Goals</a>.</li>
<li>Specify static pattern rules. See section <a href="#SEC39">Static Pattern Rules</a>.</li>
<li>Provide selective <span style="font-family: courier, mono;">vpath</span> search. See section <a href="#SEC26">Searching Directories for Prerequisites</a>.</li>
<li>Provide computed variable references. See section <a href="#SEC58">Basics of Variable References</a>.</li>
<li>Update makefiles. See section <a href="#SEC17">How Makefiles Are Remade</a>. System V <span style="font-family: courier, mono;">make</span> has a very, very limited form of this functionality in that it will check out SCCS files for makefiles.</li>
<li>Various new built-in implicit rules. See section <a href="#SEC95">Catalogue of Implicit Rules</a>.</li>
<li>The built-in variable <samp>`MAKE_VERSION'</samp> gives the version number of <span style="font-family: courier, mono;">make</span>.</li>
</ul>
<h2 class="subhead"><a id="SEC115" href="#TOC115" name="SEC115">Incompatibilities and Missing Features</a></h2>
<p><a id="IDX914" name="IDX914"></a><a id="IDX915" name="IDX915"></a><a id="IDX916" name="IDX916"></a></p>
<p>The <span style="font-family: courier, mono;">make</span> programs in various other systems support a few features that are not implemented in GNU <span style="font-family: courier, mono;">make</span>. The POSIX.2 standard (<cite>IEEE Standard 1003.2-1992</cite>) which specifies <span style="font-family: courier, mono;">make</span> does not require any of these features.</p>
<ul>
<li>A target of the form <samp>`<var>file</var>((<var>entry</var>))'</samp> stands for a member of archive file <var>file</var>. The member is chosen, not by name, but by being an object file which defines the linker symbol <var>entry</var>. This feature was not put into GNU <span style="font-family: courier, mono;">make</span> because of the nonmodularity of putting knowledge into <span style="font-family: courier, mono;">make</span> of the internal format of archive file symbol tables. See section <a href="#SEC111">Updating Archive Symbol Directories</a>.</li>
<li>Suffixes (used in suffix rules) that end with the character <samp>`~'</samp> have a special meaning to System V <span style="font-family: courier, mono;">make</span>; they refer to the SCCS file that corresponds to the file one would get without the <samp>`~'</samp>. For example, the suffix rule <samp>`.c~.o'</samp> would make the file <tt>`<var>n</var>.o'</tt> from the SCCS file <tt>`s.<var>n</var>.c'</tt>. For complete coverage, a whole series of such suffix rules is required. See section <a href="#SEC106">Old-Fashioned Suffix Rules</a>. In GNU <span style="font-family: courier, mono;">make</span>, this entire series of cases is handled by two pattern rules for extraction from SCCS, in combination with the general feature of rule chaining. See section <a href="#SEC97">Chains of Implicit Rules</a>.</li>
<li>In System V <span style="font-family: courier, mono;">make</span>, the string <samp>`$$@'</samp> has the strange meaning that, in the prerequisites of a rule with multiple targets, it stands for the particular target that is being processed. This is not defined in GNU <span style="font-family: courier, mono;">make</span> because <samp>`$$'</samp> should always stand for an ordinary <samp>`$'</samp>. It is possible to get portions of this functionality through the use of static pattern rules (see section <a href="#SEC39">Static Pattern Rules</a>). The System V <span style="font-family: courier, mono;">make</span> rule:
<p>$(targets): $$@.o lib.a</p>
can be replaced with the GNU <span style="font-family: courier, mono;">make</span> static pattern rule:
<p>$(targets): %: %.o lib.a</p>
</li>
<li>In System V and 4.3 BSD <span style="font-family: courier, mono;">make</span>, files found by <span style="font-family: courier, mono;">VPATH</span> search (see section <a href="#SEC26">Searching Directories for Prerequisites</a>) have their names changed inside command strings. We feel it is much cleaner to always use automatic variables and thus make this feature obsolete.</li>
<li>In some Unix <span style="font-family: courier, mono;">make</span>s, the automatic variable <span style="font-family: courier, mono;">$*</span> appearing in the prerequisites of a rule has the amazingly strange "feature" of expanding to the full name of the <em>target of that rule</em>. We cannot imagine what went on in the minds of Unix <span style="font-family: courier, mono;">make</span> developers to do this; it is utterly inconsistent with the normal definition of <span style="font-family: courier, mono;">$*</span>. <a id="IDX917" name="IDX917"></a>
</li>
<li>In some Unix <span style="font-family: courier, mono;">make</span>s, implicit rule search (see section <a href="#SEC93">Using Implicit Rules</a>) is apparently done for <em>all</em> targets, not just those without commands. This means you can do:
<p>foo.o: cc -c foo.c</p>
and Unix <span style="font-family: courier, mono;">make</span> will intuit that <tt>`foo.o'</tt> depends on <tt>`foo.c'</tt>. We feel that such usage is broken. The prerequisite properties of <span style="font-family: courier, mono;">make</span> are well-defined (for GNU <span style="font-family: courier, mono;">make</span>, at least), and doing such a thing simply does not fit the model.</li>
<li>GNU <span style="font-family: courier, mono;">make</span> does not include any built-in implicit rules for compiling or preprocessing EFL programs. If we hear of anyone who is using EFL, we will gladly add them.</li>
<li>It appears that in SVR4 <span style="font-family: courier, mono;">make</span>, a suffix rule can be specified with no commands, and it is treated as if it had empty commands (see section <a href="#SEC56">Using Empty Commands</a>). For example:
<p>.c.a:</p>
will override the built-in <tt>`.c.a'</tt> suffix rule. We feel that it is cleaner for a rule without commands to always simply add to the prerequisite list for the target. The above example can be easily rewritten to get the desired behavior in GNU <span style="font-family: courier, mono;">make</span>:
<p>.c.a: ;</p>
</li>
<li>Some versions of <span style="font-family: courier, mono;">make</span> invoke the shell with the <samp>`-e'</samp> flag, except under <samp>`-k'</samp> (see section <a href="#SEC91">Testing the Compilation of a Program</a>). The <samp>`-e'</samp> flag tells the shell to exit as soon as any program it runs returns a nonzero status. We feel it is cleaner to write each shell command line to stand on its own and not require this special treatment.</li>
</ul>
<p><a id="SEC116" href="#TOC116" name="SEC116">Makefile Conventions</a></p>
<p>This chapter describes conventions for writing the Makefiles for GNU programs. Using Automake will help you write a Makefile that follows these conventions.</p>
<h2 class="subhead"><a id="SEC117" href="#TOC117" name="SEC117">General Conventions for Makefiles</a></h2>
<p>Every Makefile should contain this line:</p>
<p>SHELL = /bin/sh</p>
<p>to avoid trouble on systems where the <span style="font-family: courier, mono;">SHELL</span> variable might be inherited from the environment. (This is never a problem with GNU <span style="font-family: courier, mono;">make</span>.)</p>
<p>Different <span style="font-family: courier, mono;">make</span> programs have incompatible suffix lists and implicit rules, and this sometimes creates confusion or misbehavior. So it is a good idea to set the suffix list explicitly using only the suffixes you need in the particular Makefile, like this:</p>
<p>.SUFFIXES:.SUFFIXES: .c .o</p>
<p>The first line clears out the suffix list, the second introduces all suffixes which may be subject to implicit rules in this Makefile.</p>
<p>Don't assume that <tt>`.'</tt> is in the path for command execution. When you need to run programs that are a part of your package during the make, please make sure that it uses <tt>`./'</tt> if the program is built as part of the make or <tt>`$(srcdir)/'</tt> if the file is an unchanging part of the source code. Without one of these prefixes, the current search path is used.</p>
<p>The distinction between <tt>`./'</tt> (the <strong>build directory</strong>) and <tt>`$(srcdir)/'</tt> (the <strong>source directory</strong>) is important because users can build in a separate directory using the <samp>`--srcdir'</samp> option to <tt>`configure'</tt>. A rule of the form:</p>
<p>foo.1 : foo.man sedscript sed -e sedscript foo.man &gt; foo.1</p>
<p>will fail when the build directory is not the source directory, because <tt>`foo.man'</tt> and <tt>`sedscript'</tt> are in the the source directory.</p>
<p>When using GNU <span style="font-family: courier, mono;">make</span>, relying on <samp>`VPATH'</samp> to find the source file will work in the case where there is a single dependency file, since the <span style="font-family: courier, mono;">make</span> automatic variable <samp>`$&lt;'</samp> will represent the source file wherever it is. (Many versions of <span style="font-family: courier, mono;">make</span> set <samp>`$&lt;'</samp> only in implicit rules.) A Makefile target like</p>
<p>foo.o : bar.c $(CC) -I. -I$(srcdir) $(CFLAGS) -c bar.c -o foo.o</p>
<p>should instead be written as</p>
<p>foo.o : bar.c $(CC) -I. -I$(srcdir) $(CFLAGS) -c $&lt; -o $@</p>
<p>in order to allow <samp>`VPATH'</samp> to work correctly. When the target has multiple dependencies, using an explicit <samp>`$(srcdir)'</samp> is the easiest way to make the rule work well. For example, the target above for <tt>`foo.1'</tt> is best written as:</p>
<p>foo.1 : foo.man sedscript sed -e $(srcdir)/sedscript $(srcdir)/foo.man &gt; $@</p>
<p>GNU distributions usually contain some files which are not source files--for example, Info files, and the output from Autoconf, Automake, Bison or Flex. Since these files normally appear in the source directory, they should always appear in the source directory, not in the build directory. So Makefile rules to update them should put the updated files in the source directory.</p>
<p>However, if a file does not appear in the distribution, then the Makefile should not put it in the source directory, because building a program in ordinary circumstances should not modify the source directory in any way.</p>
<p>Try to make the build and installation targets, at least (and all their subtargets) work correctly with a parallel <span style="font-family: courier, mono;">make</span>.</p>
<h2 class="subhead"><a id="SEC118" href="#TOC118" name="SEC118">Utilities in Makefiles</a></h2>
<p>Write the Makefile commands (and any shell scripts, such as <span style="font-family: courier, mono;">configure</span>) to run in <span style="font-family: courier, mono;">sh</span>, not in <span style="font-family: courier, mono;">csh</span>. Don't use any special features of <span style="font-family: courier, mono;">ksh</span> or <span style="font-family: courier, mono;">bash</span>.</p>
<p>The <span style="font-family: courier, mono;">configure</span> script and the Makefile rules for building and installation should not use any utilities directly except these:</p>
<p>cat cmp cp diff echo egrep expr false grep install-info ln ls mkdir mv pwd rm rmdir sed sleep sort tar test touch true</p>
<p>The compression program <span style="font-family: courier, mono;">gzip</span> can be used in the <span style="font-family: courier, mono;">dist</span> rule.</p>
<p>Stick to the generally supported options for these programs. For example, don't use <samp>`mkdir -p'</samp>, convenient as it may be, because most systems don't support it.</p>
<p>It is a good idea to avoid creating symbolic links in makefiles, since a few systems don't support them.</p>
<p>The Makefile rules for building and installation can also use compilers and related programs, but should do so via <span style="font-family: courier, mono;">make</span> variables so that the user can substitute alternatives. Here are some of the programs we mean:</p>
<p>ar bison cc flex install ld ldconfig lexmake makeinfo ranlib texi2dvi yacc</p>
<p>Use the following <span style="font-family: courier, mono;">make</span> variables to run those programs:</p>
<p>$(AR) $(BISON) $(CC) $(FLEX) $(INSTALL) $(LD) $(LDCONFIG) $(LEX) $(MAKE) $(MAKEINFO) $(RANLIB) $(TEXI2DVI) $(YACC)</p>
<p>When you use <span style="font-family: courier, mono;">ranlib</span> or <span style="font-family: courier, mono;">ldconfig</span>, you should make sure nothing bad happens if the system does not have the program in question. Arrange to ignore an error from that command, and print a message before the command to tell the user that failure of this command does not mean a problem. (The Autoconf <samp>`AC_PROG_RANLIB'</samp> macro can help with this.)</p>
<p>If you use symbolic links, you should implement a fallback for systems that don't have symbolic links.</p>
<p>Additional utilities that can be used via Make variables are:</p>
<p>chgrp chmod chown mknod</p>
<p>It is ok to use other utilities in Makefile portions (or scripts) intended only for particular systems where you know those utilities exist.</p>
<h2 class="subhead"><a id="SEC119" href="#TOC119" name="SEC119">Variables for Specifying Commands</a></h2>
<p>Makefiles should provide variables for overriding certain commands, options, and so on.</p>
<p>In particular, you should run most utility programs via variables. Thus, if you use Bison, have a variable named <span style="font-family: courier, mono;">BISON</span> whose default value is set with <samp>`BISON = bison'</samp>, and refer to it with <span style="font-family: courier, mono;">$(BISON)</span> whenever you need to use Bison.</p>
<p>File management utilities such as <span style="font-family: courier, mono;">ln</span>, <span style="font-family: courier, mono;">rm</span>, <span style="font-family: courier, mono;">mv</span>, and so on, need not be referred to through variables in this way, since users don't need to replace them with other programs.</p>
<p>Each program-name variable should come with an options variable that is used to supply options to the program. Append <samp>`FLAGS'</samp> to the program-name variable name to get the options variable name--for example, <span style="font-family: courier, mono;">BISONFLAGS</span>. (The names <span style="font-family: courier, mono;">CFLAGS</span> for the C compiler, <span style="font-family: courier, mono;">YFLAGS</span> for yacc, and <span style="font-family: courier, mono;">LFLAGS</span> for lex, are exceptions to this rule, but we keep them because they are standard.) Use <span style="font-family: courier, mono;">CPPFLAGS</span> in any compilation command that runs the preprocessor, and use <span style="font-family: courier, mono;">LDFLAGS</span> in any compilation command that does linking as well as in any direct use of <span style="font-family: courier, mono;">ld</span>.</p>
<p>If there are C compiler options that <em>must</em> be used for proper compilation of certain files, do not include them in <span style="font-family: courier, mono;">CFLAGS</span>. Users expect to be able to specify <span style="font-family: courier, mono;">CFLAGS</span> freely themselves. Instead, arrange to pass the necessary options to the C compiler independently of <span style="font-family: courier, mono;">CFLAGS</span>, by writing them explicitly in the compilation commands or by defining an implicit rule, like this:</p>
<p>CFLAGS = -gALL_CFLAGS = -I. $(CFLAGS).c.o: $(CC) -c $(CPPFLAGS) $(ALL_CFLAGS) $&lt;</p>
<p>Do include the <samp>`-g'</samp> option in <span style="font-family: courier, mono;">CFLAGS</span>, because that is not <em>required</em> for proper compilation. You can consider it a default that is only recommended. If the package is set up so that it is compiled with GCC by default, then you might as well include <samp>`-O'</samp> in the default value of <span style="font-family: courier, mono;">CFLAGS</span> as well.</p>
<p>Put <span style="font-family: courier, mono;">CFLAGS</span> last in the compilation command, after other variables containing compiler options, so the user can use <span style="font-family: courier, mono;">CFLAGS</span> to override the others.</p>
<p><span style="font-family: courier, mono;">CFLAGS</span> should be used in every invocation of the C compiler, both those which do compilation and those which do linking.</p>
<p>Every Makefile should define the variable <span style="font-family: courier, mono;">INSTALL</span>, which is the basic command for installing a file into the system.</p>
<p>Every Makefile should also define the variables <span style="font-family: courier, mono;">INSTALL_PROGRAM</span> and <span style="font-family: courier, mono;">INSTALL_DATA</span>. (The default for each of these should be <span style="font-family: courier, mono;">$(INSTALL)</span>.) Then it should use those variables as the commands for actual installation, for executables and nonexecutables respectively. Use these variables as follows:</p>
<p>$(INSTALL_PROGRAM) foo $(bindir)/foo$(INSTALL_DATA) libfoo.a $(libdir)/libfoo.a</p>
<p>Optionally, you may prepend the value of <span style="font-family: courier, mono;">DESTDIR</span> to the target filename. Doing this allows the installer to create a snapshot of the installation to be copied onto the real target filesystem later. Do not set the value of <span style="font-family: courier, mono;">DESTDIR</span> in your Makefile, and do not include it in any installed files. With support for <span style="font-family: courier, mono;">DESTDIR</span>, the above examples become:</p>
<p>$(INSTALL_PROGRAM) foo $(DESTDIR)$(bindir)/foo $(INSTALL_DATA) libfoo.a $(DESTDIR)$(libdir)/libfoo.a</p>
<p>Always use a file name, not a directory name, as the second argument of the installation commands. Use a separate command for each file to be installed.</p>
<h2 class="subhead"><a id="SEC120" href="#TOC120" name="SEC120">Variables for Installation Directories</a></h2>
<p>Installation directories should always be named by variables, so it is easy to install in a nonstandard place. The standard names for these variables are described below. They are based on a standard filesystem layout; variants of it are used in SVR4, 4.4BSD, Linux, Ultrix v4, and other modern operating systems.</p>
<p>These two variables set the root for the installation. All the other installation directories should be subdirectories of one of these two, and nothing should be directly installed into these two directories.</p>
<dl compact>
<dt><samp>`prefix'</samp></dt>
<dd>A prefix used in constructing the default values of the variables listed below. The default value of <span style="font-family: courier, mono;">prefix</span> should be <tt>`/usr/local'</tt>. When building the complete GNU system, the prefix will be empty and <tt>`/usr'</tt> will be a symbolic link to <tt>`/'</tt>. (If you are using Autoconf, write it as <samp>`@prefix@'</samp>.) Running <samp>`make install'</samp> with a different value of <span style="font-family: courier, mono;">prefix</span> from the one used to build the program should <var>not</var> recompile the program.</dd>
<dt><samp>`exec_prefix'</samp></dt>
<dd>A prefix used in constructing the default values of some of the variables listed below. The default value of <span style="font-family: courier, mono;">exec_prefix</span> should be <span style="font-family: courier, mono;">$(prefix)</span>. (If you are using Autoconf, write it as <samp>`@exec_prefix@'</samp>.) Generally, <span style="font-family: courier, mono;">$(exec_prefix)</span> is used for directories that contain machine-specific files (such as executables and subroutine libraries), while <span style="font-family: courier, mono;">$(prefix)</span> is used directly for other directories. Running <samp>`make install'</samp> with a different value of <span style="font-family: courier, mono;">exec_prefix</span> from the one used to build the program should <var>not</var> recompile the program.</dd>
</dl>
<p>Executable programs are installed in one of the following directories.</p>
<dl compact>
<dt><samp>`bindir'</samp></dt>
<dd>The directory for installing executable programs that users can run. This should normally be <tt>`/usr/local/bin'</tt>, but write it as <tt>`$(exec_prefix)/bin'</tt>. (If you are using Autoconf, write it as <samp>`@bindir@'</samp>.)</dd>
<dt><samp>`sbindir'</samp></dt>
<dd>The directory for installing executable programs that can be run from the shell, but are only generally useful to system administrators. This should normally be <tt>`/usr/local/sbin'</tt>, but write it as <tt>`$(exec_prefix)/sbin'</tt>. (If you are using Autoconf, write it as <samp>`@sbindir@'</samp>.)</dd>
<dt><samp>`libexecdir'</samp></dt>
<dd>The directory for installing executable programs to be run by other programs rather than by users. This directory should normally be <tt>`/usr/local/libexec'</tt>, but write it as <tt>`$(exec_prefix)/libexec'</tt>. (If you are using Autoconf, write it as <samp>`@libexecdir@'</samp>.)</dd>
</dl>
<p>Data files used by the program during its execution are divided into categories in two ways.</p>
<ul>
<li>Some files are normally modified by programs; others are never normally modified (though users may edit some of these).</li>
<li>Some files are architecture-independent and can be shared by all machines at a site; some are architecture-dependent and can be shared only by machines of the same kind and operating system; others may never be shared between two machines.</li>
</ul>
<p>This makes for six different possibilities. However, we want to discourage the use of architecture-dependent files, aside from object files and libraries. It is much cleaner to make other data files architecture-independent, and it is generally not hard.</p>
<p>Therefore, here are the variables Makefiles should use to specify directories:</p>
<dl compact>
<dt><samp>`datadir'</samp></dt>
<dd>The directory for installing read-only architecture independent data files. This should normally be <tt>`/usr/local/share'</tt>, but write it as <tt>`$(prefix)/share'</tt>. (If you are using Autoconf, write it as <samp>`@datadir@'</samp>.) As a special exception, see <tt>`$(infodir)'</tt> and <tt>`$(includedir)'</tt> below.</dd>
<dt><samp>`sysconfdir'</samp></dt>
<dd>The directory for installing read-only data files that pertain to a single machine--that is to say, files for configuring a host. Mailer and network configuration files, <tt>`/etc/passwd'</tt>, and so forth belong here. All the files in this directory should be ordinary ASCII text files. This directory should normally be <tt>`/usr/local/etc'</tt>, but write it as <tt>`$(prefix)/etc'</tt>. (If you are using Autoconf, write it as <samp>`@sysconfdir@'</samp>.) Do not install executables here in this directory (they probably belong in <tt>`$(libexecdir)'</tt> or <tt>`$(sbindir)'</tt>). Also do not install files that are modified in the normal course of their use (programs whose purpose is to change the configuration of the system excluded). Those probably belong in <tt>`$(localstatedir)'</tt>.</dd>
<dt><samp>`sharedstatedir'</samp></dt>
<dd>The directory for installing architecture-independent data files which the programs modify while they run. This should normally be <tt>`/usr/local/com'</tt>, but write it as <tt>`$(prefix)/com'</tt>. (If you are using Autoconf, write it as <samp>`@sharedstatedir@'</samp>.)</dd>
<dt><samp>`localstatedir'</samp></dt>
<dd>The directory for installing data files which the programs modify while they run, and that pertain to one specific machine. Users should never need to modify files in this directory to configure the package's operation; put such configuration information in separate files that go in <tt>`$(datadir)'</tt> or <tt>`$(sysconfdir)'</tt>. <tt>`$(localstatedir)'</tt> should normally be <tt>`/usr/local/var'</tt>, but write it as <tt>`$(prefix)/var'</tt>. (If you are using Autoconf, write it as <samp>`@localstatedir@'</samp>.)</dd>
<dt><samp>`libdir'</samp></dt>
<dd>The directory for object files and libraries of object code. Do not install executables here, they probably ought to go in <tt>`$(libexecdir)'</tt> instead. The value of <span style="font-family: courier, mono;">libdir</span> should normally be <tt>`/usr/local/lib'</tt>, but write it as <tt>`$(exec_prefix)/lib'</tt>. (If you are using Autoconf, write it as <samp>`@libdir@'</samp>.)</dd>
<dt><samp>`infodir'</samp></dt>
<dd>The directory for installing the Info files for this package. By default, it should be <tt>`/usr/local/info'</tt>, but it should be written as <tt>`$(prefix)/info'</tt>. (If you are using Autoconf, write it as <samp>`@infodir@'</samp>.)</dd>
<dt><samp>`lispdir'</samp></dt>
<dd>The directory for installing any Emacs Lisp files in this package. By default, it should be <tt>`/usr/local/share/emacs/site-lisp'</tt>, but it should be written as <tt>`$(prefix)/share/emacs/site-lisp'</tt>. If you are using Autoconf, write the default as <samp>`@lispdir@'</samp>. In order to make <samp>`@lispdir@'</samp> work, you need the following lines in your <tt>`configure.in'</tt> file:
<p>lispdir='${datadir}/emacs/site-lisp'AC_SUBST(lispdir)</p>
</dd>
<dt><samp>`includedir'</samp></dt>
<dd>The directory for installing header files to be included by user programs with the C <samp>`#include'</samp> preprocessor directive. This should normally be <tt>`/usr/local/include'</tt>, but write it as <tt>`$(prefix)/include'</tt>. (If you are using Autoconf, write it as <samp>`@includedir@'</samp>.) Most compilers other than GCC do not look for header files in directory <tt>`/usr/local/include'</tt>. So installing the header files this way is only useful with GCC. Sometimes this is not a problem because some libraries are only really intended to work with GCC. But some libraries are intended to work with other compilers. They should install their header files in two places, one specified by <span style="font-family: courier, mono;">includedir</span> and one specified by <span style="font-family: courier, mono;">oldincludedir</span>.</dd>
<dt><samp>`oldincludedir'</samp></dt>
<dd>The directory for installing <samp>`#include'</samp> header files for use with compilers other than GCC. This should normally be <tt>`/usr/include'</tt>. (If you are using Autoconf, you can write it as <samp>`@oldincludedir@'</samp>.) The Makefile commands should check whether the value of <span style="font-family: courier, mono;">oldincludedir</span> is empty. If it is, they should not try to use it; they should cancel the second installation of the header files. A package should not replace an existing header in this directory unless the header came from the same package. Thus, if your Foo package provides a header file <tt>`foo.h'</tt>, then it should install the header file in the <span style="font-family: courier, mono;">oldincludedir</span> directory if either (1) there is no <tt>`foo.h'</tt> there or (2) the <tt>`foo.h'</tt> that exists came from the Foo package. To tell whether <tt>`foo.h'</tt> came from the Foo package, put a magic string in the file--part of a comment--and <span style="font-family: courier, mono;">grep</span> for that string.</dd>
</dl>
<p>Unix-style man pages are installed in one of the following:</p>
<dl compact>
<dt><samp>`mandir'</samp></dt>
<dd>The top-level directory for installing the man pages (if any) for this package. It will normally be <tt>`/usr/local/man'</tt>, but you should write it as <tt>`$(prefix)/man'</tt>. (If you are using Autoconf, write it as <samp>`@mandir@'</samp>.)</dd>
<dt><samp>`man1dir'</samp></dt>
<dd>The directory for installing section 1 man pages. Write it as <tt>`$(mandir)/man1'</tt>.</dd>
<dt><samp>`man2dir'</samp></dt>
<dd>The directory for installing section 2 man pages. Write it as <tt>`$(mandir)/man2'</tt>
</dd>
<dt><samp>`...'</samp></dt>
<dd><strong>Don't make the primary documentation for any GNU software be a man page. Write a manual in Texinfo instead. Man pages are just for the sake of people running GNU software on Unix, which is a secondary application only.</strong></dd>
<dt><samp>`manext'</samp></dt>
<dd>The file name extension for the installed man page. This should contain a period followed by the appropriate digit; it should normally be <samp>`.1'</samp>.</dd>
<dt><samp>`man1ext'</samp></dt>
<dd>The file name extension for installed section 1 man pages.</dd>
<dt><samp>`man2ext'</samp></dt>
<dd>The file name extension for installed section 2 man pages.</dd>
<dt><samp>`...'</samp></dt>
<dd>Use these names instead of <samp>`manext'</samp> if the package needs to install man pages in more than one section of the manual.</dd>
</dl>
<p>And finally, you should set the following variable:</p>
<dl compact>
<dt><samp>`srcdir'</samp></dt>
<dd>The directory for the sources being compiled. The value of this variable is normally inserted by the <span style="font-family: courier, mono;">configure</span> shell script. (If you are using Autconf, use <samp>`srcdir = @srcdir@'</samp>.)</dd>
</dl>
<p>For example:</p>
<p># Common prefix for installation directories.<br>
# NOTE: This directory must exist when you start the install.prefix = /usr/local exec_prefix = $(prefix)<br>
# Where to put the executable for the command `gcc'. bindir = $(exec_prefix)/bin<br>
# Where to put the directories used by the compiler. libexecdir = $(exec_prefix)/libexec<br>
# Where to put the Info files. infodir = $(prefix)/info</p>
<p>If your program installs a large number of files into one of the standard user-specified directories, it might be useful to group them into a subdirectory particular to that program. If you do this, you should write the <span style="font-family: courier, mono;">install</span> rule to create these subdirectories.</p>
<p>Do not expect the user to include the subdirectory name in the value of any of the variables listed above. The idea of having a uniform set of variable names for installation directories is to enable the user to specify the exact same values for several different GNU packages. In order for this to be useful, all the packages must be designed so that they will work sensibly when the user does so.</p>
<h2 class="subhead"><a id="SEC121" href="#TOC121" name="SEC121">Standard Targets for Users</a></h2>
<p>All GNU programs should have the following targets in their Makefiles:</p>
<dl compact>
<dt><samp>`all'</samp></dt>
<dd>Compile the entire program. This should be the default target. This target need not rebuild any documentation files; Info files should normally be included in the distribution, and DVI files should be made only when explicitly asked for. By default, the Make rules should compile and link with <samp>`-g'</samp>, so that executable programs have debugging symbols. Users who don't mind being helpless can strip the executables later if they wish.</dd>
<dt><samp>`install'</samp></dt>
<dd>Compile the program and copy the executables, libraries, and so on to the file names where they should reside for actual use. If there is a simple test to verify that a program is properly installed, this target should run that test. Do not strip executables when installing them. Devil-may-care users can use the <span style="font-family: courier, mono;">install-strip</span> target to do that. If possible, write the <span style="font-family: courier, mono;">install</span> target rule so that it does not modify anything in the directory where the program was built, provided <samp>`make all'</samp> has just been done. This is convenient for building the program under one user name and installing it under another. The commands should create all the directories in which files are to be installed, if they don't already exist. This includes the directories specified as the values of the variables <span style="font-family: courier, mono;">prefix</span> and <span style="font-family: courier, mono;">exec_prefix</span>, as well as all subdirectories that are needed. One way to do this is by means of an <span style="font-family: courier, mono;">installdirs</span> target as described below. Use <samp>`-'</samp> before any command for installing a man page, so that <span style="font-family: courier, mono;">make</span> will ignore any errors. This is in case there are systems that don't have the Unix man page documentation system installed. The way to install Info files is to copy them into <tt>`$(infodir)'</tt> with <span style="font-family: courier, mono;">$(INSTALL_DATA)</span> (see section <a href="#SEC119">Variables for Specifying Commands</a>), and then run the <span style="font-family: courier, mono;">install-info</span> program if it is present. <span style="font-family: courier, mono;">install-info</span> is a program that edits the Info <tt>`dir'</tt> file to add or update the menu entry for the given Info file; it is part of the Texinfo package. Here is a sample rule to install an Info file:
<p>$(DESTDIR)$(infodir)/foo.info: foo.info $(POST_INSTALL)<br>
# There may be a newer info file in . than in srcdir. -if test -f foo.info; then d=.; \ else d=$(srcdir); fi; \ $(INSTALL_DATA) $$d/foo.info $(DESTDIR)$@; \<br>
# Run install-info only if it exists.<br>
# Use `if' instead of just prepending `-' to the<br>
# line so we notice real errors from install-info.<br>
# We use `$(SHELL) -c' because some shells do not<br>
# fail gracefully when there is an unknown command. if $(SHELL) -c 'install-info --version' \ &gt;/dev/null 2&gt;&amp;1; then \ install-info --dir-file=$(DESTDIR)$(infodir)/dir \ $(DESTDIR)$(infodir)/foo.info; \ else true; fi</p>
When writing the <span style="font-family: courier, mono;">install</span> target, you must classify all the commands into three categories: normal ones, <strong>pre-installation</strong> commands and <strong>post-installation</strong> commands. See section <a href="#SEC122">Install Command Categories</a>.</dd>
<dt><samp>`uninstall'</samp></dt>
<dd>Delete all the installed files--the copies that the <samp>`install'</samp> target creates. This rule should not modify the directories where compilation is done, only the directories where files are installed. The uninstallation commands are divided into three categories, just like the installation commands. See section <a href="#SEC122">Install Command Categories</a>.</dd>
<dt><samp>`install-strip'</samp></dt>
<dd>Like <span style="font-family: courier, mono;">install</span>, but strip the executable files while installing them. In many cases, the definition of this target can be very simple:
<p>install-strip: $(MAKE) INSTALL_PROGRAM='$(INSTALL_PROGRAM) -s' \ install</p>
Normally we do not recommend stripping an executable unless you are sure the program has no bugs. However, it can be reasonable to install a stripped executable for actual execution while saving the unstripped executable elsewhere in case there is a bug.</dd>
<dt><samp>`clean'</samp></dt>
<dd>Delete all files from the current directory that are normally created by building the program. Don't delete the files that record the configuration. Also preserve files that could be made by building, but normally aren't because the distribution comes with them. Delete <tt>`.dvi'</tt> files here if they are not part of the distribution.</dd>
<dt><samp>`distclean'</samp></dt>
<dd>Delete all files from the current directory that are created by configuring or building the program. If you have unpacked the source and built the program without creating any other files, <samp>`make distclean'</samp> should leave only the files that were in the distribution.</dd>
<dt><samp>`mostlyclean'</samp></dt>
<dd>Like <samp>`clean'</samp>, but may refrain from deleting a few files that people normally don't want to recompile. For example, the <samp>`mostlyclean'</samp> target for GCC does not delete <tt>`libgcc.a'</tt>, because recompiling it is rarely necessary and takes a lot of time.</dd>
<dt><samp>`maintainer-clean'</samp></dt>
<dd>Delete almost everything from the current directory that can be reconstructed with this Makefile. This typically includes everything deleted by <span style="font-family: courier, mono;">distclean</span>, plus more: C source files produced by Bison, tags tables, Info files, and so on. The reason we say "almost everything" is that running the command <samp>`make maintainer-clean'</samp> should not delete <tt>`configure'</tt> even if <tt>`configure'</tt> can be remade using a rule in the Makefile. More generally, <samp>`make maintainer-clean'</samp> should not delete anything that needs to exist in order to run <tt>`configure'</tt> and then begin to build the program. This is the only exception; <span style="font-family: courier, mono;">maintainer-clean</span> should delete everything else that can be rebuilt. The <samp>`maintainer-clean'</samp> target is intended to be used by a maintainer of the package, not by ordinary users. You may need special tools to reconstruct some of the files that <samp>`make maintainer-clean'</samp> deletes. Since these files are normally included in the distribution, we don't take care to make them easy to reconstruct. If you find you need to unpack the full distribution again, don't blame us. To help make users aware of this, the commands for the special <span style="font-family: courier, mono;">maintainer-clean</span> target should start with these two:
<p>@echo 'This command is intended for maintainers to use; it' @echo 'deletes files that may need special tools to rebuild.'</p>
</dd>
<dt><samp>`TAGS'</samp></dt>
<dd>Update a tags table for this program.</dd>
<dt><samp>`info'</samp></dt>
<dd>Generate any Info files needed. The best way to write the rules is as follows:
<p>info: foo.infofoo.info: foo.texi chap1.texi chap2.texi $(MAKEINFO) $(srcdir)/foo.texi</p>
You must define the variable <span style="font-family: courier, mono;">MAKEINFO</span> in the Makefile. It should run the <span style="font-family: courier, mono;">makeinfo</span> program, which is part of the Texinfo distribution. Normally a GNU distribution comes with Info files, and that means the Info files are present in the source directory. Therefore, the Make rule for an info file should update it in the source directory. When users build the package, ordinarily Make will not update the Info files because they will already be up to date.</dd>
<dt><samp>`dvi'</samp></dt>
<dd>Generate DVI files for all Texinfo documentation. For example:
<p>dvi: foo.dvifoo.dvi: foo.texi chap1.texi chap2.texi $(TEXI2DVI) $(srcdir)/foo.texi</p>
You must define the variable <span style="font-family: courier, mono;">TEXI2DVI</span> in the Makefile. It should run the program <span style="font-family: courier, mono;">texi2dvi</span>, which is part of the Texinfo distribution.<a id="DOCF3" href="#FOOT3" name="DOCF3">(3)</a>Alternatively, write just the dependencies, and allow GNU <span style="font-family: courier, mono;">make</span> to provide the command.</dd>
<dt><samp>`dist'</samp></dt>
<dd>Create a distribution tar file for this program. The tar file should be set up so that the file names in the tar file start with a subdirectory name which is the name of the package it is a distribution for. This name can include the version number. For example, the distribution tar file of GCC version 1.40 unpacks into a subdirectory named <tt>`gcc-1.40'</tt>. The easiest way to do this is to create a subdirectory appropriately named, use <span style="font-family: courier, mono;">ln</span> or <span style="font-family: courier, mono;">cp</span> to install the proper files in it, and then <span style="font-family: courier, mono;">tar</span> that subdirectory. Compress the tar file file with <span style="font-family: courier, mono;">gzip</span>. For example, the actual distribution file for GCC version 1.40 is called <tt>`gcc-1.40.tar.gz'</tt>. The <span style="font-family: courier, mono;">dist</span> target should explicitly depend on all non-source files that are in the distribution, to make sure they are up to date in the distribution. See section `Making Releases' in <cite>GNU Coding Standards</cite>.</dd>
<dt><samp>`check'</samp></dt>
<dd>Perform self-tests (if any). The user must build the program before running the tests, but need not install the program; you should write the self-tests so that they work when the program is built but not installed.</dd>
</dl>
<p>The following targets are suggested as conventional names, for programs in which they are useful.</p>
<dl compact>
<dt><span style="font-family: courier, mono;">installcheck</span></dt>
<dd>Perform installation tests (if any). The user must build and install the program before running the tests. You should not assume that <tt>`$(bindir)'</tt> is in the search path.</dd>
<dt><span style="font-family: courier, mono;">installdirs</span></dt>
<dd>It's useful to add a target named <samp>`installdirs'</samp> to create the directories where files are installed, and their parent directories. There is a script called <tt>`mkinstalldirs'</tt> which is convenient for this; you can find it in the Texinfo package. You can use a rule like this:
<p># Make sure all installation directories (e.g. $(bindir))<br>
# actually exist by making them if necessary.installdirs: mkinstalldirs $(srcdir)/mkinstalldirs $(bindir) $(datadir) \ $(libdir) $(infodir) \ $(mandir)</p>
This rule should not modify the directories where compilation is done. It should do nothing but create installation directories.</dd>
</dl>
<h2 class="subhead"><a id="SEC122" href="#TOC122" name="SEC122">Install Command Categories</a></h2>
<p><a id="IDX921" name="IDX921"></a><a id="IDX922" name="IDX922"></a>When writing the <span style="font-family: courier, mono;">install</span> target, you must classify all the commands into three categories: normal ones, <strong>pre-installation</strong> commands and <strong>post-installation</strong> commands.</p>
<p>Normal commands move files into their proper places, and set their modes. They may not alter any files except the ones that come entirely from the package they belong to.</p>
<p>Pre-installation and post-installation commands may alter other files; in particular, they can edit global configuration files or data bases.</p>
<p>Pre-installation commands are typically executed before the normal commands, and post-installation commands are typically run after the normal commands.</p>
<p>The most common use for a post-installation command is to run <span style="font-family: courier, mono;">install-info</span>. This cannot be done with a normal command, since it alters a file (the Info directory) which does not come entirely and solely from the package being installed. It is a post-installation command because it needs to be done after the normal command which installs the package's Info files.</p>
<p>Most programs don't need any pre-installation commands, but we have the feature just in case it is needed.</p>
<p>To classify the commands in the <span style="font-family: courier, mono;">install</span> rule into these three categories, insert <strong>category lines</strong> among them. A category line specifies the category for the commands that follow.</p>
<p>A category line consists of a tab and a reference to a special Make variable, plus an optional comment at the end. There are three variables you can use, one for each category; the variable name specifies the category. Category lines are no-ops in ordinary execution because these three Make variables are normally undefined (and you <em>should not</em> define them in the makefile).</p>
<p>Here are the three possible category lines, each with a comment that explains what it means:</p>
<p>$(PRE_INSTALL)<br>
# Pre-install commands follow. $(POST_INSTALL) # Post-install commands follow. $(NORMAL_INSTALL)<br>
# Normal commands follow.</p>
<p>If you don't use a category line at the beginning of the <span style="font-family: courier, mono;">install</span> rule, all the commands are classified as normal until the first category line. If you don't use any category lines, all the commands are classified as normal.</p>
<p>These are the category lines for <span style="font-family: courier, mono;">uninstall</span>:</p>
<p>$(PRE_UNINSTALL) # Pre-uninstall commands follow. $(POST_UNINSTALL)<br>
# Post-uninstall commands follow. $(NORMAL_UNINSTALL)<br>
# Normal commands follow.</p>
<p>Typically, a pre-uninstall command would be used for deleting entries from the Info directory.</p>
<p>If the <span style="font-family: courier, mono;">install</span> or <span style="font-family: courier, mono;">uninstall</span> target has any dependencies which act as subroutines of installation, then you should start <em>each</em> dependency's commands with a category line, and start the main target's commands with a category line also. This way, you can ensure that each command is placed in the right category regardless of which of the dependencies actually run.</p>
<p>Pre-installation and post-installation commands should not run any programs except for these:</p>
<p>[ basename bash cat chgrp chmod chown cmp cp dd diff echo egrep expand expr false fgrep find getopt grep gunzip gzip hostname install install-info kill ldconfig ln ls md5sum mkdir mkfifo mknod mv printenv pwd rm rmdir sed sort tee test touch true uname xargs yes</p>
<p><a id="IDX923" name="IDX923"></a>The reason for distinguishing the commands in this way is for the sake of making binary packages. Typically a binary package contains all the executables and other files that need to be installed, and has its own method of installing them--so it does not need to run the normal installation commands. But installing the binary package does need to execute the pre-installation and post-installation commands.</p>
<p>Programs to build binary packages work by extracting the pre-installation and post-installation commands. Here is one way of extracting the pre-installation commands:</p>
<p>make -n install -o all \ PRE_INSTALL=pre-install \ POST_INSTALL=post-install \ NORMAL_INSTALL=normal-install \ | gawk -f pre-install.awk</p>
<p>where the file <tt>`pre-install.awk'</tt> could contain this:</p>
<p>$0 ~ /^\t[ \t]*(normal_install|post_install)[ \t]*$/ {on = 0}on {print $0} $0 ~ /^\t[ \t]*pre_install[ \t]*$/ {on = 1}</p>
<p>The resulting file of pre-installation commands is executed as a shell script as part of installing the binary package.</p>
<h2 class="subhead"><a id="SEC123" href="#TOC123" name="SEC123">Quick Reference</a></h2>
<p>This appendix summarizes the directives, text manipulation functions, and special variables which GNU <span style="font-family: courier, mono;">make</span> understands. See section <a href="#SEC36">Special Built-in Target Names</a>, section <a href="#SEC95">Catalogue of Implicit Rules</a>, and section <a href="#SEC92">Summary of Options</a>, for other summaries.</p>
<p>Here is a summary of the directives GNU <span style="font-family: courier, mono;">make</span> recognizes:</p>
<dl compact>
<dt><span style="font-family: courier, mono;">define <var>variable</var></span></dt>
<dt><span style="font-family: courier, mono;">endef</span></dt>
<dd>Define a multi-line, recursively-expanded variable.<br>
See section <a href="#SEC55">Defining Canned Command Sequences</a>.</dd>
<dt><span style="font-family: courier, mono;">ifdef <var>variable</var></span></dt>
<dt><span style="font-family: courier, mono;">ifndef <var>variable</var></span></dt>
<dt><span style="font-family: courier, mono;">ifeq (<var>a</var>,<var>b</var>)</span></dt>
<dt><span style="font-family: courier, mono;">ifeq "<var>a</var>" "<var>b</var>"</span></dt>
<dt><span style="font-family: courier, mono;">ifeq '<var>a</var>' '<var>b</var>'</span></dt>
<dt><span style="font-family: courier, mono;">ifneq (<var>a</var>,<var>b</var>)</span></dt>
<dt><span style="font-family: courier, mono;">ifneq "<var>a</var>" "<var>b</var>"</span></dt>
<dt><span style="font-family: courier, mono;">ifneq '<var>a</var>' '<var>b</var>'</span></dt>
<dt><span style="font-family: courier, mono;">else</span></dt>
<dt><span style="font-family: courier, mono;">endif</span></dt>
<dd>Conditionally evaluate part of the makefile.<br>
See section <a href="#SEC71">Conditional Parts of Makefiles</a>.</dd>
<dt><span style="font-family: courier, mono;">include <var>file</var></span></dt>
<dt><span style="font-family: courier, mono;">-include <var>file</var></span></dt>
<dt><span style="font-family: courier, mono;">sinclude <var>file</var></span></dt>
<dd>Include another makefile.<br>
See section <a href="#SEC15">Including Other Makefiles</a>.</dd>
<dt><span style="font-family: courier, mono;">override <var>variable</var> = <var>value</var></span></dt>
<dt><span style="font-family: courier, mono;">override <var>variable</var> := <var>value</var></span></dt>
<dt><span style="font-family: courier, mono;">override <var>variable</var> += <var>value</var></span></dt>
<dt><span style="font-family: courier, mono;">override <var>variable</var> ?= <var>value</var></span></dt>
<dt><span style="font-family: courier, mono;">override define <var>variable</var></span></dt>
<dt><span style="font-family: courier, mono;">endef</span></dt>
<dd>Define a variable, overriding any previous definition, even one from the command line.<br>
See section <a href="#SEC66">The <span style="font-family: courier, mono;">override</span> Directive</a>.</dd>
<dt><span style="font-family: courier, mono;">export</span></dt>
<dd>Tell <span style="font-family: courier, mono;">make</span> to export all variables to child processes by default.<br>
See section <a href="#SEC52">Communicating Variables to a Sub-<span style="font-family: courier, mono;">make</span></a>.</dd>
<dt><span style="font-family: courier, mono;">export <var>variable</var></span></dt>
<dt><span style="font-family: courier, mono;">export <var>variable</var> = <var>value</var></span></dt>
<dt><span style="font-family: courier, mono;">export <var>variable</var> := <var>value</var></span></dt>
<dt><span style="font-family: courier, mono;">export <var>variable</var> += <var>value</var></span></dt>
<dt><span style="font-family: courier, mono;">export <var>variable</var> ?= <var>value</var></span></dt>
<dt><span style="font-family: courier, mono;">unexport <var>variable</var></span></dt>
<dd>Tell <span style="font-family: courier, mono;">make</span> whether or not to export a particular variable to child processes.<br>
See section <a href="#SEC52">Communicating Variables to a Sub-<span style="font-family: courier, mono;">make</span></a>.</dd>
<dt><span style="font-family: courier, mono;">vpath <var>pattern</var> <var>path</var></span></dt>
<dd>Specify a search path for files matching a <samp>`%'</samp> pattern.<br>
See section <a href="#SEC28">The <span style="font-family: courier, mono;">vpath</span> Directive</a>.</dd>
<dt><span style="font-family: courier, mono;">vpath <var>pattern</var></span></dt>
<dd>Remove all search paths previously specified for <var>pattern</var>.</dd>
<dt><span style="font-family: courier, mono;">vpath</span></dt>
<dd>Remove all search paths previously specified in any <span style="font-family: courier, mono;">vpath</span> directive.</dd>
</dl>
<p>Here is a summary of the text manipulation functions (see section <a href="#SEC75">Functions for Transforming Text</a>):</p>
<dl compact>
<dt><span style="font-family: courier, mono;">$(subst <var>from</var>,<var>to</var>,<var>text</var>)</span></dt>
<dd>Replace <var>from</var> with <var>to</var> in <var>text</var>.<br>
See section <a href="#SEC77">Functions for String Substitution and Analysis</a>.</dd>
<dt><span style="font-family: courier, mono;">$(patsubst <var>pattern</var>,<var>replacement</var>,<var>text</var>)</span></dt>
<dd>Replace words matching <var>pattern</var> with <var>replacement</var> in <var>text</var>.<br>
See section <a href="#SEC77">Functions for String Substitution and Analysis</a>.</dd>
<dt><span style="font-family: courier, mono;">$(strip <var>string</var>)</span></dt>
<dd>Remove excess whitespace characters from <var>string</var>.<br>
See section <a href="#SEC77">Functions for String Substitution and Analysis</a>.</dd>
<dt><span style="font-family: courier, mono;">$(findstring <var>find</var>,<var>text</var>)</span></dt>
<dd>Locate <var>find</var> in <var>text</var>.<br>
See section <a href="#SEC77">Functions for String Substitution and Analysis</a>.</dd>
<dt><span style="font-family: courier, mono;">$(filter <var>pattern</var>...,<var>text</var>)</span></dt>
<dd>Select words in <var>text</var> that match one of the <var>pattern</var> words.<br>
See section <a href="#SEC77">Functions for String Substitution and Analysis</a>.</dd>
<dt><span style="font-family: courier, mono;">$(filter-out <var>pattern</var>...,<var>text</var>)</span></dt>
<dd>Select words in <var>text</var> that <em>do not</em> match any of the <var>pattern</var> words.<br>
See section <a href="#SEC77">Functions for String Substitution and Analysis</a>.</dd>
<dt><span style="font-family: courier, mono;">$(sort <var>list</var>)</span></dt>
<dd>Sort the words in <var>list</var> lexicographically, removing duplicates.<br>
See section <a href="#SEC77">Functions for String Substitution and Analysis</a>.</dd>
<dt><span style="font-family: courier, mono;">$(dir <var>names</var>...)</span></dt>
<dd>Extract the directory part of each file name.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(notdir <var>names</var>...)</span></dt>
<dd>Extract the non-directory part of each file name.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(suffix <var>names</var>...)</span></dt>
<dd>Extract the suffix (the last <samp>`.'</samp> and following characters) of each file name.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(basename <var>names</var>...)</span></dt>
<dd>Extract the base name (name without suffix) of each file name.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(addsuffix <var>suffix</var>,<var>names</var>...)</span></dt>
<dd>Append <var>suffix</var> to each word in <var>names</var>.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(addprefix <var>prefix</var>,<var>names</var>...)</span></dt>
<dd>Prepend <var>prefix</var> to each word in <var>names</var>.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(join <var>list1</var>,<var>list2</var>)</span></dt>
<dd>Join two parallel lists of words.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(word <var>n</var>,<var>text</var>)</span></dt>
<dd>Extract the <var>n</var>th word (one-origin) of <var>text</var>.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(words <var>text</var>)</span></dt>
<dd>Count the number of words in <var>text</var>.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(wordlist <var>s</var>,<var>e</var>,<var>text</var>)</span></dt>
<dd>Returns the list of words in <var>text</var> from <var>s</var> to <var>e</var>.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(firstword <var>names</var>...)</span></dt>
<dd>Extract the first word of <var>names</var>.<br>
See section <a href="#SEC78">Functions for File Names</a>.</dd>
<dt><span style="font-family: courier, mono;">$(wildcard <var>pattern</var>...)</span></dt>
<dd>Find file names matching a shell file name pattern (<em>not</em> a <samp>`%'</samp> pattern).<br>
See section <a href="#SEC25">The Function <span style="font-family: courier, mono;">wildcard</span></a>.</dd>
<dt><span style="font-family: courier, mono;">$(error <var>text</var>...)</span></dt>
<dd>When this function is evaluated, <span style="font-family: courier, mono;">make</span> generates a fatal error with the message <var>text</var>.<br>
See section <a href="#SEC84">Functions That Control Make</a>.</dd>
<dt><span style="font-family: courier, mono;">$(warning <var>text</var>...)</span></dt>
<dd>When this function is evaluated, <span style="font-family: courier, mono;">make</span> generates a warning with the message <var>text</var>.<br>
See section <a href="#SEC84">Functions That Control Make</a>.</dd>
<dt><span style="font-family: courier, mono;">$(shell <var>command</var>)</span></dt>
<dd>Execute a shell command and return its output.<br>
See section <a href="#SEC83">The <span style="font-family: courier, mono;">shell</span> Function</a>.</dd>
<dt><span style="font-family: courier, mono;">$(origin <var>variable</var>)</span></dt>
<dd>Return a string describing how the <span style="font-family: courier, mono;">make</span> variable <var>variable</var> was defined.<br>
See section <a href="#SEC82">The <span style="font-family: courier, mono;">origin</span> Function</a>.</dd>
<dt><span style="font-family: courier, mono;">$(foreach <var>var</var>,<var>words</var>,<var>text</var>)</span></dt>
<dd>Evaluate <var>text</var> with <var>var</var> bound to each word in <var>words</var>, and concatenate the results.<br>
See section <a href="#SEC79">The <span style="font-family: courier, mono;">foreach</span> Function</a>.</dd>
<dt><span style="font-family: courier, mono;">$(call <var>var</var>,<var>param</var>,...)</span></dt>
<dd>Evaluate the variable <var>var</var> replacing any references to <span style="font-family: courier, mono;">$(1)</span>, <span style="font-family: courier, mono;">$(2)</span> with the first, second, etc. <var>param</var> values.<br>
See section <a href="#SEC81">The <span style="font-family: courier, mono;">call</span> Function</a>.</dd>
</dl>
<p>Here is a summary of the automatic variables. See section <a href="#SEC101">Automatic Variables</a>, for full information.</p>
<dl compact>
<dt><span style="font-family: courier, mono;">$@</span></dt>
<dd>The file name of the target.</dd>
<dt><span style="font-family: courier, mono;">$%</span></dt>
<dd>The target member name, when the target is an archive member.</dd>
<dt><span style="font-family: courier, mono;">$&lt;</span></dt>
<dd>The name of the first prerequisite.</dd>
<dt><span style="font-family: courier, mono;">$?</span></dt>
<dd>The names of all the prerequisites that are newer than the target, with spaces between them. For prerequisites which are archive members, only the member named is used (see section <a href="#SEC108">Using <span style="font-family: courier, mono;">make</span> to Update Archive Files</a>).</dd>
<dt><span style="font-family: courier, mono;">$^</span></dt>
<dt><span style="font-family: courier, mono;">$+</span></dt>
<dd>The names of all the prerequisites, with spaces between them. For prerequisites which are archive members, only the member named is used (see section <a href="#SEC108">Using <span style="font-family: courier, mono;">make</span> to Update Archive Files</a>). The value of <span style="font-family: courier, mono;">$^</span> omits duplicate prerequisites, while <span style="font-family: courier, mono;">$+</span> retains them and preserves their order.</dd>
<dt><span style="font-family: courier, mono;">$*</span></dt>
<dd>The stem with which an implicit rule matches (see section <a href="#SEC102">How Patterns Match</a>).</dd>
<dt><span style="font-family: courier, mono;">$(@D)</span></dt>
<dt><span style="font-family: courier, mono;">$(@F)</span></dt>
<dd>The directory part and the file-within-directory part of <span style="font-family: courier, mono;">$@</span>.</dd>
<dt><span style="font-family: courier, mono;">$(*D)</span></dt>
<dt><span style="font-family: courier, mono;">$(*F)</span></dt>
<dd>The directory part and the file-within-directory part of <span style="font-family: courier, mono;">$*</span>.</dd>
<dt><span style="font-family: courier, mono;">$(%D)</span></dt>
<dt><span style="font-family: courier, mono;">$(%F)</span></dt>
<dd>The directory part and the file-within-directory part of <span style="font-family: courier, mono;">$%</span>.</dd>
<dt><span style="font-family: courier, mono;">$(&lt;D)</span></dt>
<dt><span style="font-family: courier, mono;">$(&lt;F)</span></dt>
<dd>The directory part and the file-within-directory part of <span style="font-family: courier, mono;">$&lt;</span>.</dd>
<dt><span style="font-family: courier, mono;">$(^D)</span></dt>
<dt><span style="font-family: courier, mono;">$(^F)</span></dt>
<dd>The directory part and the file-within-directory part of <span style="font-family: courier, mono;">$^</span>.</dd>
<dt><span style="font-family: courier, mono;">$(+D)</span></dt>
<dt><span style="font-family: courier, mono;">$(+F)</span></dt>
<dd>The directory part and the file-within-directory part of <span style="font-family: courier, mono;">$+</span>.</dd>
<dt><span style="font-family: courier, mono;">$(?D)</span></dt>
<dt><span style="font-family: courier, mono;">$(?F)</span></dt>
<dd>The directory part and the file-within-directory part of <span style="font-family: courier, mono;">$?</span>.</dd>
</dl>
<p>These variables are used specially by GNU <span style="font-family: courier, mono;">make</span>:</p>
<dl compact>
<dt><span style="font-family: courier, mono;">MAKEFILES</span></dt>
<dd>Makefiles to be read on every invocation of <span style="font-family: courier, mono;">make</span>.<br>
See section <a href="#SEC16">The Variable <span style="font-family: courier, mono;">MAKEFILES</span></a>.</dd>
<dt><span style="font-family: courier, mono;">VPATH</span></dt>
<dd>Directory search path for files not found in the current directory.<br>
See section <a href="#SEC27"><span style="font-family: courier, mono;">VPATH</span>: Search Path for All Prerequisites</a>.</dd>
<dt><span style="font-family: courier, mono;">SHELL</span></dt>
<dd>The name of the system default command interpreter, usually <tt>`/bin/sh'</tt>. You can set <span style="font-family: courier, mono;">SHELL</span> in the makefile to change the shell used to run commands. See section <a href="#SEC46">Command Execution</a>.</dd>
<dt><span style="font-family: courier, mono;">MAKESHELL</span></dt>
<dd>On MS-DOS only, the name of the command interpreter that is to be used by <span style="font-family: courier, mono;">make</span>. This value takes precedence over the value of <span style="font-family: courier, mono;">SHELL</span>. See section <a href="#SEC46">Command Execution</a>.</dd>
<dt><span style="font-family: courier, mono;">MAKE</span></dt>
<dd>The name with which <span style="font-family: courier, mono;">make</span> was invoked. Using this variable in commands has special meaning. See section <a href="#SEC51">How the <span style="font-family: courier, mono;">MAKE</span> Variable Works</a>.</dd>
<dt><span style="font-family: courier, mono;">MAKELEVEL</span></dt>
<dd>The number of levels of recursion (sub-<span style="font-family: courier, mono;">make</span>s).<br>
See section <a href="#SEC52">Communicating Variables to a Sub-<span style="font-family: courier, mono;">make</span></a>.</dd>
<dt><span style="font-family: courier, mono;">MAKEFLAGS</span></dt>
<dd>The flags given to <span style="font-family: courier, mono;">make</span>. You can set this in the environment or a makefile to set flags.<br>
See section <a href="#SEC53">Communicating Options to a Sub-<span style="font-family: courier, mono;">make</span></a>. It is <em>never</em> appropriate to use <span style="font-family: courier, mono;">MAKEFLAGS</span> directly on a command line: its contents may not be quoted correctly for use in the shell. Always allow recursive <span style="font-family: courier, mono;">make</span>'s to obtain these values through the environment from its parent.</dd>
<dt><span style="font-family: courier, mono;">MAKECMDGOALS</span></dt>
<dd>The targets given to <span style="font-family: courier, mono;">make</span> on the command line. Setting this variable has no effect on the operation of <span style="font-family: courier, mono;">make</span>.<br>
See section <a href="#SEC87">Arguments to Specify the Goals</a>.</dd>
<dt><span style="font-family: courier, mono;">CURDIR</span></dt>
<dd>Set to the pathname of the current working directory (after all <span style="font-family: courier, mono;">-C</span> options are processed, if any). Setting this variable has no effect on the operation of <span style="font-family: courier, mono;">make</span>.<br>
See section <a href="#SEC50">Recursive Use of <span style="font-family: courier, mono;">make</span></a>.</dd>
<dt><span style="font-family: courier, mono;">SUFFIXES</span></dt>
<dd>The default list of suffixes before <span style="font-family: courier, mono;">make</span> reads any makefiles.</dd>
<dt><span style="font-family: courier, mono;">.LIBPATTERNS</span></dt>
<dd>Defines the naming of the libraries <span style="font-family: courier, mono;">make</span> searches for, and their order.<br>
See section <a href="#SEC32">Directory Search for Link Libraries</a>.</dd>
</dl>
<h2 class="subhead"><a id="SEC124" href="#TOC124" name="SEC124">Errors Generated by Make</a></h2>
<p>Here is a list of the more common errors you might see generated by <span style="font-family: courier, mono;">make</span>, and some information about what they mean and how to fix them.</p>
<p>Sometimes <span style="font-family: courier, mono;">make</span> errors are not fatal, especially in the presence of a <span style="font-family: courier, mono;">-</span> prefix on a command script line, or the <span style="font-family: courier, mono;">-k</span> command line option. Errors that are fatal are prefixed with the string <span style="font-family: courier, mono;">***</span>.</p>
<p>Error messages are all either prefixed with the name of the program (usually <samp>`make'</samp>), or, if the error is found in a makefile, the name of the file and linenumber containing the problem.</p>
<p>In the table below, these common prefixes are left off.</p>
<dl compact>
<dt><samp>`[<var>foo</var>] Error <var>NN</var>'</samp></dt>
<dt><samp>`[<var>foo</var>] <var>signal description</var>'</samp></dt>
<dd>These errors are not really <span style="font-family: courier, mono;">make</span> errors at all. They mean that a program that <span style="font-family: courier, mono;">make</span> invoked as part of a command script returned a non-0 error code (<samp>`Error <var>NN</var>'</samp>), which <span style="font-family: courier, mono;">make</span> interprets as failure, or it exited in some other abnormal fashion (with a signal of some type). See section <a href="#SEC48">Errors in Commands</a>. If no <span style="font-family: courier, mono;">***</span> is attached to the message, then the subprocess failed but the rule in the makefile was prefixed with the <span style="font-family: courier, mono;">-</span> special character, so <span style="font-family: courier, mono;">make</span> ignored the error.</dd>
<dt><samp>`missing separator. Stop.'</samp></dt>
<dt><samp>`missing separator (did you mean TAB instead of 8 spaces?). Stop.'</samp></dt>
<dd>This means that <span style="font-family: courier, mono;">make</span> could not understand much of anything about the command line it just read. GNU <span style="font-family: courier, mono;">make</span> looks for various kinds of separators (<span style="font-family: courier, mono;">:</span>, <span style="font-family: courier, mono;">=</span>, TAB characters, etc.) to help it decide what kind of commandline it's seeing. This means it couldn't find a valid one. One of the most common reasons for this message is that you (or perhaps your oh-so-helpful editor, as is the case with many MS-Windows editors) have attempted to indent your command scripts with spaces instead of a TAB character. In this case, <span style="font-family: courier, mono;">make</span> will use the second form of the error above. Remember that every line in the command script must begin with a TAB character. Eight spaces do not count. See section <a href="#SEC21">Rule Syntax</a>.</dd>
<dt><samp>`commands commence before first target. Stop.'</samp></dt>
<dt><samp>`missing rule before commands. Stop.'</samp></dt>
<dd>This means the first thing in the makefile seems to be part of a command script: it begins with a TAB character and doesn't appear to be a legal <span style="font-family: courier, mono;">make</span> command (such as a variable assignment). Command scripts must always be associated with a target. The second form is generated if the line has a semicolon as the first non-whitespace character; <span style="font-family: courier, mono;">make</span> interprets this to mean you left out the "target: prerequisite" section of a rule. See section <a href="#SEC21">Rule Syntax</a>.</dd>
<dt><samp>`No rule to make target `<var>xxx</var>'.'</samp></dt>
<dt><samp>`No rule to make target `<var>xxx</var>', needed by `<var>yyy</var>'.'</samp></dt>
<dd>This means that <span style="font-family: courier, mono;">make</span> decided it needed to build a target, but then couldn't find any instructions in the makefile on how to do that, either explicit or implicit (including in the default rules database). If you want that file to be built, you will need to add a rule to your makefile describing how that target can be built. Other possible sources of this problem are typos in the makefile (if that filename is wrong) or a corrupted source tree (if that file is not supposed to be built, but rather only a prerequisite).</dd>
<dt><samp>`No targets specified and no makefile found. Stop.'</samp></dt>
<dt><samp>`No targets. Stop.'</samp></dt>
<dd>The former means that you didn't provide any targets to be built on the command line, and <span style="font-family: courier, mono;">make</span> couldn't find any makefiles to read in. The latter means that some makefile was found, but it didn't contain any default target and none was given on the command line. GNU <span style="font-family: courier, mono;">make</span> has nothing to do in these situations. See section <a href="#SEC86">Arguments to Specify the Makefile</a>.</dd>
<dt><samp>`Makefile `<var>xxx</var>' was not found.'</samp></dt>
<dt><samp>`Included makefile `<var>xxx</var>' was not found.'</samp></dt>
<dd>A makefile specified on the command line (first form) or included (second form) was not found.</dd>
<dt><samp>`warning: overriding commands for target `<var>xxx</var>''</samp></dt>
<dt><samp>`warning: ignoring old commands for target `<var>xxx</var>''</samp></dt>
<dd>GNU <span style="font-family: courier, mono;">make</span> allows commands to be specified only once per target (except for double-colon rules). If you give commands for a target which already has been defined to have commands, this warning is issued and the second set of commands will overwrite the first set. See section <a href="#SEC38">Multiple Rules for One Target</a>.</dd>
<dt><samp>`Circular <var>xxx</var> &lt;- <var>yyy</var> dependency dropped.'</samp></dt>
<dd>This means that <span style="font-family: courier, mono;">make</span> detected a loop in the dependency graph: after tracing the prerequisite <var>yyy</var> of target <var>xxx</var>, and its prerequisites, etc., one of them depended on <var>xxx</var> again.</dd>
<dt><samp>`Recursive variable `<var>xxx</var>' references itself (eventually). Stop.'</samp></dt>
<dd>This means you've defined a normal (recursive) <span style="font-family: courier, mono;">make</span> variable <var>xxx</var> that, when it's expanded, will refer to itself (<var>xxx</var>). This is not allowed; either use simply-expanded variables (<span style="font-family: courier, mono;">:=</span>) or use the append operator (<span style="font-family: courier, mono;">+=</span>). See section <a href="#SEC57">How to Use Variables</a>.</dd>
<dt><samp>`Unterminated variable reference. Stop.'</samp></dt>
<dd>This means you forgot to provide the proper closing parenthesis or brace in your variable or function reference.</dd>
<dt><samp>`insufficient arguments to function `<var>xxx</var>'. Stop.'</samp></dt>
<dd>This means you haven't provided the requisite number of arguments for this function. See the documentation of the function for a description of its arguments. See section <a href="#SEC75">Functions for Transforming Text</a>.</dd>
<dt><samp>`missing target pattern. Stop.'</samp></dt>
<dt><samp>`multiple target patterns. Stop.'</samp></dt>
<dt><samp>`target pattern contains no `%'. Stop.'</samp></dt>
<dd>These are generated for malformed static pattern rules. The first means there's no pattern in the target section of the rule, the second means there are multiple patterns in the target section, and the third means the target doesn't contain a pattern character (<span style="font-family: courier, mono;">%</span>). See section <a href="#SEC40">Syntax of Static Pattern Rules</a>.</dd>
<dt><samp>`warning: -jN forced in submake: disabling jobserver mode.'</samp></dt>
<dd>This warning and the next are generated if <span style="font-family: courier, mono;">make</span> detects error conditions related to parallel processing on systems where sub-<span style="font-family: courier, mono;">make</span>s can communicate (see section <a href="#SEC53">Communicating Options to a Sub-<span style="font-family: courier, mono;">make</span></a>). This warning is generated if a recursive invocation of a <span style="font-family: courier, mono;">make</span> process is forced to have <samp>`-j<var>N</var>'</samp> in its argument list (where <var>N</var> is greater than one). This could happen, for example, if you set the <span style="font-family: courier, mono;">MAKE</span> environment variable to <samp>`make -j2'</samp>. In this case, the sub-<span style="font-family: courier, mono;">make</span> doesn't communicate with other <span style="font-family: courier, mono;">make</span> processes and will simply pretend it has two jobs of its own.</dd>
<dt><samp>`warning: jobserver unavailable: using -j1. Add `+' to parent make rule.'</samp></dt>
<dd>In order for <span style="font-family: courier, mono;">make</span> processes to communicate, the parent will pass information to the child. Since this could result in problems if the child process isn't actually a <span style="font-family: courier, mono;">make</span>, the parent will only do this if it thinks the child is a <span style="font-family: courier, mono;">make</span>. The parent uses the normal algorithms to determine this (see section <a href="#SEC51">How the <span style="font-family: courier, mono;">MAKE</span> Variable Works</a>). If the makefile is constructed such that the parent doesn't know the child is a <span style="font-family: courier, mono;">make</span> process, then the child will receive only part of the information necessary. In this case, the child will generate this warning message and proceed with its build in a sequential manner.</dd>
</dl>
<h2 class="subhead"><a id="SEC125" href="#TOC125" name="SEC125">Complex Makefile Example</a></h2>
<p>Here is the makefile for the GNU <span style="font-family: courier, mono;">tar</span> program. This is a moderately complex makefile.</p>
<p>Because it is the first target, the default goal is <samp>`all'</samp>. An interesting feature of this makefile is that <tt>`testpad.h'</tt> is a source file automatically created by the <span style="font-family: courier, mono;">testpad</span> program, itself compiled from <tt>`testpad.c'</tt>.</p>
<p>If you type <samp>`make'</samp> or <samp>`make all'</samp>, then <span style="font-family: courier, mono;">make</span> creates the <tt>`tar'</tt> executable, the <tt>`rmt'</tt> daemon that provides remote tape access, and the <tt>`tar.info'</tt> Info file.</p>
<p>If you type <samp>`make install'</samp>, then <span style="font-family: courier, mono;">make</span> not only creates <tt>`tar'</tt>, <tt>`rmt'</tt>, and <tt>`tar.info'</tt>, but also installs them.</p>
<p>If you type <samp>`make clean'</samp>, then <span style="font-family: courier, mono;">make</span> removes the <samp>`.o'</samp> files, and the <tt>`tar'</tt>, <tt>`rmt'</tt>, <tt>`testpad'</tt>, <tt>`testpad.h'</tt>, and <tt>`core'</tt> files.</p>
<p>If you type <samp>`make distclean'</samp>, then <span style="font-family: courier, mono;">make</span> not only removes the same files as does <samp>`make clean'</samp> but also the <tt>`TAGS'</tt>, <tt>`Makefile'</tt>, and <tt>`config.status'</tt> files. (Although it is not evident, this makefile (and <tt>`config.status'</tt>) is generated by the user with the <span style="font-family: courier, mono;">configure</span> program, which is provided in the <span style="font-family: courier, mono;">tar</span> distribution, but is not shown here.)</p>
<p>If you type <samp>`make realclean'</samp>, then <span style="font-family: courier, mono;">make</span> removes the same files as does <samp>`make distclean'</samp> and also removes the Info files generated from <tt>`tar.texinfo'</tt>.</p>
<p>In addition, there are targets <span style="font-family: courier, mono;">shar</span> and <span style="font-family: courier, mono;">dist</span> that create distribution kits.</p>
<p># Generated automatically from Makefile.in by configure.<br>
# Un*x Makefile for GNU tar program.<br>
# Copyright (C) 1991 Free Software Foundation, Inc.<br><br>
# This program is free software; you can redistribute<br>
# it and/or modify it under the terms of the GNU<br>
# General Public License ...<br>
...<br>
...<br><br>
SHELL = /bin/sh<br><br>
#### Start of system configuration section. ####<br><br>
srcdir = .<br><br>
# If you use gcc, you should either run the<br>
# fixincludes script that comes with it or else use<br>
# gcc with the -traditional option.  Otherwise ioctl<br>
# calls will be compiled incorrectly on some systems.<br>
CC = gcc -O<br>
YACC = bison -y<br>
INSTALL = /usr/local/bin/install -c<br>
INSTALLDATA = /usr/local/bin/install -c -m 644<br><br>
# Things you might add to DEFS:<br>
# -DSTDC_HEADERS        If you have ANSI C headers and<br>
#                       libraries.<br>
# -DPOSIX               If you have POSIX.1 headers and<br>
#                       libraries.<br>
# -DBSD42               If you have sys/dir.h (unless<br>
#                       you use -DPOSIX), sys/file.h,<br>
#                       and st_blocks in `struct stat'.<br>
# -DUSG                 If you have System V/ANSI C<br>
#                       string and memory functions<br>
#                       and headers, sys/sysmacros.h,<br>
#                       fcntl.h, getcwd, no valloc,<br>
#                       and ndir.h (unless<br>
#                       you use -DDIRENT).<br>
# -DNO_MEMORY_H         If USG or STDC_HEADERS but do not<br>
#                       include memory.h.<br>
# -DDIRENT              If USG and you have dirent.h<br>
#                       instead of ndir.h.<br>
# -DSIGTYPE=int         If your signal handlers<br>
#                       return int, not void.<br>
# -DNO_MTIO             If you lack sys/mtio.h<br>
#                       (magtape ioctls).<br>
# -DNO_REMOTE           If you do not have a remote shell<br>
#                       or rexec.<br>
# -DUSE_REXEC           To use rexec for remote tape<br>
#                       operations instead of<br>
#                       forking rsh or remsh.<br>
# -DVPRINTF_MISSING     If you lack vprintf function<br>
#                       (but have _doprnt).<br>
# -DDOPRNT_MISSING      If you lack _doprnt function.<br>
#                       Also need to define<br>
#                       -DVPRINTF_MISSING.<br>
# -DFTIME_MISSING       If you lack ftime system call.<br>
# -DSTRSTR_MISSING      If you lack strstr function.<br>
# -DVALLOC_MISSING      If you lack valloc function.<br>
# -DMKDIR_MISSING       If you lack mkdir and<br>
#                       rmdir system calls.<br>
# -DRENAME_MISSING      If you lack rename system call.<br>
# -DFTRUNCATE_MISSING   If you lack ftruncate<br>
#                       system call.<br>
# -DV7                  On Version 7 Unix (not<br>
#                       tested in a long time).<br>
# -DEMUL_OPEN3          If you lack a 3-argument version<br>
#                       of open, and want to emulate it<br>
#                       with system calls you do have.<br>
# -DNO_OPEN3            If you lack the 3-argument open<br>
#                       and want to disable the tar -k<br>
#                       option instead of emulating open.<br>
# -DXENIX               If you have sys/inode.h<br>
#                       and need it 94 to be included.<br><br>
DEFS =  -DSIGTYPE=int -DDIRENT -DSTRSTR_MISSING \<br>
        -DVPRINTF_MISSING -DBSD42<br>
# Set this to rtapelib.o unless you defined NO_REMOTE,<br>
# in which case make it empty.<br>
RTAPELIB = rtapelib.o<br>
LIBS =<br>
DEF_AR_FILE = /dev/rmt8<br>
DEFBLOCKING = 20<br><br>
CDEBUG = -g<br>
CFLAGS = $(CDEBUG) -I. -I$(srcdir) $(DEFS) \<br>
        -DDEF_AR_FILE=\"$(DEF_AR_FILE)\" \<br>
        -DDEFBLOCKING=$(DEFBLOCKING)<br>
LDFLAGS = -g<br><br>
prefix = /usr/local<br>
# Prefix for each installed program,<br>
# normally empty or `g'.<br>
binprefix =<br><br>
# The directory to install tar in.<br>
bindir = $(prefix)/bin<br><br>
# The directory to install the info files in.<br>
infodir = $(prefix)/info<br><br>
#### End of system configuration section. ####<br><br>
SRC1 =  tar.c create.c extract.c buffer.c \<br>
        getoldopt.c update.c gnu.c mangle.c<br>
SRC2 =  version.c list.c names.c diffarch.c \<br>
        port.c wildmat.c getopt.c<br>
SRC3 =  getopt1.c regex.c getdate.y<br>
SRCS =  $(SRC1) $(SRC2) $(SRC3)<br>
OBJ1 =  tar.o create.o extract.o buffer.o \<br>
        getoldopt.o update.o gnu.o mangle.o<br>
OBJ2 =  version.o list.o names.o diffarch.o \<br>
        port.o wildmat.o getopt.o<br>
OBJ3 =  getopt1.o regex.o getdate.o $(RTAPELIB)<br>
OBJS =  $(OBJ1) $(OBJ2) $(OBJ3)<br>
AUX =   README COPYING ChangeLog Makefile.in  \<br>
        makefile.pc configure configure.in \<br>
        tar.texinfo tar.info* texinfo.tex \<br>
        tar.h port.h open3.h getopt.h regex.h \<br>
        rmt.h rmt.c rtapelib.c alloca.c \<br>
        msd_dir.h msd_dir.c tcexparg.c \<br>
        level-0 level-1 backup-specs testpad.c<br><br>
all:    tar rmt tar.info<br><br>
tar:    $(OBJS)<br>
        $(CC) $(LDFLAGS) -o $@ $(OBJS) $(LIBS)<br><br>
rmt:    rmt.c<br>
        $(CC) $(CFLAGS) $(LDFLAGS) -o $@ rmt.c<br><br>
tar.info: tar.texinfo<br>
        makeinfo tar.texinfo<br><br>
install: all<br>
        $(INSTALL) tar $(bindir)/$(binprefix)tar<br>
        -test ! -f rmt || $(INSTALL) rmt /etc/rmt<br>
        $(INSTALLDATA) $(srcdir)/tar.info* $(infodir)<br><br>
$(OBJS): tar.h port.h testpad.h<br>
regex.o buffer.o tar.o: regex.h<br>
# getdate.y has 8 shift/reduce conflicts.<br><br>
testpad.h: testpad<br>
        ./testpad<br><br>
testpad: testpad.o<br>
        $(CC) -o $@ testpad.o<br><br>
TAGS:   $(SRCS)<br>
        etags $(SRCS)<br><br>
clean:<br>
        rm -f *.o tar rmt testpad testpad.h core<br><br>
distclean: clean<br>
        rm -f TAGS Makefile config.status<br><br>
realclean: distclean<br>
        rm -f tar.info*<br><br>
shar: $(SRCS) $(AUX)<br>
        shar $(SRCS) $(AUX) | compress \<br>
          &gt; tar-`sed -e '/version_string/!d' \<br>
                     -e 's/[^0-9.]*\([0-9.]*\).*/\1/' \<br>
                     -e q<br>
                     version.c`.shar.Z<br><br>
dist: $(SRCS) $(AUX)<br>
        echo tar-`sed \<br>
             -e '/version_string/!d' \<br>
             -e 's/[^0-9.]*\([0-9.]*\).*/\1/' \<br>
             -e q<br>
             version.c` &gt; .fname<br>
        -rm -rf `cat .fname`<br>
        mkdir `cat .fname`<br>
        ln $(SRCS) $(AUX) `cat .fname`<br>
        tar chZf `cat .fname`.tar.Z `cat .fname`<br>
        -rm -rf `cat .fname` .fname<br><br>
tar.zoo: $(SRCS) $(AUX)<br>
        -rm -rf tmp.dir<br>
        -mkdir tmp.dir<br>
        -rm tar.zoo<br>
        for X in $(SRCS) $(AUX) ; do \<br>
            echo $$X ; \<br>
            sed 's/$$/^M/' $$X \<br>
            &gt; tmp.dir/$$X ; done<br>
        cd tmp.dir ; zoo aM ../tar.zoo *<br>
        -rm -rf tmp.dir<br></p>
<p><a id="SEC126" href="#TOC126" name="SEC126">Index of Concepts</a></p>
<p>#</p>
<p><a href="#IDX269"><span style="font-family: courier, mono;">#</span> (comments), in commands</a></p>
<ul>
<li><a href="#IDX56"><span style="font-family: courier, mono;">#</span> (comments), in makefile</a></li>
<li><a href="#IDX257"><span style="font-family: courier, mono;">#include</span></a></li>
</ul>
<h2 class="subhead">$</h2>
<ul>
<li><a href="#IDX489"><span style="font-family: courier, mono;">$</span>, in function call</a></li>
<li><a href="#IDX127"><span style="font-family: courier, mono;">$</span>, in rules</a></li>
<li><a href="#IDX455"><span style="font-family: courier, mono;">$</span>, in variable name</a></li>
<li><a href="#IDX421"><span style="font-family: courier, mono;">$</span>, in variable reference</a></li>
</ul>
<h2 class="subhead">%</h2>
<ul>
<li><a href="#IDX831"><span style="font-family: courier, mono;">%</span>, in pattern rules</a></li>
<li><a href="#IDX242"><span style="font-family: courier, mono;">%</span>, quoting in static pattern</a></li>
<li><a href="#IDX496"><span style="font-family: courier, mono;">%</span>, quoting in <span style="font-family: courier, mono;">patsubst</span></a></li>
<li><a href="#IDX159"><span style="font-family: courier, mono;">%</span>, quoting in <span style="font-family: courier, mono;">vpath</span></a></li>
<li>
<a href="#IDX160"><span style="font-family: courier, mono;">%</span>, quoting with <span style="font-family: courier, mono;">\</span> (backslash)</a>, <a href="#IDX243"><span style="font-family: courier, mono;">%</span>, quoting with <span style="font-family: courier, mono;">\</span> (backslash)</a>, <a href="#IDX497"><span style="font-family: courier, mono;">%</span>, quoting with <span style="font-family: courier, mono;">\</span> (backslash)</a>
</li>
</ul>
<h2 class="subhead">*</h2>
<ul>
<li><a href="#IDX134"><span style="font-family: courier, mono;">*</span> (wildcard character)</a></li>
</ul>
<h2 class="subhead">+</h2>
<ul>
<li><a href="#IDX410">+, and <span style="font-family: courier, mono;">define</span></a></li>
<li><a href="#IDX464">+=</a></li>
<li>
<a href="#IDX100">+=, expansion</a>, <a href="#IDX103">+=, expansion</a>
</li>
</ul>
<h2 class="subhead">,</h2>
<ul>
<li><a href="#IDX761">,v (RCS file extension)</a></li>
</ul>
<h2 class="subhead">-</h2>
<ul>
<li><a href="#IDX315"><span style="font-family: courier, mono;">-</span> (in commands)</a></li>
<li><a href="#IDX409">-, and <span style="font-family: courier, mono;">define</span></a></li>
<li>
<a href="#IDX612"><span style="font-family: courier, mono;">--assume-new</span></a>, <a href="#IDX690"><span style="font-family: courier, mono;">--assume-new</span></a>
</li>
<li><a href="#IDX372"><span style="font-family: courier, mono;">--assume-new</span>, and recursion</a></li>
<li>
<a href="#IDX618"><span style="font-family: courier, mono;">--assume-old</span></a>, <a href="#IDX663"><span style="font-family: courier, mono;">--assume-old</span></a>
</li>
<li><a href="#IDX371"><span style="font-family: courier, mono;">--assume-old</span>, and recursion</a></li>
<li><a href="#IDX638"><span style="font-family: courier, mono;">--debug</span></a></li>
<li>
<a href="#IDX337"><span style="font-family: courier, mono;">--directory</span></a>, <a href="#IDX636"><span style="font-family: courier, mono;">--directory</span></a>
</li>
<li><a href="#IDX368"><span style="font-family: courier, mono;">--directory</span>, and recursion</a></li>
<li><a href="#IDX396"><span style="font-family: courier, mono;">--directory</span>, and <span style="font-family: courier, mono;">--print-directory</span></a></li>
<li>
<a href="#IDX277"><span style="font-family: courier, mono;">--dry-run</span></a>, <a href="#IDX600"><span style="font-family: courier, mono;">--dry-run</span></a>, <a href="#IDX659"><span style="font-family: courier, mono;">--dry-run</span></a>
</li>
<li><a href="#IDX640"><span style="font-family: courier, mono;">--environment-overrides</span></a></li>
<li>
<a href="#IDX66"><span style="font-family: courier, mono;">--file</span></a>, <a href="#IDX577"><span style="font-family: courier, mono;">--file</span></a>, <a href="#IDX642"><span style="font-family: courier, mono;">--file</span></a>
</li>
<li><a href="#IDX369"><span style="font-family: courier, mono;">--file</span>, and recursion</a></li>
<li><a href="#IDX645"><span style="font-family: courier, mono;">--help</span></a></li>
<li>
<a href="#IDX318"><span style="font-family: courier, mono;">--ignore-errors</span></a>, <a href="#IDX647"><span style="font-family: courier, mono;">--ignore-errors</span></a>
</li>
<li>
<a href="#IDX82"><span style="font-family: courier, mono;">--include-dir</span></a>, <a href="#IDX649"><span style="font-family: courier, mono;">--include-dir</span></a>
</li>
<li>
<a href="#IDX303"><span style="font-family: courier, mono;">--jobs</span></a>, <a href="#IDX651"><span style="font-family: courier, mono;">--jobs</span></a>
</li>
<li><a href="#IDX379"><span style="font-family: courier, mono;">--jobs</span>, and recursion</a></li>
<li>
<a href="#IDX276"><span style="font-family: courier, mono;">--just-print</span></a>, <a href="#IDX599"><span style="font-family: courier, mono;">--just-print</span></a>, <a href="#IDX658"><span style="font-family: courier, mono;">--just-print</span></a>
</li>
<li>
<a href="#IDX321"><span style="font-family: courier, mono;">--keep-going</span></a>, <a href="#IDX629"><span style="font-family: courier, mono;">--keep-going</span></a>, <a href="#IDX653"><span style="font-family: courier, mono;">--keep-going</span></a>
</li>
<li>
<a href="#IDX311"><span style="font-family: courier, mono;">--load-average</span></a>, <a href="#IDX655"><span style="font-family: courier, mono;">--load-average</span></a>
</li>
<li>
<a href="#IDX67"><span style="font-family: courier, mono;">--makefile</span></a>, <a href="#IDX578"><span style="font-family: courier, mono;">--makefile</span></a>, <a href="#IDX643"><span style="font-family: courier, mono;">--makefile</span></a>
</li>
<li>
<a href="#IDX310"><span style="font-family: courier, mono;">--max-load</span></a>, <a href="#IDX656"><span style="font-family: courier, mono;">--max-load</span></a>
</li>
<li>
<a href="#IDX613"><span style="font-family: courier, mono;">--new-file</span></a>, <a href="#IDX689"><span style="font-family: courier, mono;">--new-file</span></a>
</li>
<li><a href="#IDX373"><span style="font-family: courier, mono;">--new-file</span>, and recursion</a></li>
<li><a href="#IDX671"><span style="font-family: courier, mono;">--no-builtin-rules</span></a></li>
<li><a href="#IDX673"><span style="font-family: courier, mono;">--no-builtin-variables</span></a></li>
<li><a href="#IDX678"><span style="font-family: courier, mono;">--no-keep-going</span></a></li>
<li>
<a href="#IDX402"><span style="font-family: courier, mono;">--no-print-directory</span></a>, <a href="#IDX686"><span style="font-family: courier, mono;">--no-print-directory</span></a>
</li>
<li>
<a href="#IDX617"><span style="font-family: courier, mono;">--old-file</span></a>, <a href="#IDX662"><span style="font-family: courier, mono;">--old-file</span></a>
</li>
<li><a href="#IDX370"><span style="font-family: courier, mono;">--old-file</span>, and recursion</a></li>
<li><a href="#IDX665"><span style="font-family: courier, mono;">--print-data-base</span></a></li>
<li><a href="#IDX685"><span style="font-family: courier, mono;">--print-directory</span></a></li>
<li><a href="#IDX401"><span style="font-family: courier, mono;">--print-directory</span>, and recursion</a></li>
<li><a href="#IDX403"><span style="font-family: courier, mono;">--print-directory</span>, disabling</a></li>
<li><a href="#IDX400"><span style="font-family: courier, mono;">--print-directory</span>, and <span style="font-family: courier, mono;">--directory</span></a></li>
<li>
<a href="#IDX607"><span style="font-family: courier, mono;">--question</span></a>, <a href="#IDX669"><span style="font-family: courier, mono;">--question</span></a>
</li>
<li>
<a href="#IDX281"><span style="font-family: courier, mono;">--quiet</span></a>, <a href="#IDX676"><span style="font-family: courier, mono;">--quiet</span></a>
</li>
<li>
<a href="#IDX278"><span style="font-family: courier, mono;">--recon</span></a>, <a href="#IDX601"><span style="font-family: courier, mono;">--recon</span></a>, <a href="#IDX660"><span style="font-family: courier, mono;">--recon</span></a>
</li>
<li>
<a href="#IDX280"><span style="font-family: courier, mono;">--silent</span></a>, <a href="#IDX675"><span style="font-family: courier, mono;">--silent</span></a>
</li>
<li><a href="#IDX679"><span style="font-family: courier, mono;">--stop</span></a></li>
<li>
<a href="#IDX603"><span style="font-family: courier, mono;">--touch</span></a>, <a href="#IDX681"><span style="font-family: courier, mono;">--touch</span></a>
</li>
<li><a href="#IDX343"><span style="font-family: courier, mono;">--touch</span>, and recursion</a></li>
<li><a href="#IDX683"><span style="font-family: courier, mono;">--version</span></a></li>
<li><a href="#IDX691"><span style="font-family: courier, mono;">--warn-undefined-variables</span></a></li>
<li>
<a href="#IDX610"><span style="font-family: courier, mono;">--what-if</span></a>, <a href="#IDX688"><span style="font-family: courier, mono;">--what-if</span></a>
</li>
<li><a href="#IDX633"><span style="font-family: courier, mono;">-b</span></a></li>
<li>
<a href="#IDX336"><span style="font-family: courier, mono;">-C</span></a>, <a href="#IDX635"><span style="font-family: courier, mono;">-C</span></a>
</li>
<li><a href="#IDX364"><span style="font-family: courier, mono;">-C</span>, and recursion</a></li>
<li><a href="#IDX395"><span style="font-family: courier, mono;">-C</span>, and <span style="font-family: courier, mono;">-w</span></a></li>
<li><a href="#IDX637"><span style="font-family: courier, mono;">-d</span></a></li>
<li><a href="#IDX639"><span style="font-family: courier, mono;">-e</span></a></li>
<li><a href="#IDX260"><span style="font-family: courier, mono;">-e</span> (shell flag)</a></li>
<li>
<a href="#IDX65"><span style="font-family: courier, mono;">-f</span></a>, <a href="#IDX579"><span style="font-family: courier, mono;">-f</span></a>, <a href="#IDX641"><span style="font-family: courier, mono;">-f</span></a>
</li>
<li><a href="#IDX365"><span style="font-family: courier, mono;">-f</span>, and recursion</a></li>
<li><a href="#IDX644"><span style="font-family: courier, mono;">-h</span></a></li>
<li>
<a href="#IDX81"><span style="font-family: courier, mono;">-I</span></a>, <a href="#IDX648"><span style="font-family: courier, mono;">-I</span></a>
</li>
<li>
<a href="#IDX317"><span style="font-family: courier, mono;">-i</span></a>, <a href="#IDX646"><span style="font-family: courier, mono;">-i</span></a>
</li>
<li>
<a href="#IDX302"><span style="font-family: courier, mono;">-j</span></a>, <a href="#IDX650"><span style="font-family: courier, mono;">-j</span></a>
</li>
<li><a href="#IDX906"><span style="font-family: courier, mono;">-j</span>, and archive update</a></li>
<li><a href="#IDX378"><span style="font-family: courier, mono;">-j</span>, and recursion</a></li>
<li>
<a href="#IDX320"><span style="font-family: courier, mono;">-k</span></a>, <a href="#IDX628"><span style="font-family: courier, mono;">-k</span></a>, <a href="#IDX652"><span style="font-family: courier, mono;">-k</span></a>
</li>
<li><a href="#IDX654"><span style="font-family: courier, mono;">-l</span></a></li>
<li><a href="#IDX183"><span style="font-family: courier, mono;">-l</span> (library search)</a></li>
<li><a href="#IDX309"><span style="font-family: courier, mono;">-l</span> (load average)</a></li>
<li><a href="#IDX634"><span style="font-family: courier, mono;">-m</span></a></li>
<li><a href="#IDX258"><span style="font-family: courier, mono;">-M</span> (to compiler)</a></li>
<li><a href="#IDX261"><span style="font-family: courier, mono;">-MM</span> (to GNU compiler)</a></li>
<li>
<a href="#IDX275"><span style="font-family: courier, mono;">-n</span></a>, <a href="#IDX602"><span style="font-family: courier, mono;">-n</span></a>, <a href="#IDX657"><span style="font-family: courier, mono;">-n</span></a>
</li>
<li>
<a href="#IDX616"><span style="font-family: courier, mono;">-o</span></a>, <a href="#IDX661"><span style="font-family: courier, mono;">-o</span></a>
</li>
<li><a href="#IDX366"><span style="font-family: courier, mono;">-o</span>, and recursion</a></li>
<li><a href="#IDX664"><span style="font-family: courier, mono;">-p</span></a></li>
<li>
<a href="#IDX608"><span style="font-family: courier, mono;">-q</span></a>, <a href="#IDX668"><span style="font-family: courier, mono;">-q</span></a>
</li>
<li><a href="#IDX672"><span style="font-family: courier, mono;">-R</span></a></li>
<li><a href="#IDX670"><span style="font-family: courier, mono;">-r</span></a></li>
<li><a href="#IDX677"><span style="font-family: courier, mono;">-S</span></a></li>
<li>
<a href="#IDX279"><span style="font-family: courier, mono;">-s</span></a>, <a href="#IDX674"><span style="font-family: courier, mono;">-s</span></a>
</li>
<li>
<a href="#IDX606"><span style="font-family: courier, mono;">-t</span></a>, <a href="#IDX680"><span style="font-family: courier, mono;">-t</span></a>
</li>
<li><a href="#IDX341"><span style="font-family: courier, mono;">-t</span>, and recursion</a></li>
<li><a href="#IDX682"><span style="font-family: courier, mono;">-v</span></a></li>
<li>
<a href="#IDX611"><span style="font-family: courier, mono;">-W</span></a>, <a href="#IDX687"><span style="font-family: courier, mono;">-W</span></a>
</li>
<li><a href="#IDX684"><span style="font-family: courier, mono;">-w</span></a></li>
<li><a href="#IDX367"><span style="font-family: courier, mono;">-W</span>, and recursion</a></li>
<li><a href="#IDX399"><span style="font-family: courier, mono;">-w</span>, and recursion</a></li>
<li><a href="#IDX404"><span style="font-family: courier, mono;">-w</span>, disabling</a></li>
<li><a href="#IDX398"><span style="font-family: courier, mono;">-w</span>, and <span style="font-family: courier, mono;">-C</span></a></li>
</ul>
<h2 class="subhead">.</h2>
<ul>
<li><a href="#IDX910"><span style="font-family: courier, mono;">.a</span> (archives)</a></li>
<li><a href="#IDX707">.C</a></li>
<li><a href="#IDX704">.c</a></li>
<li><a href="#IDX708">.cc</a></li>
<li><a href="#IDX750">.ch</a></li>
<li><a href="#IDX263"><span style="font-family: courier, mono;">.d</span></a></li>
<li><a href="#IDX721">.def</a></li>
<li><a href="#IDX746">.dvi</a></li>
<li><a href="#IDX717">.F</a></li>
<li><a href="#IDX715">.f</a></li>
<li><a href="#IDX756">.info</a></li>
<li><a href="#IDX735">.l</a></li>
<li><a href="#IDX185"><span style="font-family: courier, mono;">.LIBPATTERNS</span>, and link libraries</a></li>
<li><a href="#IDX738">.ln</a></li>
<li><a href="#IDX722">.mod</a></li>
<li>
<a href="#IDX703">.o</a>, <a href="#IDX729">.o</a>
</li>
<li><a href="#IDX711">.p</a></li>
<li><a href="#IDX827"><span style="font-family: courier, mono;">.PRECIOUS</span> intermediate files</a></li>
<li><a href="#IDX716">.r</a></li>
<li><a href="#IDX726">.S</a></li>
<li><a href="#IDX725">.s</a></li>
<li><a href="#IDX765">.sh</a></li>
<li><a href="#IDX720">.sym</a></li>
<li><a href="#IDX747">.tex</a></li>
<li><a href="#IDX757">.texi</a></li>
<li><a href="#IDX755">.texinfo</a></li>
<li><a href="#IDX758">.txinfo</a></li>
<li><a href="#IDX749">.w</a></li>
<li><a href="#IDX748">.web</a></li>
<li><a href="#IDX732">.y</a></li>
</ul>
<h2 class="subhead">:</h2>
<p> </p>
<ul>
<li><a href="#IDX253"><span style="font-family: courier, mono;">::</span> rules (double-colon)</a></li>
<li>
<a href="#IDX433">:=</a>, <a href="#IDX462">:=</a>
</li>
</ul>
<h2 class="subhead">=</h2>
<ul>
<li>
<a href="#IDX428">=</a>, <a href="#IDX461">=</a>
</li>
<li><a href="#IDX101">=, expansion</a></li>
</ul>
<h2 class="subhead">?</h2>
<ul>
<li><a href="#IDX135"><span style="font-family: courier, mono;">?</span> (wildcard character)</a></li>
<li>
<a href="#IDX441">?=</a>, <a href="#IDX463">?=</a>
</li>
<li><a href="#IDX102">?=, expansion</a></li>
</ul>
<h2 class="subhead">@</h2>
<ul>
<li><a href="#IDX272"><span style="font-family: courier, mono;">@</span> (in commands)</a></li>
<li><a href="#IDX408">@, and <span style="font-family: courier, mono;">define</span></a></li>
</ul>
<h2 class="subhead">[</h2>
<ul>
<li><a href="#IDX136"><span style="font-family: courier, mono;">[...]</span> (wildcard characters)</a></li>
</ul>
<h2 class="subhead">\</h2>
<ul>
<li><a href="#IDX20"><span style="font-family: courier, mono;">\</span> (backslash), for continuation lines</a></li>
<li><a href="#IDX291"><span style="font-family: courier, mono;">\</span> (backslash), in commands</a></li>
<li>
<a href="#IDX161"><span style="font-family: courier, mono;">\</span> (backslash), to quote <span style="font-family: courier, mono;">%</span></a>, <a href="#IDX244"><span style="font-family: courier, mono;">\</span> (backslash), to quote <span style="font-family: courier, mono;">%</span></a>, <a href="#IDX498"><span style="font-family: courier, mono;">\</span> (backslash), to quote <span style="font-family: courier, mono;">%</span></a>
</li>
</ul>
<h2 class="subhead">_</h2>
<ul>
<li><a href="#IDX898"><span style="font-family: courier, mono;">__.SYMDEF</span></a></li>
</ul>
<h2 class="subhead">a</h2>
<ul>
<li><a href="#IDX164">algorithm for directory search</a></li>
<li><a href="#IDX583"><span style="font-family: courier, mono;">all</span> (standard target)</a></li>
<li><a href="#IDX465">appending to variables</a></li>
<li><a href="#IDX769">ar</a></li>
<li><a href="#IDX895">archive</a></li>
<li><a href="#IDX896">archive member targets</a></li>
<li><a href="#IDX900">archive symbol directory updating</a></li>
<li><a href="#IDX905">archive, and <span style="font-family: courier, mono;">-j</span></a></li>
<li><a href="#IDX903">archive, and parallel execution</a></li>
<li><a href="#IDX908">archive, suffix rule for</a></li>
<li><a href="#IDX383">Arg list too long</a></li>
<li><a href="#IDX491">arguments of functions</a></li>
<li>
<a href="#IDX724">as</a>, <a href="#IDX771">as</a>
</li>
<li><a href="#IDX723">assembly, rule to compile</a></li>
<li>
<a href="#IDX79">automatic generation of prerequisites</a>, <a href="#IDX255">automatic generation of prerequisites</a>
</li>
<li><a href="#IDX837">automatic variables</a></li>
</ul>
<h2 class="subhead">b</h2>
<ul>
<li><a href="#IDX567">backquotes</a></li>
<li><a href="#IDX21">backslash (<span style="font-family: courier, mono;">\</span>), for continuation lines</a></li>
<li><a href="#IDX290">backslash (<span style="font-family: courier, mono;">\</span>), in commands</a></li>
<li>
<a href="#IDX162">backslash (<span style="font-family: courier, mono;">\</span>), to quote <span style="font-family: courier, mono;">%</span></a>, <a href="#IDX245">backslash (<span style="font-family: courier, mono;">\</span>), to quote <span style="font-family: courier, mono;">%</span></a>, <a href="#IDX499">backslash (<span style="font-family: courier, mono;">\</span>), to quote <span style="font-family: courier, mono;">%</span></a>
</li>
<li><a href="#IDX150">backslashes in pathnames and wildcard expansion</a></li>
<li><a href="#IDX532">basename</a></li>
<li><a href="#IDX923">binary packages</a></li>
<li><a href="#IDX304">broken pipe</a></li>
<li><a href="#IDX5">bugs, reporting</a></li>
<li><a href="#IDX203">built-in special targets</a></li>
</ul>
<h2 class="subhead">c</h2>
<ul>
<li><a href="#IDX705">C++, rule to compile</a></li>
<li><a href="#IDX700">C, rule to compile</a></li>
<li>
<a href="#IDX701">cc</a>, <a href="#IDX773">cc</a>
</li>
<li>
<a href="#IDX287"><span style="font-family: courier, mono;">cd</span> (shell command)</a>, <a href="#IDX340"><span style="font-family: courier, mono;">cd</span> (shell command)</a>
</li>
<li><a href="#IDX819">chains of rules</a></li>
<li><a href="#IDX595"><span style="font-family: courier, mono;">check</span> (standard target)</a></li>
<li><a href="#IDX584"><span style="font-family: courier, mono;">clean</span> (standard target)</a></li>
<li>
<a href="#IDX25"><span style="font-family: courier, mono;">clean</span> target</a>, <a href="#IDX47"><span style="font-family: courier, mono;">clean</span> target</a>
</li>
<li><a href="#IDX45">cleaning up</a></li>
<li><a href="#IDX588"><span style="font-family: courier, mono;">clobber</span> (standard target)</a></li>
<li>
<a href="#IDX760">co</a>, <a href="#IDX777">co</a>
</li>
<li><a href="#IDX44">combining rules by prerequisite</a></li>
<li><a href="#IDX361">command line variable definitions, and recursion</a></li>
<li><a href="#IDX624">command line variables</a></li>
<li><a href="#IDX124">commands</a></li>
<li><a href="#IDX288">commands, backslash (<span style="font-family: courier, mono;">\</span>) in</a></li>
<li><a href="#IDX268">commands, comments in</a></li>
<li><a href="#IDX273">commands, echoing</a></li>
<li><a href="#IDX412">commands, empty</a></li>
<li><a href="#IDX313">commands, errors in</a></li>
<li><a href="#IDX283">commands, execution</a></li>
<li><a href="#IDX298">commands, execution in parallel</a></li>
<li><a href="#IDX566">commands, expansion</a></li>
<li><a href="#IDX264">commands, how to write</a></li>
<li><a href="#IDX598">commands, instead of executing</a></li>
<li><a href="#IDX15">commands, introduction to</a></li>
<li><a href="#IDX289">commands, quoting newlines in</a></li>
<li><a href="#IDX406">commands, sequences of</a></li>
<li><a href="#IDX267">comments, in commands</a></li>
<li><a href="#IDX55">comments, in makefile</a></li>
<li><a href="#IDX913">compatibility</a></li>
<li><a href="#IDX354">compatibility in exporting</a></li>
<li><a href="#IDX627">compilation, testing</a></li>
<li><a href="#IDX451">computed variable name</a></li>
<li><a href="#IDX558">conditional expansion</a></li>
<li><a href="#IDX439">conditional variable assignment</a></li>
<li><a href="#IDX481">conditionals</a></li>
<li><a href="#IDX19">continuation lines</a></li>
<li><a href="#IDX570">controlling make</a></li>
<li><a href="#IDX919">conventions for makefiles</a></li>
<li>
<a href="#IDX745">ctangle</a>, <a href="#IDX803">ctangle</a>
</li>
<li>
<a href="#IDX742">cweave</a>, <a href="#IDX799">cweave</a>
</li>
</ul>
<h2 class="subhead">d</h2>
<ul>
<li><a href="#IDX666">data base of <span style="font-family: courier, mono;">make</span> rules</a></li>
<li><a href="#IDX41">deducing commands (implicit rules)</a></li>
<li><a href="#IDX84">default directries for included makefiles</a></li>
<li>
<a href="#IDX29">default goal</a>, <a href="#IDX118">default goal</a>
</li>
<li><a href="#IDX59">default makefile name</a></li>
<li><a href="#IDX887">default rules, last-resort</a></li>
<li><a href="#IDX104">define, expansion</a></li>
<li><a href="#IDX473">defining variables verbatim</a></li>
<li>
<a href="#IDX324">deletion of target files</a>, <a href="#IDX329">deletion of target files</a>
</li>
<li><a href="#IDX54">directive</a></li>
<li><a href="#IDX392">directories, printing them</a></li>
<li><a href="#IDX902">directories, updating archive symbol</a></li>
<li><a href="#IDX523">directory part</a></li>
<li><a href="#IDX156">directory search (<span style="font-family: courier, mono;">VPATH</span>)</a></li>
<li><a href="#IDX172">directory search (<span style="font-family: courier, mono;">VPATH</span>), and implicit rules</a></li>
<li><a href="#IDX180">directory search (<span style="font-family: courier, mono;">VPATH</span>), and link libraries</a></li>
<li><a href="#IDX170">directory search (<span style="font-family: courier, mono;">VPATH</span>), and shell commands</a></li>
<li><a href="#IDX165">directory search algorithm</a></li>
<li><a href="#IDX167">directory search, traditional</a></li>
<li><a href="#IDX593"><span style="font-family: courier, mono;">dist</span> (standard target)</a></li>
<li><a href="#IDX586"><span style="font-family: courier, mono;">distclean</span> (standard target)</a></li>
<li><a href="#IDX490">dollar sign (<span style="font-family: courier, mono;">$</span>), in function call</a></li>
<li><a href="#IDX126">dollar sign (<span style="font-family: courier, mono;">$</span>), in rules</a></li>
<li><a href="#IDX456">dollar sign (<span style="font-family: courier, mono;">$</span>), in variable name</a></li>
<li><a href="#IDX422">dollar sign (<span style="font-family: courier, mono;">$</span>), in variable reference</a></li>
<li><a href="#IDX250">double-colon rules</a></li>
<li><a href="#IDX518">duplicate words, removing</a></li>
</ul>
<h2 class="subhead">e</h2>
<ul>
<li><a href="#IDX384">E2BIG</a></li>
<li><a href="#IDX270">echoing of commands</a></li>
<li><a href="#IDX9">editor</a></li>
<li><a href="#IDX322">Emacs (<span style="font-family: courier, mono;">M-x compile</span>)</a></li>
<li><a href="#IDX411">empty commands</a></li>
<li><a href="#IDX196">empty targets</a></li>
<li><a href="#IDX476">environment</a></li>
<li><a href="#IDX345">environment, and recursion</a></li>
<li><a href="#IDX297">environment, <span style="font-family: courier, mono;">SHELL</span> in</a></li>
<li><a href="#IDX572">error, stopping on</a></li>
<li><a href="#IDX312">errors (in commands)</a></li>
<li><a href="#IDX147">errors with wildcards</a></li>
<li><a href="#IDX300">execution, in parallel</a></li>
<li><a href="#IDX597">execution, instead of</a></li>
<li><a href="#IDX284">execution, of commands</a></li>
<li><a href="#IDX314">exit status (errors)</a></li>
<li><a href="#IDX50">explicit rule, definition of</a></li>
<li><a href="#IDX113">explicit rule, expansion</a></li>
<li><a href="#IDX346">exporting variables</a></li>
</ul>
<h2 class="subhead">f</h2>
<ul>
<li>
<a href="#IDX714">f77</a>, <a href="#IDX780">f77</a>
</li>
<li><a href="#IDX911">features of GNU <span style="font-family: courier, mono;">make</span></a></li>
<li><a href="#IDX916">features, missing</a></li>
<li><a href="#IDX521">file name functions</a></li>
<li><a href="#IDX60">file name of makefile</a></li>
<li><a href="#IDX71">file name of makefile, how to specify</a></li>
<li><a href="#IDX539">file name prefix, adding</a></li>
<li><a href="#IDX530">file name suffix</a></li>
<li><a href="#IDX536">file name suffix, adding</a></li>
<li><a href="#IDX132">file name with wildcards</a></li>
<li><a href="#IDX533">file name, basename of</a></li>
<li><a href="#IDX524">file name, directory part</a></li>
<li><a href="#IDX526">file name, nondirectory part</a></li>
<li><a href="#IDX615">files, assuming new</a></li>
<li><a href="#IDX619">files, assuming old</a></li>
<li><a href="#IDX620">files, avoiding recompilation of</a></li>
<li><a href="#IDX822">files, intermediate</a></li>
<li><a href="#IDX513">filtering out words</a></li>
<li><a href="#IDX510">filtering words</a></li>
<li><a href="#IDX507">finding strings</a></li>
<li><a href="#IDX631">flags</a></li>
<li><a href="#IDX767">flags for compilers</a></li>
<li><a href="#IDX423">flavors of variables</a></li>
<li><a href="#IDX194"><span style="font-family: courier, mono;">FORCE</span></a></li>
<li><a href="#IDX192">force targets</a></li>
<li><a href="#IDX712">Fortran, rule to compile</a></li>
<li><a href="#IDX488">functions</a></li>
<li><a href="#IDX569">functions, for controlling make</a></li>
<li><a href="#IDX520">functions, for file names</a></li>
<li><a href="#IDX493">functions, for text</a></li>
<li><a href="#IDX492">functions, syntax of</a></li>
<li><a href="#IDX560">functions, user defined</a></li>
</ul>
<h2 class="subhead">g</h2>
<ul>
<li>
<a href="#IDX706">g++</a>, <a href="#IDX775">g++</a>
</li>
<li><a href="#IDX702">gcc</a></li>
<li>
<a href="#IDX80">generating prerequisites automatically</a>, <a href="#IDX256">generating prerequisites automatically</a>
</li>
<li>
<a href="#IDX763">get</a>, <a href="#IDX782">get</a>
</li>
<li><a href="#IDX133">globbing (wildcards)</a></li>
<li><a href="#IDX31">goal</a></li>
<li>
<a href="#IDX30">goal, default</a>, <a href="#IDX119">goal, default</a>
</li>
<li><a href="#IDX580">goal, how to specify</a></li>
</ul>
<h2 class="subhead">h</h2>
<ul>
<li><a href="#IDX139">home directory</a></li>
</ul>
<h2 class="subhead">i</h2>
<ul>
<li><a href="#IDX2">IEEE Standard 1003.2</a></li>
<li><a href="#IDX105">ifdef, expansion</a></li>
<li><a href="#IDX106">ifeq, expansion</a></li>
<li><a href="#IDX107">ifndef, expansion</a></li>
<li><a href="#IDX108">ifneq, expansion</a></li>
<li><a href="#IDX694">implicit rule</a></li>
<li><a href="#IDX174">implicit rule, and directory search</a></li>
<li><a href="#IDX175">implicit rule, and <span style="font-family: courier, mono;">VPATH</span></a></li>
<li><a href="#IDX52">implicit rule, definition of</a></li>
<li><a href="#IDX111">implicit rule, expansion</a></li>
<li><a href="#IDX696">implicit rule, how to use</a></li>
<li><a href="#IDX42">implicit rule, introduction to</a></li>
<li><a href="#IDX698">implicit rule, predefined</a></li>
<li><a href="#IDX893">implicit rule, search algorithm</a></li>
<li><a href="#IDX83">included makefiles, default directries</a></li>
<li><a href="#IDX89">including (<span style="font-family: courier, mono;">MAKEFILES</span> variable)</a></li>
<li><a href="#IDX72">including other makefiles</a></li>
<li><a href="#IDX914">incompatibilities</a></li>
<li><a href="#IDX752">Info, rule to format</a></li>
<li><a href="#IDX589"><span style="font-family: courier, mono;">install</span> (standard target)</a></li>
<li><a href="#IDX821">intermediate files</a></li>
<li><a href="#IDX823">intermediate files, preserving</a></li>
<li><a href="#IDX212">intermediate targets, explicit</a></li>
<li><a href="#IDX327">interrupt</a></li>
</ul>
<h2 class="subhead">j</h2>
<ul>
<li><a href="#IDX301">job slots</a></li>
<li><a href="#IDX381">job slots, and recursion</a></li>
<li><a href="#IDX308">jobs, limiting based on load</a></li>
<li><a href="#IDX541">joining lists of words</a></li>
</ul>
<h2 class="subhead">k</h2>
<ul>
<li><a href="#IDX332">killing (interruption)</a></li>
</ul>
<h2 class="subhead">l</h2>
<ul>
<li><a href="#IDX886">last-resort default rules</a></li>
<li><a href="#IDX728">ld</a></li>
<li>
<a href="#IDX733">lex</a>, <a href="#IDX784">lex</a>
</li>
<li><a href="#IDX734">Lex, rule to run</a></li>
<li><a href="#IDX179">libraries for linking, directory search</a></li>
<li><a href="#IDX909">library archive, suffix rule for</a></li>
<li><a href="#IDX307">limiting jobs based on load</a></li>
<li><a href="#IDX178">link libraries, and directory search</a></li>
<li><a href="#IDX184">link libraries, patterns matching</a></li>
<li><a href="#IDX727">linking, predefined rule for</a></li>
<li><a href="#IDX736">lint</a></li>
<li><a href="#IDX737"><span style="font-family: courier, mono;">lint</span>, rule to run</a></li>
<li><a href="#IDX853">list of all prerequisites</a></li>
<li><a href="#IDX849">list of changed prerequisites</a></li>
<li><a href="#IDX306">load average</a></li>
<li><a href="#IDX429">loops in variable expansion</a></li>
<li>
<a href="#IDX142"><span style="font-family: courier, mono;">lpr</span> (shell command)</a>, <a href="#IDX200"><span style="font-family: courier, mono;">lpr</span> (shell command)</a>
</li>
</ul>
<h2 class="subhead">m</h2>
<ul>
<li><a href="#IDX719">m2c</a></li>
<li><a href="#IDX418">macro</a></li>
<li><a href="#IDX259"><span style="font-family: courier, mono;">make depend</span></a></li>
<li><a href="#IDX581"><span style="font-family: courier, mono;">MAKECMDGOALS</span></a></li>
<li><a href="#IDX7">makefile</a></li>
<li><a href="#IDX57">makefile name</a></li>
<li><a href="#IDX69">makefile name, how to specify</a></li>
<li><a href="#IDX11">makefile rule parts</a></li>
<li><a href="#IDX88">makefile, and <span style="font-family: courier, mono;">MAKEFILES</span> variable</a></li>
<li><a href="#IDX918">makefile, conventions for</a></li>
<li><a href="#IDX28">makefile, how <span style="font-family: courier, mono;">make</span> processes</a></li>
<li><a href="#IDX48">makefile, how to write</a></li>
<li><a href="#IDX73">makefile, including</a></li>
<li><a href="#IDX96">makefile, overriding</a></li>
<li><a href="#IDX99">makefile, parsing</a></li>
<li><a href="#IDX94">makefile, remaking of</a></li>
<li><a href="#IDX18">makefile, simple</a></li>
<li>
<a href="#IDX754">makeinfo</a>, <a href="#IDX791">makeinfo</a>
</li>
<li><a href="#IDX884">match-anything rule</a></li>
<li><a href="#IDX97">match-anything rule, used to override</a></li>
<li><a href="#IDX915">missing features</a></li>
<li><a href="#IDX146">mistakes with wildcards</a></li>
<li><a href="#IDX443">modified variable reference</a></li>
<li><a href="#IDX718">Modula-2, rule to compile</a></li>
<li><a href="#IDX585"><span style="font-family: courier, mono;">mostlyclean</span> (standard target)</a></li>
<li><a href="#IDX228">multiple rules for one target</a></li>
<li><a href="#IDX252">multiple rules for one target (<span style="font-family: courier, mono;">::</span>)</a></li>
<li><a href="#IDX223">multiple targets</a></li>
<li><a href="#IDX833">multiple targets, in pattern rule</a></li>
</ul>
<h2 class="subhead">n</h2>
<ul>
<li><a href="#IDX58">name of makefile</a></li>
<li><a href="#IDX70">name of makefile, how to specify</a></li>
<li><a href="#IDX450">nested variable reference</a></li>
<li><a href="#IDX293">newline, quoting, in commands</a></li>
<li><a href="#IDX23">newline, quoting, in makefile</a></li>
<li><a href="#IDX527">nondirectory part</a></li>
</ul>
<h2 class="subhead">o</h2>
<ul>
<li><a href="#IDX40"><span style="font-family: courier, mono;">OBJ</span></a></li>
<li><a href="#IDX39"><span style="font-family: courier, mono;">obj</span></a></li>
<li><a href="#IDX36"><span style="font-family: courier, mono;">OBJECTS</span></a></li>
<li><a href="#IDX35"><span style="font-family: courier, mono;">objects</span></a></li>
<li><a href="#IDX38"><span style="font-family: courier, mono;">OBJS</span></a></li>
<li><a href="#IDX37"><span style="font-family: courier, mono;">objs</span></a></li>
<li><a href="#IDX889">old-fashioned suffix rules</a></li>
<li><a href="#IDX630">options</a></li>
<li><a href="#IDX358">options, and recursion</a></li>
<li><a href="#IDX389">options, setting from environment</a></li>
<li><a href="#IDX391">options, setting in makefiles</a></li>
<li><a href="#IDX836">order of pattern rules</a></li>
<li><a href="#IDX564">origin of variable</a></li>
<li><a href="#IDX95">overriding makefiles</a></li>
<li><a href="#IDX622">overriding variables with arguments</a></li>
<li><a href="#IDX468">overriding with <span style="font-family: courier, mono;">override</span></a></li>
</ul>
<h2 class="subhead">p</h2>
<ul>
<li><a href="#IDX299">parallel execution</a></li>
<li><a href="#IDX904">parallel execution, and archive update</a></li>
<li><a href="#IDX222">parallel execution, overriding</a></li>
<li><a href="#IDX12">parts of makefile rule</a></li>
<li><a href="#IDX709">Pascal, rule to compile</a></li>
<li><a href="#IDX828">pattern rule</a></li>
<li><a href="#IDX112">pattern rule, expansion</a></li>
<li><a href="#IDX835">pattern rules, order of</a></li>
<li><a href="#IDX234">pattern rules, static (not implicit)</a></li>
<li><a href="#IDX238">pattern rules, static, syntax of</a></li>
<li><a href="#IDX479">pattern-specific variables</a></li>
<li>
<a href="#IDX710">pc</a>, <a href="#IDX786">pc</a>
</li>
<li><a href="#IDX187">phony targets</a></li>
<li><a href="#IDX145">pitfalls of wildcards</a></li>
<li><a href="#IDX912">portability</a></li>
<li><a href="#IDX1">POSIX</a></li>
<li><a href="#IDX386">POSIX.2</a></li>
<li><a href="#IDX922">post-installation commands</a></li>
<li><a href="#IDX921">pre-installation commands</a></li>
<li><a href="#IDX209">precious targets</a></li>
<li><a href="#IDX667">predefined rules and variables, printing</a></li>
<li><a href="#IDX538">prefix, adding</a></li>
<li><a href="#IDX117">prerequisite</a></li>
<li><a href="#IDX832">prerequisite pattern, implicit</a></li>
<li><a href="#IDX241">prerequisite pattern, static (not implicit)</a></li>
<li><a href="#IDX110">prerequisite, expansion</a></li>
<li><a href="#IDX129">prerequisites</a></li>
<li>
<a href="#IDX78">prerequisites, automatic generation</a>, <a href="#IDX254">prerequisites, automatic generation</a>
</li>
<li><a href="#IDX14">prerequisites, introduction to</a></li>
<li><a href="#IDX852">prerequisites, list of all</a></li>
<li><a href="#IDX848">prerequisites, list of changed</a></li>
<li><a href="#IDX236">prerequisites, varying (static pattern)</a></li>
<li><a href="#IDX824">preserving intermediate files</a></li>
<li>
<a href="#IDX210">preserving with <span style="font-family: courier, mono;">.PRECIOUS</span></a>, <a href="#IDX826">preserving with <span style="font-family: courier, mono;">.PRECIOUS</span></a>
</li>
<li><a href="#IDX215">preserving with <span style="font-family: courier, mono;">.SECONDARY</span></a></li>
<li><a href="#IDX590"><span style="font-family: courier, mono;">print</span> (standard target)</a></li>
<li>
<a href="#IDX141"><span style="font-family: courier, mono;">print</span> target</a>, <a href="#IDX199"><span style="font-family: courier, mono;">print</span> target</a>
</li>
<li><a href="#IDX393">printing directories</a></li>
<li><a href="#IDX274">printing of commands</a></li>
<li><a href="#IDX576">printing user warnings</a></li>
<li><a href="#IDX6">problems and bugs, reporting</a></li>
<li><a href="#IDX148">problems with wildcards</a></li>
<li><a href="#IDX27">processing a makefile</a></li>
</ul>
<h2 class="subhead">q</h2>
<ul>
<li><a href="#IDX609">question mode</a></li>
<li><a href="#IDX246">quoting <span style="font-family: courier, mono;">%</span>, in static pattern</a></li>
<li><a href="#IDX500">quoting <span style="font-family: courier, mono;">%</span>, in <span style="font-family: courier, mono;">patsubst</span></a></li>
<li><a href="#IDX163">quoting <span style="font-family: courier, mono;">%</span>, in <span style="font-family: courier, mono;">vpath</span></a></li>
<li><a href="#IDX292">quoting newline, in commands</a></li>
<li><a href="#IDX22">quoting newline, in makefile</a></li>
</ul>
<h2 class="subhead">r</h2>
<ul>
<li><a href="#IDX713">Ratfor, rule to compile</a></li>
<li><a href="#IDX759">RCS, rule to extract from</a></li>
<li><a href="#IDX98">reading makefiles</a></li>
<li><a href="#IDX64"><span style="font-family: courier, mono;">README</span></a></li>
<li><a href="#IDX587"><span style="font-family: courier, mono;">realclean</span> (standard target)</a></li>
<li><a href="#IDX8">recompilation</a></li>
<li><a href="#IDX621">recompilation, avoiding</a></li>
<li><a href="#IDX198">recording events with empty targets</a></li>
<li><a href="#IDX334">recursion</a></li>
<li><a href="#IDX374">recursion, and <span style="font-family: courier, mono;">-C</span></a></li>
<li><a href="#IDX375">recursion, and <span style="font-family: courier, mono;">-f</span></a></li>
<li><a href="#IDX380">recursion, and <span style="font-family: courier, mono;">-j</span></a></li>
<li><a href="#IDX376">recursion, and <span style="font-family: courier, mono;">-o</span></a></li>
<li><a href="#IDX342">recursion, and <span style="font-family: courier, mono;">-t</span></a></li>
<li><a href="#IDX377">recursion, and <span style="font-family: courier, mono;">-W</span></a></li>
<li><a href="#IDX397">recursion, and <span style="font-family: courier, mono;">-w</span></a></li>
<li><a href="#IDX363">recursion, and command line variable definitions</a></li>
<li><a href="#IDX349">recursion, and environment</a></li>
<li><a href="#IDX339">recursion, and <span style="font-family: courier, mono;">MAKE</span> variable</a></li>
<li><a href="#IDX91">recursion, and <span style="font-family: courier, mono;">MAKEFILES</span> variable</a></li>
<li><a href="#IDX359">recursion, and options</a></li>
<li><a href="#IDX394">recursion, and printing directories</a></li>
<li><a href="#IDX350">recursion, and variables</a></li>
<li><a href="#IDX356">recursion, level of</a></li>
<li>
<a href="#IDX416">recursive variable expansion</a>, <a href="#IDX424">recursive variable expansion</a>
</li>
<li><a href="#IDX426">recursively expanded variables</a></li>
<li>
<a href="#IDX420">reference to variables</a>, <a href="#IDX442">reference to variables</a>
</li>
<li><a href="#IDX32">relinking</a></li>
<li><a href="#IDX93">remaking makefiles</a></li>
<li>
<a href="#IDX325">removal of target files</a>, <a href="#IDX330">removal of target files</a>
</li>
<li><a href="#IDX517">removing duplicate words</a></li>
<li><a href="#IDX217">removing targets on failure</a></li>
<li><a href="#IDX46">removing, to clean up</a></li>
<li><a href="#IDX4">reporting bugs</a></li>
<li><a href="#IDX805">rm</a></li>
<li>
<a href="#IDX26"><span style="font-family: courier, mono;">rm</span> (shell command)</a>, <a href="#IDX140"><span style="font-family: courier, mono;">rm</span> (shell command)</a>, <a href="#IDX190"><span style="font-family: courier, mono;">rm</span> (shell command)</a>, <a href="#IDX316"><span style="font-family: courier, mono;">rm</span> (shell command)</a>
</li>
<li><a href="#IDX265">rule commands</a></li>
<li><a href="#IDX130">rule prerequisites</a></li>
<li><a href="#IDX120">rule syntax</a></li>
<li><a href="#IDX123">rule targets</a></li>
<li><a href="#IDX128">rule, and <span style="font-family: courier, mono;">$</span></a></li>
<li><a href="#IDX251">rule, double-colon (<span style="font-family: courier, mono;">::</span>)</a></li>
<li><a href="#IDX49">rule, explicit, definition of</a></li>
<li><a href="#IDX115">rule, how to write</a></li>
<li><a href="#IDX695">rule, implicit</a></li>
<li><a href="#IDX176">rule, implicit, and directory search</a></li>
<li><a href="#IDX177">rule, implicit, and <span style="font-family: courier, mono;">VPATH</span></a></li>
<li><a href="#IDX820">rule, implicit, chains of</a></li>
<li><a href="#IDX51">rule, implicit, definition of</a></li>
<li><a href="#IDX697">rule, implicit, how to use</a></li>
<li><a href="#IDX43">rule, implicit, introduction to</a></li>
<li><a href="#IDX699">rule, implicit, predefined</a></li>
<li><a href="#IDX10">rule, introduction to</a></li>
<li><a href="#IDX230">rule, multiple for one target</a></li>
<li><a href="#IDX195">rule, no commands or prerequisites</a></li>
<li><a href="#IDX829">rule, pattern</a></li>
<li><a href="#IDX233">rule, static pattern</a></li>
<li><a href="#IDX248">rule, static pattern versus implicit</a></li>
<li><a href="#IDX226">rule, with multiple targets</a></li>
</ul>
<h2 class="subhead">s</h2>
<ul>
<li><a href="#IDX764">s. (SCCS file prefix)</a></li>
<li><a href="#IDX762">SCCS, rule to extract from</a></li>
<li><a href="#IDX894">search algorithm, implicit rule</a></li>
<li><a href="#IDX155">search path for prerequisites (<span style="font-family: courier, mono;">VPATH</span>)</a></li>
<li><a href="#IDX173">search path for prerequisites (<span style="font-family: courier, mono;">VPATH</span>), and implicit rules</a></li>
<li><a href="#IDX182">search path for prerequisites (<span style="font-family: courier, mono;">VPATH</span>), and link libraries</a></li>
<li><a href="#IDX506">searching for strings</a></li>
<li><a href="#IDX825">secondary files</a></li>
<li><a href="#IDX214">secondary targets</a></li>
<li><a href="#IDX262"><span style="font-family: courier, mono;">sed</span> (shell command)</a></li>
<li><a href="#IDX545">selecting a word</a></li>
<li><a href="#IDX548">selecting word lists</a></li>
<li><a href="#IDX405">sequences of commands</a></li>
<li><a href="#IDX388">setting options from environment</a></li>
<li><a href="#IDX390">setting options in makefiles</a></li>
<li><a href="#IDX459">setting variables</a></li>
<li><a href="#IDX229">several rules for one target</a></li>
<li><a href="#IDX224">several targets in a rule</a></li>
<li><a href="#IDX592"><span style="font-family: courier, mono;">shar</span> (standard target)</a></li>
<li><a href="#IDX24">shell command</a></li>
<li><a href="#IDX169">shell command, and directory search</a></li>
<li><a href="#IDX285">shell command, execution</a></li>
<li><a href="#IDX568">shell command, function for</a></li>
<li><a href="#IDX75">shell file name pattern (in <span style="font-family: courier, mono;">include</span>)</a></li>
<li><a href="#IDX76">shell wildcards (in <span style="font-family: courier, mono;">include</span>)</a></li>
<li><a href="#IDX296"><span style="font-family: courier, mono;">SHELL</span>, MS-DOS specifics</a></li>
<li><a href="#IDX328">signal</a></li>
<li><a href="#IDX271">silent operation</a></li>
<li><a href="#IDX17">simple makefile</a></li>
<li><a href="#IDX417">simple variable expansion</a></li>
<li><a href="#IDX34">simplifying with variables</a></li>
<li><a href="#IDX431">simply expanded variables</a></li>
<li><a href="#IDX516">sorting words</a></li>
<li><a href="#IDX436">spaces, in variable values</a></li>
<li><a href="#IDX503">spaces, stripping</a></li>
<li><a href="#IDX202">special targets</a></li>
<li><a href="#IDX68">specifying makefile name</a></li>
<li><a href="#IDX305">standard input</a></li>
<li><a href="#IDX3">standards conformance</a></li>
<li><a href="#IDX920">standards for makefiles</a></li>
<li><a href="#IDX232">static pattern rule</a></li>
<li><a href="#IDX237">static pattern rule, syntax of</a></li>
<li><a href="#IDX249">static pattern rule, versus implicit</a></li>
<li>
<a href="#IDX240">stem</a>, <a href="#IDX883">stem</a>
</li>
<li><a href="#IDX858">stem, variable for</a></li>
<li><a href="#IDX573">stopping make</a></li>
<li><a href="#IDX508">strings, searching for</a></li>
<li><a href="#IDX501">stripping whitespace</a></li>
<li><a href="#IDX344">sub-<span style="font-family: courier, mono;">make</span></a></li>
<li><a href="#IDX335">subdirectories, recursion for</a></li>
<li><a href="#IDX444">substitution variable reference</a></li>
<li><a href="#IDX890">suffix rule</a></li>
<li><a href="#IDX907">suffix rule, for archive</a></li>
<li><a href="#IDX535">suffix, adding</a></li>
<li><a href="#IDX529">suffix, function to find</a></li>
<li><a href="#IDX448">suffix, substituting in variables</a></li>
<li><a href="#IDX632">switches</a></li>
<li><a href="#IDX901">symbol directories, updating archive</a></li>
<li><a href="#IDX121">syntax of rules</a></li>
</ul>
<h2 class="subhead">t</h2>
<ul>
<li><a href="#IDX125">tab character (in commands)</a></li>
<li><a href="#IDX16">tabs in rules</a></li>
<li><a href="#IDX594"><span style="font-family: courier, mono;">TAGS</span> (standard target)</a></li>
<li>
<a href="#IDX744">tangle</a>, <a href="#IDX801">tangle</a>
</li>
<li><a href="#IDX591"><span style="font-family: courier, mono;">tar</span> (standard target)</a></li>
<li><a href="#IDX116">target</a></li>
<li><a href="#IDX830">target pattern, implicit</a></li>
<li><a href="#IDX239">target pattern, static (not implicit)</a></li>
<li><a href="#IDX326">target, deleting on error</a></li>
<li><a href="#IDX331">target, deleting on interrupt</a></li>
<li><a href="#IDX109">target, expansion</a></li>
<li><a href="#IDX834">target, multiple in pattern rule</a></li>
<li><a href="#IDX231">target, multiple rules for one</a></li>
<li><a href="#IDX605">target, touching</a></li>
<li><a href="#IDX477">target-specific variables</a></li>
<li><a href="#IDX122">targets</a></li>
<li><a href="#IDX189">targets without a file</a></li>
<li><a href="#IDX204">targets, built-in special</a></li>
<li><a href="#IDX197">targets, empty</a></li>
<li><a href="#IDX193">targets, force</a></li>
<li><a href="#IDX13">targets, introduction to</a></li>
<li><a href="#IDX225">targets, multiple</a></li>
<li><a href="#IDX188">targets, phony</a></li>
<li><a href="#IDX885">terminal rule</a></li>
<li><a href="#IDX596"><span style="font-family: courier, mono;">test</span> (standard target)</a></li>
<li><a href="#IDX626">testing compilation</a></li>
<li>
<a href="#IDX741">tex</a>, <a href="#IDX793">tex</a>
</li>
<li><a href="#IDX739">TeX, rule to run</a></li>
<li>
<a href="#IDX753">texi2dvi</a>, <a href="#IDX795">texi2dvi</a>
</li>
<li><a href="#IDX751">Texinfo, rule to format</a></li>
<li><a href="#IDX138">tilde (<span style="font-family: courier, mono;">~</span>)</a></li>
<li>
<a href="#IDX143"><span style="font-family: courier, mono;">touch</span> (shell command)</a>, <a href="#IDX201"><span style="font-family: courier, mono;">touch</span> (shell command)</a>
</li>
<li><a href="#IDX604">touching files</a></li>
<li><a href="#IDX166">traditional directory search</a></li>
</ul>
<h2 class="subhead">u</h2>
<ul>
<li><a href="#IDX693">undefined variables, warning message</a></li>
<li><a href="#IDX899">updating archive symbol directories</a></li>
<li><a href="#IDX92">updating makefiles</a></li>
<li><a href="#IDX561">user defined functions</a></li>
</ul>
<h2 class="subhead">v</h2>
<ul>
<li><a href="#IDX415">value</a></li>
<li><a href="#IDX458">value, how a variable gets it</a></li>
<li><a href="#IDX414">variable</a></li>
<li><a href="#IDX53">variable definition</a></li>
<li><a href="#IDX33">variables</a></li>
<li><a href="#IDX454">variables, <samp>`$'</samp> in name</a></li>
<li><a href="#IDX839">variables, and implicit rule</a></li>
<li><a href="#IDX466">variables, appending to</a></li>
<li><a href="#IDX838">variables, automatic</a></li>
<li><a href="#IDX625">variables, command line</a></li>
<li><a href="#IDX362">variables, command line, and recursion</a></li>
<li><a href="#IDX452">variables, computed names</a></li>
<li><a href="#IDX440">variables, conditional assignment</a></li>
<li><a href="#IDX474">variables, defining verbatim</a></li>
<li>
<a href="#IDX347">variables, environment</a>, <a href="#IDX475">variables, environment</a>
</li>
<li><a href="#IDX348">variables, exporting</a></li>
<li><a href="#IDX425">variables, flavors</a></li>
<li><a href="#IDX457">variables, how they get their values</a></li>
<li><a href="#IDX419">variables, how to reference</a></li>
<li><a href="#IDX430">variables, loops in expansion</a></li>
<li><a href="#IDX445">variables, modified reference</a></li>
<li><a href="#IDX453">variables, nested references</a></li>
<li><a href="#IDX563">variables, origin of</a></li>
<li><a href="#IDX469">variables, overriding</a></li>
<li><a href="#IDX623">variables, overriding with arguments</a></li>
<li><a href="#IDX480">variables, pattern-specific</a></li>
<li><a href="#IDX427">variables, recursively expanded</a></li>
<li><a href="#IDX460">variables, setting</a></li>
<li><a href="#IDX432">variables, simply expanded</a></li>
<li><a href="#IDX438">variables, spaces in values</a></li>
<li><a href="#IDX447">variables, substituting suffix in</a></li>
<li><a href="#IDX446">variables, substitution reference</a></li>
<li><a href="#IDX478">variables, target-specific</a></li>
<li><a href="#IDX692">variables, warning for undefined</a></li>
<li><a href="#IDX235">varying prerequisites</a></li>
<li><a href="#IDX472">verbatim variable definition</a></li>
<li><a href="#IDX154">vpath</a></li>
<li><a href="#IDX171"><span style="font-family: courier, mono;">VPATH</span>, and implicit rules</a></li>
<li><a href="#IDX181"><span style="font-family: courier, mono;">VPATH</span>, and link libraries</a></li>
</ul>
<h2 class="subhead">w</h2>
<ul>
<li><a href="#IDX575">warnings, printing</a></li>
<li>
<a href="#IDX743">weave</a>, <a href="#IDX797">weave</a>
</li>
<li><a href="#IDX740">Web, rule to run</a></li>
<li><a href="#IDX614">what if</a></li>
<li><a href="#IDX437">whitespace, in variable values</a></li>
<li><a href="#IDX502">whitespace, stripping</a></li>
<li><a href="#IDX131">wildcard</a></li>
<li><a href="#IDX144">wildcard pitfalls</a></li>
<li><a href="#IDX554">wildcard, function</a></li>
<li><a href="#IDX897">wildcard, in archive member</a></li>
<li><a href="#IDX77">wildcard, in <span style="font-family: courier, mono;">include</span></a></li>
<li><a href="#IDX149">wildcards and MS-DOS/MS-Windows backslashes</a></li>
<li><a href="#IDX544">word, selecting a</a></li>
<li><a href="#IDX552">words, extracting first</a></li>
<li><a href="#IDX511">words, filtering</a></li>
<li><a href="#IDX514">words, filtering out</a></li>
<li><a href="#IDX550">words, finding number</a></li>
<li><a href="#IDX556">words, iterating over</a></li>
<li><a href="#IDX542">words, joining lists</a></li>
<li><a href="#IDX519">words, removing duplicates</a></li>
<li><a href="#IDX547">words, selecting lists of</a></li>
<li><a href="#IDX266">writing rule commands</a></li>
<li><a href="#IDX114">writing rules</a></li>
</ul>
<h2 class="subhead">y</h2>
<ul>
<li><a href="#IDX407"><span style="font-family: courier, mono;">yacc</span></a></li>
<li>
<a href="#IDX730">yacc</a>, <a href="#IDX788">yacc</a>
</li>
<li><a href="#IDX731">Yacc, rule to run</a></li>
</ul>
<h2 class="subhead">~</h2>
<ul>
<li><a href="#IDX137"><span style="font-family: courier, mono;">~</span> (tilde)</a></li>
</ul>
<h2 class="subhead"><a id="SEC127" href="#TOC127" name="SEC127">Index of Functions, Variables, &amp; Directives</a></h2>
<h2 class="subhead">$</h2>
<ul>
<li><a href="#IDX842">$%</a></li>
<li><a href="#IDX867">$(%D)</a></li>
<li><a href="#IDX869">$(%F)</a></li>
<li><a href="#IDX863">$(*D)</a></li>
<li><a href="#IDX865">$(*F)</a></li>
<li><a href="#IDX871">$(&lt;D)</a></li>
<li><a href="#IDX873">$(&lt;F)</a></li>
<li><a href="#IDX879">$(?D)</a></li>
<li><a href="#IDX881">$(?F)</a></li>
<li><a href="#IDX859">$(@D)</a></li>
<li><a href="#IDX861">$(@F)</a></li>
<li><a href="#IDX875">$(^D)</a></li>
<li><a href="#IDX877">$(^F)</a></li>
<li><a href="#IDX856">$*</a></li>
<li><a href="#IDX247">$*, and static pattern</a></li>
<li><a href="#IDX854">$+</a></li>
<li><a href="#IDX844">$&lt;</a></li>
<li><a href="#IDX846">$?</a></li>
<li><a href="#IDX840">$@</a></li>
<li><a href="#IDX850">$^</a></li>
</ul>
<h2 class="subhead">%</h2>
<ul>
<li><a href="#IDX843">% (automatic variable)</a></li>
<li><a href="#IDX868">%D (automatic variable)</a></li>
<li><a href="#IDX870">%F (automatic variable)</a></li>
</ul>
<h2 class="subhead">*</h2>
<ul>
<li><a href="#IDX857">* (automatic variable)</a></li>
<li><a href="#IDX917">* (automatic variable), unsupported bizarre usage</a></li>
<li><a href="#IDX864">*D (automatic variable)</a></li>
<li><a href="#IDX866">*F (automatic variable)</a></li>
</ul>
<h2 class="subhead">+</h2>
<ul>
<li><a href="#IDX855">+ (automatic variable)</a></li>
</ul>
<h2 class="subhead">.</h2>
<ul>
<li>
<a href="#IDX207">.DEFAULT</a>, <a href="#IDX888">.DEFAULT</a>
</li>
<li><a href="#IDX413">.DEFAULT, and empty commands</a></li>
<li>
<a href="#IDX216">.DELETE_ON_ERROR</a>, <a href="#IDX323">.DELETE_ON_ERROR</a>
</li>
<li>
<a href="#IDX220">.EXPORT_ALL_VARIABLES</a>, <a href="#IDX353">.EXPORT_ALL_VARIABLES</a>
</li>
<li>
<a href="#IDX218">.IGNORE</a>, <a href="#IDX319">.IGNORE</a>
</li>
<li><a href="#IDX211">.INTERMEDIATE</a></li>
<li><a href="#IDX186">.LIBPATTERNS</a></li>
<li><a href="#IDX221">.NOTPARALLEL</a></li>
<li>
<a href="#IDX191">.PHONY</a>, <a href="#IDX205">.PHONY</a>
</li>
<li><a href="#IDX385">.POSIX</a></li>
<li>
<a href="#IDX208">.PRECIOUS</a>, <a href="#IDX333">.PRECIOUS</a>
</li>
<li><a href="#IDX213">.SECONDARY</a></li>
<li>
<a href="#IDX219">.SILENT</a>, <a href="#IDX282">.SILENT</a>
</li>
<li>
<a href="#IDX206">.SUFFIXES</a>, <a href="#IDX891">.SUFFIXES</a>
</li>
</ul>
<h2 class="subhead">/</h2>
<ul>
<li><a href="#IDX85">/usr/gnu/include</a></li>
<li><a href="#IDX87">/usr/include</a></li>
<li><a href="#IDX86">/usr/local/include</a></li>
</ul>
<h2 class="subhead">&lt;</h2>
<ul>
<li><a href="#IDX845">&lt; (automatic variable)</a></li>
<li><a href="#IDX872">&lt;D (automatic variable)</a></li>
<li><a href="#IDX874">&lt;F (automatic variable)</a></li>
</ul>
<h2 class="subhead">?</h2>
<ul>
<li><a href="#IDX847">? (automatic variable)</a></li>
<li><a href="#IDX880">?D (automatic variable)</a></li>
<li><a href="#IDX882">?F (automatic variable)</a></li>
</ul>
<h2 class="subhead">@</h2>
<ul>
<li><a href="#IDX841">@ (automatic variable)</a></li>
<li><a href="#IDX860">@D (automatic variable)</a></li>
<li><a href="#IDX862">@F (automatic variable)</a></li>
</ul>
<h2 class="subhead">^</h2>
<ul>
<li><a href="#IDX851">^ (automatic variable)</a></li>
<li><a href="#IDX876">^D (automatic variable)</a></li>
<li><a href="#IDX878">^F (automatic variable)</a></li>
</ul>
<h2 class="subhead">a</h2>
<ul>
<li><a href="#IDX537">addprefix</a></li>
<li><a href="#IDX534">addsuffix</a></li>
<li><a href="#IDX768">AR</a></li>
<li><a href="#IDX806">ARFLAGS</a></li>
<li><a href="#IDX770">AS</a></li>
<li><a href="#IDX807">ASFLAGS</a></li>
</ul>
<h2 class="subhead">b</h2>
<ul>
<li><a href="#IDX531">basename</a></li>
</ul>
<h2 class="subhead">c</h2>
<ul>
<li><a href="#IDX559">call</a></li>
<li><a href="#IDX772">CC</a></li>
<li><a href="#IDX808">CFLAGS</a></li>
<li><a href="#IDX776">CO</a></li>
<li><a href="#IDX810">COFLAGS</a></li>
<li><a href="#IDX295">COMSPEC</a></li>
<li><a href="#IDX778">CPP</a></li>
<li><a href="#IDX811">CPPFLAGS</a></li>
<li><a href="#IDX802">CTANGLE</a></li>
<li><a href="#IDX798">CWEAVE</a></li>
<li><a href="#IDX774">CXX</a></li>
<li><a href="#IDX809">CXXFLAGS</a></li>
</ul>
<h2 class="subhead">d</h2>
<ul>
<li><a href="#IDX470">define</a></li>
<li><a href="#IDX522">dir</a></li>
</ul>
<h2 class="subhead">e</h2>
<ul>
<li><a href="#IDX486">else</a></li>
<li><a href="#IDX471">endef</a></li>
<li><a href="#IDX487">endif</a></li>
<li><a href="#IDX571">error</a></li>
<li><a href="#IDX351">export</a></li>
</ul>
<h2 class="subhead">f</h2>
<ul>
<li><a href="#IDX779">FC</a></li>
<li><a href="#IDX812">FFLAGS</a></li>
<li><a href="#IDX509">filter</a></li>
<li><a href="#IDX512">filter-out</a></li>
<li><a href="#IDX505">findstring</a></li>
<li><a href="#IDX551">firstword</a></li>
<li><a href="#IDX555">foreach</a></li>
</ul>
<h2 class="subhead">g</h2>
<ul>
<li><a href="#IDX781">GET</a></li>
<li><a href="#IDX813">GFLAGS</a></li>
<li><a href="#IDX62">GNUmakefile</a></li>
<li><a href="#IDX168">GPATH</a></li>
</ul>
<h2 class="subhead">i</h2>
<ul>
<li><a href="#IDX557">if</a></li>
<li><a href="#IDX482">ifdef</a></li>
<li><a href="#IDX483">ifeq</a></li>
<li><a href="#IDX484">ifndef</a></li>
<li><a href="#IDX485">ifneq</a></li>
<li><a href="#IDX74">include</a></li>
</ul>
<h2 class="subhead">j</h2>
<ul>
<li><a href="#IDX540">join</a></li>
</ul>
<h2 class="subhead">l</h2>
<ul>
<li><a href="#IDX814">LDFLAGS</a></li>
<li><a href="#IDX783">LEX</a></li>
<li><a href="#IDX815">LFLAGS</a></li>
</ul>
<h2 class="subhead">m</h2>
<ul>
<li>
<a href="#IDX338">MAKE</a>, <a href="#IDX435">MAKE</a>
</li>
<li><a href="#IDX582">MAKECMDGOALS</a></li>
<li><a href="#IDX61">Makefile</a></li>
<li><a href="#IDX63">makefile</a></li>
<li>
<a href="#IDX90">MAKEFILES</a>, <a href="#IDX357">MAKEFILES</a>
</li>
<li><a href="#IDX360">MAKEFLAGS</a></li>
<li><a href="#IDX790">MAKEINFO</a></li>
<li>
<a href="#IDX355">MAKELEVEL</a>, <a href="#IDX434">MAKELEVEL</a>
</li>
<li><a href="#IDX382">MAKEOVERRIDES</a></li>
<li><a href="#IDX387">MFLAGS</a></li>
</ul>
<h2 class="subhead">n</h2>
<ul>
<li><a href="#IDX525">notdir</a></li>
</ul>
<h2 class="subhead">o</h2>
<ul>
<li><a href="#IDX562">origin</a></li>
<li><a href="#IDX766">OUTPUT_OPTION</a></li>
<li><a href="#IDX467">override</a></li>
</ul>
<h2 class="subhead">p</h2>
<ul>
<li>
<a href="#IDX449">patsubst</a>, <a href="#IDX495">patsubst</a>
</li>
<li><a href="#IDX785">PC</a></li>
<li><a href="#IDX816">PFLAGS</a></li>
</ul>
<h2 class="subhead">r</h2>
<ul>
<li><a href="#IDX817">RFLAGS</a></li>
<li><a href="#IDX804">RM</a></li>
</ul>
<h2 class="subhead">s</h2>
<ul>
<li><a href="#IDX565">shell</a></li>
<li><a href="#IDX294">SHELL</a></li>
<li><a href="#IDX286">SHELL (command execution)</a></li>
<li><a href="#IDX515">sort</a></li>
<li><a href="#IDX504">strip</a></li>
<li>
<a href="#IDX227">subst</a>, <a href="#IDX494">subst</a>
</li>
<li><a href="#IDX528">suffix</a></li>
<li><a href="#IDX892">SUFFIXES</a></li>
</ul>
<h2 class="subhead">t</h2>
<ul>
<li><a href="#IDX800">TANGLE</a></li>
<li><a href="#IDX792">TEX</a></li>
<li><a href="#IDX794">TEXI2DVI</a></li>
</ul>
<h2 class="subhead">u</h2>
<ul>
<li><a href="#IDX352">unexport</a></li>
</ul>
<h2 class="subhead">v</h2>
<ul>
<li>
<a href="#IDX152">VPATH</a>, <a href="#IDX157">VPATH</a>
</li>
<li>
<a href="#IDX153">vpath</a>, <a href="#IDX158">vpath</a>
</li>
</ul>
<h2 class="subhead">w</h2>
<ul>
<li><a href="#IDX574">warning</a></li>
<li><a href="#IDX796">WEAVE</a></li>
<li>
<a href="#IDX151">wildcard</a>, <a href="#IDX553">wildcard</a>
</li>
<li><a href="#IDX543">word</a></li>
<li><a href="#IDX546">wordlist</a></li>
<li><a href="#IDX549">words</a></li>
</ul>
<h2 class="subhead">y</h2>
<ul>
<li><a href="#IDX787">YACC</a></li>
<li><a href="#IDX789">YACCR</a></li>
<li><a href="#IDX818">YFLAGS</a></li>
</ul>
<h2 class="subhead">Footnotes</h2>
<h3 class="subsubhead"><a id="FOOT1" href="#DOCF1" name="FOOT1">(1)</a></h3>
<p>GNU Make compiled for MS-DOS and MS-Windows behaves as if <var>prefix</var> has been defined to be the root of the DJGPP tree hierarchy.</p>
<h3 class="subsubhead"><a id="FOOT2" href="#DOCF2" name="FOOT2">(2)</a></h3>
<p>On MS-DOS, the value of current working directory is <strong>global</strong>, so changing it <em>will</em> affect the following command lines on those systems.</p>
<h3 class="subsubhead"><a id="FOOT3" href="#DOCF3" name="FOOT3">(3)</a></h3>
<p><span style="font-family: courier, mono;">texi2dvi</span> uses TeX to do the real work of formatting. TeX is not distributed with Texinfo.</p>
	                    

	        			
	                    
	                    
	                    	
	                    

            		 </main><!--Course_inner_section tag close --><div class="clear"></div>
 				 </div>
<!--Course_wrapper tag close -->             
 			 </div>
<!--left tag close -->
 			
         </div>
<!--grid tag close -->
      </div>
		
		<footer id="bottom"><div id="grid">
				
<div id="portletwrapper-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572" class="portletWrapper kssattr-portlethash-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572">
<div class="portletStaticText portlet-static-site-footer">
<!--googleoff: index-->
<div id="footer">
<nav aria-label="Footer"><nav id="foot-c1" class="grid_2 alpha" aria-labelledby="f-find-courses"><span class="footer" id="f-find-courses" aria-hidden="true">Find Courses</span>
<ul class="foot-bullet" role="presentation">
<li><a href="https://ocw.mit.edu/courses/find-by-topic/">Find by Topic</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-number/">Find by Course Number</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-department/">Find by Department</a></li>
    <li><a href="https://ocw.mit.edu/educator/?view=instructional&amp;utm_campaign=Educator&amp;utm_source=footer&amp;utm_medium=find-courses&amp;utm_content=approaches">Instructional Approach</a></li>
    <li><a href="https://ocw.mit.edu/educator/?view=teaching&amp;utm_campaign=Educator&amp;utm_source=footer&amp;utm_medium=find-courses&amp;utm_content=materials">Teaching Materials</a></li>
    <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/subtitled/">Courses with Subtitles</a></li>
    <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
    <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/this-course-at-mit/">This Course at MIT</a></li>
    <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
    <li><a href="https://ocw.mit.edu/courses/translated-courses/">Translated Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/?utm_source=ocw-footer&amp;utm_medium=link&amp;utm_campaign=mclstudy">View All Courses</a></li>
</ul></nav><div id="foot-c2" class="grid_2">
<nav aria-labelledby="f-about"><span id="f-about" class="footer" aria-hidden="true">About</span>
<ul class="foot-bullet" role="presentation">
<li><a href="https://ocw.mit.edu/about/">About OpenCourseWare</a></li>
    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
    <li><a href="https://ocw.mit.edu/about/newsletter/">News</a></li>
    <li><a href="https://ocw.mit.edu/about/media-coverage/press-releases/">Press Releases</a></li>
</ul></nav><!--about--><nav aria-labelledby="f-tools"><span id="f-tools" class="footer" aria-hidden="true">Tools</span>
<ul class="foot-bullet" role="presentation">
<li><a href="https://ocw.mit.edu/help/">Help &amp; FAQs</a></li>
    <li><a href="../../../common/jsp/feedback.htm">Contact Us</a></li>
    <li><a href="../../../common/search/AdvancedSearch.htm">Advanced Search</a></li>
    <li><a href="https://ocw.mit.edu/help/site-map/">Site Map</a></li>
    <li><a href="../../../common/terms/index.htm">Privacy &amp; Terms of Use</a></li>
    <li><a href="https://ocw.mit.edu/help/rss/">RSS Feeds</a></li>
</ul></nav><!--tools-->
</div>
<nav class="grid_2" id="foot-c3" aria-labelledby="f-donate"><span id="f-donate" class="footer" aria-hidden="true">Donate</span>
<ul class="foot-bullet" role="presentation">
<li><a href="https://ocw.mit.edu/donate">Make a Donation</a></li>
    <li><a href="https://ocw.mit.edu/donate/why-donate/">Why Donate?</a></li>
    <li><a href="https://ocw.mit.edu/donate/our-supporters/">Our Supporters</a></li>
    <li><a href="https://ocw.mit.edu/donate/other-ways-to-contribute/">Other Ways to Contribute</a></li>
    <li><a href="https://ocw.mit.edu/donate/shop-ocw/">Shop OCW</a></li>
    <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
</ul></nav><div class="grid_2" id="foot-c4"><nav aria-labelledby="f-featured-sites"><span id="f-featured-sites" class="footer" aria-hidden="true">Featured Sites</span>
<ul class="foot-bullet" role="presentation">
<li><a href="https://ocw.mit.edu/high-school/">Highlights for High School</a></li>
    <li><a href="https://ocw.mit.edu/educator/?utm_campaign=Educator&amp;utm_source=footer&amp;utm_medium=featured-sites">OCW Educator</a></li>
    <li><a href="https://ocw.mit.edu/courses/crosslinks/">MIT Crosslinks and OCW</a></li>
    <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx and Related OCW Courses</a></li>
    <li><a href="http://k12videos.mit.edu" aria-label="External Link: MIT+K12 Videos">MIT+K12 Videos</a></li>
    <li><a href="https://teachingexcellence.mit.edu/" aria-label="External Link: Teaching Excellence at MIT">Teaching Excellence at MIT</a></li>
    <li><a href="https://outreach.mit.edu/" aria-label="External Link: Outreach at MIT">Outreach@MIT</a></li>
    <li><a href="http://www.oeconsortium.org/" aria-label="External Link: Open Education Consortium">Open Education Consortium</a></li>
</ul></nav></div>
</nav><!--Footer Nav>--><aside id="foot-c5" class="grid_4 omega" aria-labelledby="f-our-corporate-supporters" style="min-height: 289px;"><span id="f-our-corporate-supporters" class="footer" aria-hidden="true">Our Corporate Supporters</span>           <!-- HOME_CORP_LOGO_1 -->
<div class="sponsors_google_ads_even" id="div-gpt-ad-1388181177156-0"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-0'); });
            </script></div>
<!-- HOME_CORP_LOGO_2 -->
<div class="sponsors_google_ads_odd" id="div-gpt-ad-1388181177156-1"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-1'); });
            </script></div>
<!-- HOME_CORP_LOGO_3 -->
<div class="sponsors_google_ads_even" id="div-gpt-ad-1388181177156-2"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-2'); });
            </script></div>
<!-- HOME_CORP_LOGO_4 -->
<div class="sponsors_google_ads_odd" id="div-gpt-ad-1388181177156-3"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-3'); });
            </script></div>
<!-- HOME_CORP_LOGO_5 -->
<div class="sponsors_google_ads_even" id="div-gpt-ad-1388181177156-4"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-4'); });
              </script></div>
<!-- HOME_CORP_LOGO_6 -->
<div class="sponsors_google_ads_odd" id="div-gpt-ad-1388181177156-5"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-5'); });
              </script></div>
</aside><aside class="grid_12 alpha omega" aria-label="OCW 15th Anniversary" style="border-top: thin solid #d5c9ba; padding-top: 24px; margin-bottom: 10px; text-align: center;"><p style="font-family: TitilliumText22LRegular,Verdana; text-align: center; font-size: 1.1em;">Support for <span style="letter-spacing: 0.5px; font-weight: bold;"><span style="text-transform: uppercase;">MIT OpenCourseWare's</span> 15th anniversary</span> is provided by <a href="http://www.sapientnitro.com/en-us.html#home"><img style="width: 145px; height: 35px; vertical-align: middle; margin-left: 7px;" alt="SapientNitro" src="../../../common/images/logo_sapient.png"></a></p>
</aside><aside class="grid_12 alpha omega" aria-labelledby="f-about-ocw" itemtype="http://schema.org/CollegeOrUniversity" itemscope="" itemprop="publisher" style="border-top: thin solid #d5c9ba; padding-top: 10px; margin-bottom: 10px;"><span id="f-about-ocw" class="footer" aria-hidden="true">             About <span itemprop="name">MIT OpenCourseWare</span></span>
<p itemprop="description" style="color: #999; font-size: 1em; line-height: 1.5em; margin-top: 10px;">OCW is a free and open publication of material from thousands of MIT courses, covering the entire MIT curriculum. <a href="https://ocw.mit.edu/about/">Learn more »</a></p>
<div id="foot-copy" class="grid_12 alpha omega" style="border-top: none;">
<a href="http://web.mit.edu">               <img style="width: 195; height: 44;" alt="Massachusetts Institute of Technology" src="../../../common/images/logo_mit.png"></a>             <a href="http://odl.mit.edu">               <img style="width: 289; height: 54; vertical-align: top;" alt="MIT Office of Digital Learning" src="https://ocw.mit.edu/images/logo_odl.png"></a>             <a href="http://www.oeconsortium.org/">               <img style="width: 219px; height: 59px; vertical-align: top;" alt="Open Education Consortium" src="https://ocw.mit.edu/images/logo_oec.png"></a>             <a itemprop="useRightsUrl" rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">               <img style="width: 126px; height: 44px; margin-right: 0; margin-left: 13px;" alt="Creative Commons" src="../../../common/images/cc_by-nc-sa.png"></a>
</div>
<div id="f-legal" class="grid_12 alpha omega" style="border-top: none;">
<p class="copyright">© 2001–2015<br>
Massachusetts Institute of Technology</p>
<p style="font-size: 0.9em; margin-bottom: 15px;">Your use of the MIT OpenCourseWare site and materials is subject to our <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons License</a> and other <a rel="cc:morePermissions" href="../../../common/terms/index.htm">terms of use</a>.</p>
</div>
</aside>
</div>
<!--footer-->   <!--googleon: index-->
</div>

</div>





                
			</div> <!-- bottom grid end -->
		</footer><!-- footer bottom end -->
</body>
</html>
